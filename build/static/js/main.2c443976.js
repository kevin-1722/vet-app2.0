/*! For license information please see main.2c443976.js.LICENSE.txt */
(()=>{"use strict";var e={730:(e,t,r)=>{var n=r(43),a=r(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,r,n,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,r,n){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,a,n)&&(r=null),n||null===a?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,n=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),C=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),I=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var x=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var D,F=Object.assign;function U(e){if(void 0===D)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var B=!1;function H(e,t){if(!e||B)return"";B=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&"string"===typeof l.stack){for(var a=l.stack.split("\n"),i=n.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var c="\n"+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?U(e):""}function z(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case C:return"Portal";case S:return"Profiler";case E:return"StrictMode";case R:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return q(e(t))}catch(r){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function K(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function j(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function V(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=W(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var r=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Q(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=K(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){X(e,t);var r=K(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,K(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&G(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+K(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(i(92));if(te(r)){if(1<r.length)throw Error(i(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:K(r)}}function ie(e,t){var r=K(t.value),n=K(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),a=ge(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Te(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ce=null,ke=null,Ee=null;function Se(e){if(e=ba(e)){if("function"!==typeof Ce)throw Error(i(280));var t=e.stateNode;t&&(t=Ta(t),Ce(e.stateNode,e.type,t))}}function Ae(e){ke?Ee?Ee.push(e):Ee=[e]:ke=e}function Ie(){if(ke){var e=ke,t=Ee;if(Ee=ke=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function _e(e,t){return e(t)}function Re(){}var Oe=!1;function Pe(e,t,r){if(Oe)return e(t,r);Oe=!0;try{return _e(e,t,r)}finally{Oe=!1,(null!==ke||null!==Ee)&&(Re(),Ie())}}function Ne(e,t){var r=e.stateNode;if(null===r)return null;var n=Ta(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var xe=!1;if(u)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){xe=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(ue){xe=!1}function Le(e,t,r,n,a,i,o,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var De=!1,Fe=null,Ue=!1,Be=null,He={onError:function(e){De=!0,Fe=e}};function ze(e,t,r,n,a,i,o,s,c){De=!1,Fe=null,Le.apply(He,arguments)}function qe(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ke(e){if(qe(e)!==e)throw Error(i(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(n=a.return)){r=n;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===r)return Ke(a),e;if(o===n)return Ke(a),t;o=o.sibling}throw Error(i(188))}if(r.return!==n.return)r=a,n=o;else{for(var s=!1,c=a.child;c;){if(c===r){s=!0,r=a,n=o;break}if(c===n){s=!0,n=a,r=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===r){s=!0,r=o,n=a;break}if(c===n){s=!0,n=o,r=a;break}c=c.sibling}if(!s)throw Error(i(189))}}if(r.alternate!==n)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(e))?je(e):null}function je(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=je(e);if(null!==t)return t;e=e.sibling}return null}var Ve=a.unstable_scheduleCallback,Ge=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Qe=a.unstable_requestPaint,Xe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,rt=a.unstable_LowPriority,nt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ct|0)|0},st=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&r;if(0!==o){var s=o&~a;0!==s?n=ht(s):0!==(i&=o)&&(n=ht(i))}else 0!==(o=r&~a)?n=ht(o):0!==i&&(n=ht(i));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(r=31-ot(t)),n|=e[r],t&=~a;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function vt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=r}function yt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ot(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Tt,Ct,kt,Et,St,At=!1,It=[],_t=null,Rt=null,Ot=null,Pt=new Map,Nt=new Map,xt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":_t=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Dt(e,t,r,n,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&Ct(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ft(e){var t=ya(e.target);if(null!==t){var r=qe(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=$e(r)))return e.blockedOn=t,void St(e.priority,(function(){kt(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=ba(r))&&Ct(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);we=n,r.target.dispatchEvent(n),we=null,t.shift()}return!0}function Bt(e,t,r){Ut(e)&&r.delete(t)}function Ht(){At=!1,null!==_t&&Ut(_t)&&(_t=null),null!==Rt&&Ut(Rt)&&(Rt=null),null!==Ot&&Ut(Ot)&&(Ot=null),Pt.forEach(Bt),Nt.forEach(Bt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ht)))}function qt(e){function t(t){return zt(t,e)}if(0<It.length){zt(It[0],e);for(var r=1;r<It.length;r++){var n=It[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==_t&&zt(_t,e),null!==Rt&&zt(Rt,e),null!==Ot&&zt(Ot,e),Pt.forEach(t),Nt.forEach(t),r=0;r<xt.length;r++)(n=xt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<xt.length&&null===(r=xt[0]).blockedOn;)Ft(r),null===r.blockedOn&&xt.shift()}var $t=w.ReactCurrentBatchConfig,Kt=!0;function Wt(e,t,r,n){var a=bt,i=$t.transition;$t.transition=null;try{bt=1,Vt(e,t,r,n)}finally{bt=a,$t.transition=i}}function jt(e,t,r,n){var a=bt,i=$t.transition;$t.transition=null;try{bt=4,Vt(e,t,r,n)}finally{bt=a,$t.transition=i}}function Vt(e,t,r,n){if(Kt){var a=Yt(e,t,r,n);if(null===a)Kn(e,t,n,Gt,r),Lt(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return _t=Dt(_t,e,t,r,n,a),!0;case"dragenter":return Rt=Dt(Rt,e,t,r,n,a),!0;case"mouseover":return Ot=Dt(Ot,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Pt.set(i,Dt(Pt.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Nt.set(i,Dt(Nt.get(i)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Lt(e,n),4&t&&-1<Mt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&Tt(i),null===(i=Yt(e,t,r,n))&&Kn(e,t,n,Gt,r),i===a)break;a=i}null!==a&&n.stopPropagation()}else Kn(e,t,n,null,r)}}var Gt=null;function Yt(e,t,r,n){if(Gt=null,null!==(e=ya(e=Te(n))))if(null===(t=qe(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Jt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Jt,n=r.length,a="value"in Xt?Xt.value:Xt.textContent,i=a.length;for(e=0;e<n&&r[e]===a[e];e++);var o=n-e;for(t=1;t<=o&&r[n-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ar(e){function t(t,r,n,a,i){for(var o in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ir,or,sr,cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lr=ar(cr),ur=F({},cr,{view:0,detail:0}),hr=ar(ur),dr=F({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Er,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(ir=e.screenX-sr.screenX,or=e.screenY-sr.screenY):or=ir=0,sr=e),ir)},movementY:function(e){return"movementY"in e?e.movementY:or}}),fr=ar(dr),pr=ar(F({},dr,{dataTransfer:0})),gr=ar(F({},ur,{relatedTarget:0})),mr=ar(F({},cr,{animationName:0,elapsedTime:0,pseudoElement:0})),vr=F({},cr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=ar(vr),br=ar(F({},cr,{data:0})),wr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cr[e])&&!!t[e]}function Er(){return kr}var Sr=F({},ur,{key:function(e){if(e.key){var t=wr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Tr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Er,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ar=ar(Sr),Ir=ar(F({},dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_r=ar(F({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Er})),Rr=ar(F({},cr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Or=F({},dr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pr=ar(Or),Nr=[9,13,27,32],xr=u&&"CompositionEvent"in window,Mr=null;u&&"documentMode"in document&&(Mr=document.documentMode);var Lr=u&&"TextEvent"in window&&!Mr,Dr=u&&(!xr||Mr&&8<Mr&&11>=Mr),Fr=String.fromCharCode(32),Ur=!1;function Br(e,t){switch(e){case"keyup":return-1!==Nr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zr=!1;var qr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $r(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qr[e.type]:"textarea"===t}function Kr(e,t,r,n){Ae(n),0<(t=jn(t,"onChange")).length&&(r=new lr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Wr=null,jr=null;function Vr(e){Un(e,0)}function Gr(e){if(V(wa(e)))return e}function Yr(e,t){if("change"===e)return t}var Qr=!1;if(u){var Xr;if(u){var Jr="oninput"in document;if(!Jr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Jr="function"===typeof Zr.oninput}Xr=Jr}else Xr=!1;Qr=Xr&&(!document.documentMode||9<document.documentMode)}function en(){Wr&&(Wr.detachEvent("onpropertychange",tn),jr=Wr=null)}function tn(e){if("value"===e.propertyName&&Gr(jr)){var t=[];Kr(t,jr,e,Te(e)),Pe(Vr,t)}}function rn(e,t,r){"focusin"===e?(en(),jr=r,(Wr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gr(jr)}function an(e,t){if("click"===e)return Gr(t)}function on(e,t){if("input"===e||"change"===e)return Gr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!h.call(t,a)||!sn(e[a],t[a]))return!1}return!0}function ln(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=ln(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ln(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=G((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pn(e){var t=dn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=void 0===n.end?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=un(r,i);var o=un(r,n);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gn=u&&"documentMode"in document&&11>=document.documentMode,mn=null,vn=null,yn=null,bn=!1;function wn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bn||null==mn||mn!==G(n)||("selectionStart"in(n=mn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&cn(yn,n)||(yn=n,0<(n=jn(vn,"onSelect")).length&&(t=new lr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=mn)))}function Tn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Cn={animationend:Tn("Animation","AnimationEnd"),animationiteration:Tn("Animation","AnimationIteration"),animationstart:Tn("Animation","AnimationStart"),transitionend:Tn("Transition","TransitionEnd")},kn={},En={};function Sn(e){if(kn[e])return kn[e];if(!Cn[e])return e;var t,r=Cn[e];for(t in r)if(r.hasOwnProperty(t)&&t in En)return kn[e]=r[t];return e}u&&(En=document.createElement("div").style,"AnimationEvent"in window||(delete Cn.animationend.animation,delete Cn.animationiteration.animation,delete Cn.animationstart.animation),"TransitionEvent"in window||delete Cn.transitionend.transition);var An=Sn("animationend"),In=Sn("animationiteration"),_n=Sn("animationstart"),Rn=Sn("transitionend"),On=new Map,Pn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nn(e,t){On.set(e,t),c(t,[e])}for(var xn=0;xn<Pn.length;xn++){var Mn=Pn[xn];Nn(Mn.toLowerCase(),"on"+(Mn[0].toUpperCase()+Mn.slice(1)))}Nn(An,"onAnimationEnd"),Nn(In,"onAnimationIteration"),Nn(_n,"onAnimationStart"),Nn("dblclick","onDoubleClick"),Nn("focusin","onFocus"),Nn("focusout","onBlur"),Nn(Rn,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ln="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ln));function Fn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,a,o,s,c,l){if(ze.apply(this,arguments),De){if(!De)throw Error(i(198));var u=Fe;De=!1,Fe=null,Ue||(Ue=!0,Be=u)}}(n,t,void 0,e),e.currentTarget=null}function Un(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==i&&a.isPropagationStopped())break e;Fn(a,s,l),i=c}else for(o=0;o<n.length;o++){if(c=(s=n[o]).instance,l=s.currentTarget,s=s.listener,c!==i&&a.isPropagationStopped())break e;Fn(a,s,l),i=c}}}if(Ue)throw e=Be,Ue=!1,Be=null,e}function Bn(e,t){var r=t[ga];void 0===r&&(r=t[ga]=new Set);var n=e+"__bubble";r.has(n)||($n(t,e,2,!1),r.add(n))}function Hn(e,t,r){var n=0;t&&(n|=4),$n(r,e,n,t)}var zn="_reactListening"+Math.random().toString(36).slice(2);function qn(e){if(!e[zn]){e[zn]=!0,o.forEach((function(t){"selectionchange"!==t&&(Dn.has(t)||Hn(t,!1,e),Hn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zn]||(t[zn]=!0,Hn("selectionchange",!1,t))}}function $n(e,t,r,n){switch(Qt(t)){case 1:var a=Wt;break;case 4:a=jt;break;default:a=Vt}r=a.bind(null,t,r,e),a=void 0,!xe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Kn(e,t,r,n,a){var i=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var s=n.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=n.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(c=o.tag)||6===c){n=i=o;continue e}s=s.parentNode}}n=n.return}Pe((function(){var n=i,a=Te(r),o=[];e:{var s=On.get(e);if(void 0!==s){var c=lr,l=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":c=Ar;break;case"focusin":l="focus",c=gr;break;case"focusout":l="blur",c=gr;break;case"beforeblur":case"afterblur":c=gr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=pr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=_r;break;case An:case In:case _n:c=mr;break;case Rn:c=Rr;break;case"scroll":c=hr;break;case"wheel":c=Pr;break;case"copy":case"cut":case"paste":c=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Ir}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var f,p=n;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=Ne(p,d))&&u.push(Wn(p,g,f)))),h)break;p=p.return}0<u.length&&(s=new c(s,l,null,r,a),o.push({event:s,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===we||!(l=r.relatedTarget||r.fromElement)||!ya(l)&&!l[pa])&&(c||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=n,null!==(l=(l=r.relatedTarget||r.toElement)?ya(l):null)&&(l!==(h=qe(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=n),c!==l)){if(u=fr,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ir,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==c?s:wa(c),f=null==l?s:wa(l),(s=new u(g,p+"leave",c,r,a)).target=h,s.relatedTarget=f,g=null,ya(a)===n&&((u=new u(d,p+"enter",l,r,a)).target=f,u.relatedTarget=h,g=u),h=g,c&&l)e:{for(d=l,p=0,f=u=c;f;f=Vn(f))p++;for(f=0,g=d;g;g=Vn(g))f++;for(;0<p-f;)u=Vn(u),p--;for(;0<f-p;)d=Vn(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Vn(u),d=Vn(d)}u=null}else u=null;null!==c&&Gn(o,s,c,u,!1),null!==l&&null!==h&&Gn(o,h,l,u,!0)}if("select"===(c=(s=n?wa(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var m=Yr;else if($r(s))if(Qr)m=on;else{m=nn;var v=rn}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=an);switch(m&&(m=m(e,n))?Kr(o,m,r,a):(v&&v(e,s,n),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=n?wa(n):window,e){case"focusin":($r(v)||"true"===v.contentEditable)&&(mn=v,vn=n,yn=null);break;case"focusout":yn=vn=mn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,wn(o,r,a);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":wn(o,r,a)}var y;if(xr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else zr?Br(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Dr&&"ko"!==r.locale&&(zr||"onCompositionStart"!==b?"onCompositionEnd"===b&&zr&&(y=er()):(Jt="value"in(Xt=a)?Xt.value:Xt.textContent,zr=!0)),0<(v=jn(n,b)).length&&(b=new br(b,e,null,r,a),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Hr(r))&&(b.data=y))),(y=Lr?function(e,t){switch(e){case"compositionend":return Hr(t);case"keypress":return 32!==t.which?null:(Ur=!0,Fr);case"textInput":return(e=t.data)===Fr&&Ur?null:e;default:return null}}(e,r):function(e,t){if(zr)return"compositionend"===e||!xr&&Br(e,t)?(e=er(),Zt=Jt=Xt=null,zr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=jn(n,"onBeforeInput")).length&&(a=new br("onBeforeInput","beforeinput",null,r,a),o.push({event:a,listeners:n}),a.data=y))}Un(o,t)}))}function Wn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function jn(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Ne(e,r))&&n.unshift(Wn(e,i,a)),null!=(i=Ne(e,t))&&n.push(Wn(e,i,a))),e=e.return}return n}function Vn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gn(e,t,r,n,a){for(var i=t._reactName,o=[];null!==r&&r!==n;){var s=r,c=s.alternate,l=s.stateNode;if(null!==c&&c===n)break;5===s.tag&&null!==l&&(s=l,a?null!=(c=Ne(r,i))&&o.unshift(Wn(r,c,s)):a||null!=(c=Ne(r,i))&&o.push(Wn(r,c,s))),r=r.return}0!==o.length&&e.push({event:t,listeners:o})}var Yn=/\r\n?/g,Qn=/\u0000|\uFFFD/g;function Xn(e){return("string"===typeof e?e:""+e).replace(Yn,"\n").replace(Qn,"")}function Jn(e,t,r){if(t=Xn(t),Xn(e)!==t&&r)throw Error(i(425))}function Zn(){}var ea=null,ta=null;function ra(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var na="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:na;function sa(e){setTimeout((function(){throw e}))}function ca(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===n)return e.removeChild(a),void qt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=a}while(r);qt(t)}function la(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),da="__reactFiber$"+ha,fa="__reactProps$"+ha,pa="__reactContainer$"+ha,ga="__reactEvents$"+ha,ma="__reactListeners$"+ha,va="__reactHandles$"+ha;function ya(e){var t=e[da];if(t)return t;for(var r=e.parentNode;r;){if(t=r[pa]||r[da]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=ua(e);null!==e;){if(r=e[da])return r;e=ua(e)}return t}r=(e=r).parentNode}return null}function ba(e){return!(e=e[da]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function Ta(e){return e[fa]||null}var Ca=[],ka=-1;function Ea(e){return{current:e}}function Sa(e){0>ka||(e.current=Ca[ka],Ca[ka]=null,ka--)}function Aa(e,t){ka++,Ca[ka]=e.current,e.current=t}var Ia={},_a=Ea(Ia),Ra=Ea(!1),Oa=Ia;function Pa(e,t){var r=e.type.contextTypes;if(!r)return Ia;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in r)i[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Na(e){return null!==(e=e.childContextTypes)&&void 0!==e}function xa(){Sa(Ra),Sa(_a)}function Ma(e,t,r){if(_a.current!==Ia)throw Error(i(168));Aa(_a,t),Aa(Ra,r)}function La(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in t))throw Error(i(108,$(e)||"Unknown",a));return F({},r,n)}function Da(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ia,Oa=_a.current,Aa(_a,e),Aa(Ra,Ra.current),!0}function Fa(e,t,r){var n=e.stateNode;if(!n)throw Error(i(169));r?(e=La(e,t,Oa),n.__reactInternalMemoizedMergedChildContext=e,Sa(Ra),Sa(_a),Aa(_a,e)):Sa(Ra),Aa(Ra,r)}var Ua=null,Ba=!1,Ha=!1;function za(e){null===Ua?Ua=[e]:Ua.push(e)}function qa(){if(!Ha&&null!==Ua){Ha=!0;var e=0,t=bt;try{var r=Ua;for(bt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Ua=null,Ba=!1}catch(a){throw null!==Ua&&(Ua=Ua.slice(e+1)),Ve(Ze,qa),a}finally{bt=t,Ha=!1}}return null}var $a=[],Ka=0,Wa=null,ja=0,Va=[],Ga=0,Ya=null,Qa=1,Xa="";function Ja(e,t){$a[Ka++]=ja,$a[Ka++]=Wa,Wa=e,ja=t}function Za(e,t,r){Va[Ga++]=Qa,Va[Ga++]=Xa,Va[Ga++]=Ya,Ya=e;var n=Qa;e=Xa;var a=32-ot(n)-1;n&=~(1<<a),r+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Qa=1<<32-ot(t)+a|r<<a|n,Xa=i+e}else Qa=1<<i|r<<a|n,Xa=e}function ei(e){null!==e.return&&(Ja(e,1),Za(e,1,0))}function ti(e){for(;e===Wa;)Wa=$a[--Ka],$a[Ka]=null,ja=$a[--Ka],$a[Ka]=null;for(;e===Ya;)Ya=Va[--Ga],Va[Ga]=null,Xa=Va[--Ga],Va[Ga]=null,Qa=Va[--Ga],Va[Ga]=null}var ri=null,ni=null,ai=!1,ii=null;function oi(e,t){var r=Pl(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function si(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ri=e,ni=la(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ri=e,ni=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Ya?{id:Qa,overflow:Xa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Pl(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ri=e,ni=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function li(e){if(ai){var t=ni;if(t){var r=t;if(!si(e,t)){if(ci(e))throw Error(i(418));t=la(r.nextSibling);var n=ri;t&&si(e,t)?oi(n,r):(e.flags=-4097&e.flags|2,ai=!1,ri=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ri=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ri=e}function hi(e){if(e!==ri)return!1;if(!ai)return ui(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ra(e.type,e.memoizedProps)),t&&(t=ni)){if(ci(e))throw di(),Error(i(418));for(;t;)oi(e,t),t=la(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){ni=la(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}ni=null}}else ni=ri?la(e.stateNode.nextSibling):null;return!0}function di(){for(var e=ni;e;)e=la(e.nextSibling)}function fi(){ni=ri=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var gi=w.ReactCurrentBatchConfig;function mi(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(i(309));var n=r.stateNode}if(!n)throw Error(i(147,e));var a=n,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!r._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=xl(e,t)).index=0,e.sibling=null,e}function o(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,r,n){return null===t||6!==t.tag?((t=Fl(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function l(e,t,r,n){var i=r.type;return i===k?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===N&&yi(i)===t.type)?((n=a(t,r.props)).ref=mi(e,t,r),n.return=e,n):((n=Ml(r.type,r.key,r.props,null,e.mode,n)).ref=mi(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Ul(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function h(e,t,r,n,i){return null===t||7!==t.tag?((t=Ll(r,e.mode,n,i)).return=e,t):((t=a(t,r)).return=e,t)}function d(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fl(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case T:return(r=Ml(t.type,t.key,t.props,null,e.mode,r)).ref=mi(e,null,t),r.return=e,r;case C:return(t=Ul(t,e.mode,r)).return=e,t;case N:return d(e,(0,t._init)(t._payload),r)}if(te(t)||L(t))return(t=Ll(t,e.mode,r,null)).return=e,t;vi(e,t)}return null}function f(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==a?null:c(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case T:return r.key===a?l(e,t,r,n):null;case C:return r.key===a?u(e,t,r,n):null;case N:return f(e,t,(a=r._init)(r._payload),n)}if(te(r)||L(r))return null!==a?null:h(e,t,r,n,null);vi(e,r)}return null}function p(e,t,r,n,a){if("string"===typeof n&&""!==n||"number"===typeof n)return c(t,e=e.get(r)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case T:return l(t,e=e.get(null===n.key?r:n.key)||null,n,a);case C:return u(t,e=e.get(null===n.key?r:n.key)||null,n,a);case N:return p(e,t,r,(0,n._init)(n._payload),a)}if(te(n)||L(n))return h(t,e=e.get(r)||null,n,a,null);vi(t,n)}return null}function g(a,i,s,c){for(var l=null,u=null,h=i,g=i=0,m=null;null!==h&&g<s.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(a,h,s[g],c);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(a,h),i=o(v,i,g),null===u?l=v:u.sibling=v,u=v,h=m}if(g===s.length)return r(a,h),ai&&Ja(a,g),l;if(null===h){for(;g<s.length;g++)null!==(h=d(a,s[g],c))&&(i=o(h,i,g),null===u?l=h:u.sibling=h,u=h);return ai&&Ja(a,g),l}for(h=n(a,h);g<s.length;g++)null!==(m=p(h,a,g,s[g],c))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),i=o(m,i,g),null===u?l=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(a,e)})),ai&&Ja(a,g),l}function m(a,s,c,l){var u=L(c);if("function"!==typeof u)throw Error(i(150));if(null==(c=u.call(c)))throw Error(i(151));for(var h=u=null,g=s,m=s=0,v=null,y=c.next();null!==g&&!y.done;m++,y=c.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(a,g,y.value,l);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(a,g),s=o(b,s,m),null===h?u=b:h.sibling=b,h=b,g=v}if(y.done)return r(a,g),ai&&Ja(a,m),u;if(null===g){for(;!y.done;m++,y=c.next())null!==(y=d(a,y.value,l))&&(s=o(y,s,m),null===h?u=y:h.sibling=y,h=y);return ai&&Ja(a,m),u}for(g=n(a,g);!y.done;m++,y=c.next())null!==(y=p(g,a,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),s=o(y,s,m),null===h?u=y:h.sibling=y,h=y);return e&&g.forEach((function(e){return t(a,e)})),ai&&Ja(a,m),u}return function e(n,i,o,c){if("object"===typeof o&&null!==o&&o.type===k&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case T:e:{for(var l=o.key,u=i;null!==u;){if(u.key===l){if((l=o.type)===k){if(7===u.tag){r(n,u.sibling),(i=a(u,o.props.children)).return=n,n=i;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===N&&yi(l)===u.type){r(n,u.sibling),(i=a(u,o.props)).ref=mi(n,u,o),i.return=n,n=i;break e}r(n,u);break}t(n,u),u=u.sibling}o.type===k?((i=Ll(o.props.children,n.mode,c,o.key)).return=n,n=i):((c=Ml(o.type,o.key,o.props,null,n.mode,c)).ref=mi(n,i,o),c.return=n,n=c)}return s(n);case C:e:{for(u=o.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){r(n,i.sibling),(i=a(i,o.children||[])).return=n,n=i;break e}r(n,i);break}t(n,i),i=i.sibling}(i=Ul(o,n.mode,c)).return=n,n=i}return s(n);case N:return e(n,i,(u=o._init)(o._payload),c)}if(te(o))return g(n,i,o,c);if(L(o))return m(n,i,o,c);vi(n,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(r(n,i.sibling),(i=a(i,o)).return=n,n=i):(r(n,i),(i=Fl(o,n.mode,c)).return=n,n=i),s(n)):r(n,i)}}var wi=bi(!0),Ti=bi(!1),Ci=Ea(null),ki=null,Ei=null,Si=null;function Ai(){Si=Ei=ki=null}function Ii(e){var t=Ci.current;Sa(Ci),e._currentValue=t}function _i(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ri(e,t){ki=e,Si=Ei=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Oi(e){var t=e._currentValue;if(Si!==e)if(e={context:e,memoizedValue:t,next:null},null===Ei){if(null===ki)throw Error(i(308));Ei=e,ki.dependencies={lanes:0,firstContext:e}}else Ei=Ei.next=e;return t}var Pi=null;function Ni(e){null===Pi?Pi=[e]:Pi.push(e)}function xi(e,t,r,n){var a=t.interleaved;return null===a?(r.next=r,Ni(t)):(r.next=a.next,a.next=r),t.interleaved=r,Mi(e,n)}function Mi(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Li=!1;function Di(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ui(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bi(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&_c)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Mi(e,r)}return null===(a=n.interleaved)?(t.next=t,Ni(n)):(t.next=a.next,a.next=t),n.interleaved=t,Mi(e,r)}function Hi(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}function zi(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===i?a=i=o:i=i.next=o,r=r.next}while(null!==r);null===i?a=i=t:i=i.next=t}else a=i=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function qi(e,t,r,n){var a=e.updateQueue;Li=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var c=s,l=c.next;c.next=null,null===o?i=l:o.next=l,o=c;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==i){var h=a.baseState;for(o=0,u=l=c=null,s=i;;){var d=s.lane,f=s.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,g=s;switch(d=t,f=r,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:Li=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=a.effects)?a.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=f,c=h):u=u.next=f,o|=d;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(d=s).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===u&&(c=h),a.baseState=c,a.firstBaseUpdate=l,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Dc|=o,e.lanes=o,e.memoizedState=h}}function $i(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=r,"function"!==typeof a)throw Error(i(191,a));a.call(n)}}}var Ki={},Wi=Ea(Ki),ji=Ea(Ki),Vi=Ea(Ki);function Gi(e){if(e===Ki)throw Error(i(174));return e}function Yi(e,t){switch(Aa(Vi,t),Aa(ji,e),Aa(Wi,Ki),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sa(Wi),Aa(Wi,t)}function Qi(){Sa(Wi),Sa(ji),Sa(Vi)}function Xi(e){Gi(Vi.current);var t=Gi(Wi.current),r=ce(t,e.type);t!==r&&(Aa(ji,e),Aa(Wi,r))}function Ji(e){ji.current===e&&(Sa(Wi),Sa(ji))}var Zi=Ea(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function ro(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var no=w.ReactCurrentDispatcher,ao=w.ReactCurrentBatchConfig,io=0,oo=null,so=null,co=null,lo=!1,uo=!1,ho=0,fo=0;function po(){throw Error(i(321))}function go(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function mo(e,t,r,n,a,o){if(io=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,no.current=null===e||null===e.memoizedState?Zo:es,e=r(n,a),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(i(301));o+=1,co=so=null,t.updateQueue=null,no.current=ts,e=r(n,a)}while(uo)}if(no.current=Jo,t=null!==so&&null!==so.next,io=0,co=so=oo=null,lo=!1,t)throw Error(i(300));return e}function vo(){var e=0!==ho;return ho=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===co?oo.memoizedState=co=e:co=co.next=e,co}function bo(){if(null===so){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=so.next;var t=null===co?oo.memoizedState:co.next;if(null!==t)co=t,so=e;else{if(null===e)throw Error(i(310));e={memoizedState:(so=e).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===co?oo.memoizedState=co=e:co=co.next=e}return co}function wo(e,t){return"function"===typeof t?t(e):t}function To(e){var t=bo(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=so,a=n.baseQueue,o=r.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}n.baseQueue=a=o,r.pending=null}if(null!==a){o=a.next,n=n.baseState;var c=s=null,l=null,u=o;do{var h=u.lane;if((io&h)===h)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=d,s=n):l=l.next=d,oo.lanes|=h,Dc|=h}u=u.next}while(null!==u&&u!==o);null===l?s=n:l.next=c,sn(n,t.memoizedState)||(bs=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(null!==(e=r.interleaved)){a=e;do{o=a.lane,oo.lanes|=o,Dc|=o,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Co(e){var t=bo(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,o=t.memoizedState;if(null!==a){r.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sn(o,t.memoizedState)||(bs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function ko(){}function Eo(e,t){var r=oo,n=bo(),a=t(),o=!sn(n.memoizedState,a);if(o&&(n.memoizedState=a,bs=!0),n=n.queue,Do(Io.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||null!==co&&1&co.memoizedState.tag){if(r.flags|=2048,Po(9,Ao.bind(null,r,n,a,t),void 0,null),null===Rc)throw Error(i(349));0!==(30&io)||So(r,t,a)}return a}function So(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ao(e,t,r,n){t.value=r,t.getSnapshot=n,_o(t)&&Ro(e)}function Io(e,t,r){return r((function(){_o(t)&&Ro(e)}))}function _o(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sn(e,r)}catch(n){return!0}}function Ro(e){var t=Mi(e,1);null!==t&&rl(t,e,1,-1)}function Oo(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Go.bind(null,oo,e),[t.memoizedState,e]}function Po(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function No(){return bo().memoizedState}function xo(e,t,r,n){var a=yo();oo.flags|=e,a.memoizedState=Po(1|t,r,void 0,void 0===n?null:n)}function Mo(e,t,r,n){var a=bo();n=void 0===n?null:n;var i=void 0;if(null!==so){var o=so.memoizedState;if(i=o.destroy,null!==n&&go(n,o.deps))return void(a.memoizedState=Po(t,r,i,n))}oo.flags|=e,a.memoizedState=Po(1|t,r,i,n)}function Lo(e,t){return xo(8390656,8,e,t)}function Do(e,t){return Mo(2048,8,e,t)}function Fo(e,t){return Mo(4,2,e,t)}function Uo(e,t){return Mo(4,4,e,t)}function Bo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ho(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Mo(4,4,Bo.bind(null,t,e),r)}function zo(){}function qo(e,t){var r=bo();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&go(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function $o(e,t){var r=bo();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&go(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ko(e,t,r){return 0===(21&io)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=r):(sn(r,t)||(r=gt(),oo.lanes|=r,Dc|=r,e.baseState=!0),t)}function Wo(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var n=ao.transition;ao.transition={};try{e(!1),t()}finally{bt=r,ao.transition=n}}function jo(){return bo().memoizedState}function Vo(e,t,r){var n=tl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Yo(e))Qo(t,r);else if(null!==(r=xi(e,t,r,n))){rl(r,e,n,el()),Xo(r,t,n)}}function Go(e,t,r){var n=tl(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Yo(e))Qo(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,r);if(a.hasEagerState=!0,a.eagerState=s,sn(s,o)){var c=t.interleaved;return null===c?(a.next=a,Ni(t)):(a.next=c.next,c.next=a),void(t.interleaved=a)}}catch(l){}null!==(r=xi(e,t,a,n))&&(rl(r,e,n,a=el()),Xo(r,t,n))}}function Yo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Qo(e,t){uo=lo=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Xo(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}var Jo={readContext:Oi,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Zo={readContext:Oi,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:Oi,useEffect:Lo,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,xo(4194308,4,Bo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return xo(4194308,4,e,t)},useInsertionEffect:function(e,t){return xo(4,2,e,t)},useMemo:function(e,t){var r=yo();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=yo();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Vo.bind(null,oo,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:Oo,useDebugValue:zo,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=Oo(!1),t=e[0];return e=Wo.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=oo,a=yo();if(ai){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===Rc)throw Error(i(349));0!==(30&io)||So(n,t,r)}a.memoizedState=r;var o={value:r,getSnapshot:t};return a.queue=o,Lo(Io.bind(null,n,o,e),[e]),n.flags|=2048,Po(9,Ao.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=yo(),t=Rc.identifierPrefix;if(ai){var r=Xa;t=":"+t+"R"+(r=(Qa&~(1<<32-ot(Qa)-1)).toString(32)+r),0<(r=ho++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Oi,useCallback:qo,useContext:Oi,useEffect:Do,useImperativeHandle:Ho,useInsertionEffect:Fo,useLayoutEffect:Uo,useMemo:$o,useReducer:To,useRef:No,useState:function(){return To(wo)},useDebugValue:zo,useDeferredValue:function(e){return Ko(bo(),so.memoizedState,e)},useTransition:function(){return[To(wo)[0],bo().memoizedState]},useMutableSource:ko,useSyncExternalStore:Eo,useId:jo,unstable_isNewReconciler:!1},ts={readContext:Oi,useCallback:qo,useContext:Oi,useEffect:Do,useImperativeHandle:Ho,useInsertionEffect:Fo,useLayoutEffect:Uo,useMemo:$o,useReducer:Co,useRef:No,useState:function(){return Co(wo)},useDebugValue:zo,useDeferredValue:function(e){var t=bo();return null===so?t.memoizedState=e:Ko(t,so.memoizedState,e)},useTransition:function(){return[Co(wo)[0],bo().memoizedState]},useMutableSource:ko,useSyncExternalStore:Eo,useId:jo,unstable_isNewReconciler:!1};function rs(e,t){if(e&&e.defaultProps){for(var r in t=F({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ns(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:F({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var as={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=el(),a=tl(e),i=Ui(n,a);i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=Bi(e,i,a))&&(rl(t,e,a,n),Hi(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=el(),a=tl(e),i=Ui(n,a);i.tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=Bi(e,i,a))&&(rl(t,e,a,n),Hi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=el(),n=tl(e),a=Ui(r,n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Bi(e,a,n))&&(rl(t,e,n,r),Hi(t,e,n))}};function is(e,t,r,n,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!cn(r,n)||!cn(a,i))}function os(e,t,r){var n=!1,a=Ia,i=t.contextType;return"object"===typeof i&&null!==i?i=Oi(i):(a=Na(t)?Oa:_a.current,i=(n=null!==(n=t.contextTypes)&&void 0!==n)?Pa(e,a):Ia),t=new t(r,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=as,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function ss(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&as.enqueueReplaceState(t,t.state,null)}function cs(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Di(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Oi(i):(i=Na(t)?Oa:_a.current,a.context=Pa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(ns(e,t,i,r),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&as.enqueueReplaceState(a,a.state,null),qi(e,r,a,n),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ls(e,t){try{var r="",n=t;do{r+=z(n),n=n.return}while(n);var a=r}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function us(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,r){(r=Ui(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Kc||(Kc=!0,Wc=n),hs(0,t)},r}function ps(e,t,r){(r=Ui(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){hs(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(r.callback=function(){hs(0,t),"function"!==typeof n&&(null===jc?jc=new Set([this]):jc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function gs(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ds;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Sl.bind(null,e,t,r),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,r,n,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Ui(-1,1)).tag=2,Bi(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var ys=w.ReactCurrentOwner,bs=!1;function ws(e,t,r,n){t.child=null===e?Ti(t,null,r,n):wi(t,e.child,r,n)}function Ts(e,t,r,n,a){r=r.render;var i=t.ref;return Ri(t,a),n=mo(e,t,r,n,i,a),r=vo(),null===e||bs?(ai&&r&&ei(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ks(e,t,a))}function Cs(e,t,r,n,a){if(null===e){var i=r.type;return"function"!==typeof i||Nl(i)||void 0!==i.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Ml(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,ks(e,t,i,n,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((r=null!==(r=r.compare)?r:cn)(o,n)&&e.ref===t.ref)return Ks(e,t,a)}return t.flags|=1,(e=xl(i,n)).ref=t.ref,e.return=t,t.child=e}function ks(e,t,r,n,a){if(null!==e){var i=e.memoizedProps;if(cn(i,n)&&e.ref===t.ref){if(bs=!1,t.pendingProps=n=i,0===(e.lanes&a))return t.lanes=e.lanes,Ks(e,t,a);0!==(131072&e.flags)&&(bs=!0)}}return As(e,t,r,n,a)}function Es(e,t,r){var n=t.pendingProps,a=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Aa(xc,Nc),Nc|=r;else{if(0===(1073741824&r))return e=null!==i?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Aa(xc,Nc),Nc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==i?i.baseLanes:r,Aa(xc,Nc),Nc|=n}else null!==i?(n=i.baseLanes|r,t.memoizedState=null):n=r,Aa(xc,Nc),Nc|=n;return ws(e,t,a,r),t.child}function Ss(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function As(e,t,r,n,a){var i=Na(r)?Oa:_a.current;return i=Pa(t,i),Ri(t,a),r=mo(e,t,r,n,i,a),n=vo(),null===e||bs?(ai&&n&&ei(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ks(e,t,a))}function Is(e,t,r,n,a){if(Na(r)){var i=!0;Da(t)}else i=!1;if(Ri(t,a),null===t.stateNode)$s(e,t),os(t,r,n),cs(t,r,n,a),n=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var c=o.context,l=r.contextType;"object"===typeof l&&null!==l?l=Oi(l):l=Pa(t,l=Na(r)?Oa:_a.current);var u=r.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==n||c!==l)&&ss(t,o,n,l),Li=!1;var d=t.memoizedState;o.state=d,qi(t,n,o,a),c=t.memoizedState,s!==n||d!==c||Ra.current||Li?("function"===typeof u&&(ns(t,r,u,n),c=t.memoizedState),(s=Li||is(t,r,s,n,d,c,l))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=l,n=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Fi(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:rs(t.type,s),o.props=l,h=t.pendingProps,d=o.context,"object"===typeof(c=r.contextType)&&null!==c?c=Oi(c):c=Pa(t,c=Na(r)?Oa:_a.current);var f=r.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==c)&&ss(t,o,n,c),Li=!1,d=t.memoizedState,o.state=d,qi(t,n,o,a);var p=t.memoizedState;s!==h||d!==p||Ra.current||Li?("function"===typeof f&&(ns(t,r,f,n),p=t.memoizedState),(l=Li||is(t,r,l,n,d,p,c)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(n,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),o.props=n,o.state=p,o.context=c,n=l):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return _s(e,t,r,n,i,a)}function _s(e,t,r,n,a,i){Ss(e,t);var o=0!==(128&t.flags);if(!n&&!o)return a&&Fa(t,r,!1),Ks(e,t,i);n=t.stateNode,ys.current=t;var s=o&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=n.state,a&&Fa(t,r,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),Yi(e,t.containerInfo)}function Os(e,t,r,n,a){return fi(),pi(a),t.flags|=256,ws(e,t,r,n),t.child}var Ps,Ns,xs,Ms,Ls={dehydrated:null,treeContext:null,retryLane:0};function Ds(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fs(e,t,r){var n,a=t.pendingProps,o=Zi.current,s=!1,c=0!==(128&t.flags);if((n=c)||(n=(null===e||null!==e.memoizedState)&&0!==(2&o)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Aa(Zi,1&o),null===e)return li(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=a.children,e=a.fallback,s?(a=t.mode,s=t.child,c={mode:"hidden",children:c},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Dl(c,a,0,null),e=Ll(e,a,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ds(r),t.memoizedState=Ls,e):Us(t,c));if(null!==(o=e.memoizedState)&&null!==(n=o.dehydrated))return function(e,t,r,n,a,o,s){if(r)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,n=us(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=n.fallback,a=t.mode,n=Dl({mode:"visible",children:n.children},a,0,null),(o=Ll(o,a,s,null)).flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,0!==(1&t.mode)&&wi(t,e.child,null,s),t.child.memoizedState=Ds(s),t.memoizedState=Ls,o);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var c=n.dgst;return n=c,Bs(e,t,s,n=us(o=Error(i(419)),n,void 0))}if(c=0!==(s&e.childLanes),bs||c){if(null!==(n=Rc)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Mi(e,a),rl(n,e,a,-1))}return gl(),Bs(e,t,s,n=us(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ni=la(a.nextSibling),ri=t,ai=!0,ii=null,null!==e&&(Va[Ga++]=Qa,Va[Ga++]=Xa,Va[Ga++]=Ya,Qa=e.id,Xa=e.overflow,Ya=t),t=Us(t,n.children),t.flags|=4096,t)}(e,t,c,a,n,o,r);if(s){s=a.fallback,c=t.mode,n=(o=e.child).sibling;var l={mode:"hidden",children:a.children};return 0===(1&c)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=l,t.deletions=null):(a=xl(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==n?s=xl(n,s):(s=Ll(s,c,r,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,c=null===(c=e.child.memoizedState)?Ds(r):{baseLanes:c.baseLanes|r,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~r,t.memoizedState=Ls,a}return e=(s=e.child).sibling,a=xl(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=r),a.return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Us(e,t){return(t=Dl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,r,n){return null!==n&&pi(n),wi(t,e.child,null,r),(e=Us(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Hs(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),_i(e.return,t,r)}function zs(e,t,r,n,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function qs(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(ws(e,t,n.children,r),0!==(2&(n=Zi.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Hs(e,r,t);else if(19===e.tag)Hs(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Aa(Zi,n),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===eo(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),zs(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===eo(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}zs(t,!0,r,null,i);break;case"together":zs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $s(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ks(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Dc|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=xl(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=xl(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Ws(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function js(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Vs(e,t,r){var n=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return js(t),null;case 1:case 17:return Na(t.type)&&xa(),js(t),null;case 3:return n=t.stateNode,Qi(),Sa(Ra),Sa(_a),ro(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(ol(ii),ii=null))),Ns(e,t),js(t),null;case 5:Ji(t);var a=Gi(Vi.current);if(r=t.type,null!==e&&null!=t.stateNode)xs(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(i(166));return js(t),null}if(e=Gi(Wi.current),hi(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[da]=t,n[fa]=o,e=0!==(1&t.mode),r){case"dialog":Bn("cancel",n),Bn("close",n);break;case"iframe":case"object":case"embed":Bn("load",n);break;case"video":case"audio":for(a=0;a<Ln.length;a++)Bn(Ln[a],n);break;case"source":Bn("error",n);break;case"img":case"image":case"link":Bn("error",n),Bn("load",n);break;case"details":Bn("toggle",n);break;case"input":Q(n,o),Bn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Bn("invalid",n);break;case"textarea":ae(n,o),Bn("invalid",n)}for(var c in ye(r,o),a=null,o)if(o.hasOwnProperty(c)){var l=o[c];"children"===c?"string"===typeof l?n.textContent!==l&&(!0!==o.suppressHydrationWarning&&Jn(n.textContent,l,e),a=["children",l]):"number"===typeof l&&n.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&Jn(n.textContent,l,e),a=["children",""+l]):s.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Bn("scroll",n)}switch(r){case"input":j(n),Z(n,o,!0);break;case"textarea":j(n),oe(n);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(n.onclick=Zn)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=c.createElement(r,{is:n.is}):(e=c.createElement(r),"select"===r&&(c=e,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):e=c.createElementNS(e,r),e[da]=t,e[fa]=n,Ps(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(r,n),r){case"dialog":Bn("cancel",e),Bn("close",e),a=n;break;case"iframe":case"object":case"embed":Bn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Ln.length;a++)Bn(Ln[a],e);a=n;break;case"source":Bn("error",e),a=n;break;case"img":case"image":case"link":Bn("error",e),Bn("load",e),a=n;break;case"details":Bn("toggle",e),a=n;break;case"input":Q(e,n),a=Y(e,n),Bn("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=F({},n,{value:void 0}),Bn("invalid",e);break;case"textarea":ae(e,n),a=ne(e,n),Bn("invalid",e)}for(o in ye(r,a),l=a)if(l.hasOwnProperty(o)){var u=l[o];"style"===o?me(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==r||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Bn("scroll",e):null!=u&&b(e,o,u,c))}switch(r){case"input":j(e),Z(e,n,!1);break;case"textarea":j(e),oe(e);break;case"option":null!=n.value&&e.setAttribute("value",""+K(n.value));break;case"select":e.multiple=!!n.multiple,null!=(o=n.value)?re(e,!!n.multiple,o,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return js(t),null;case 6:if(e&&null!=t.stateNode)Ms(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(r=Gi(Vi.current),Gi(Wi.current),hi(t)){if(n=t.stateNode,r=t.memoizedProps,n[da]=t,(o=n.nodeValue!==r)&&null!==(e=ri))switch(e.tag){case 3:Jn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jn(n.nodeValue,r,0!==(1&e.mode))}o&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[da]=t,t.stateNode=n}return js(t),null;case 13:if(Sa(Zi),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ni&&0!==(1&t.mode)&&0===(128&t.flags))di(),fi(),t.flags|=98560,o=!1;else if(o=hi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[da]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;js(t),o=!1}else null!==ii&&(ol(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Mc&&(Mc=3):gl())),null!==t.updateQueue&&(t.flags|=4),js(t),null);case 4:return Qi(),Ns(e,t),null===e&&qn(t.stateNode.containerInfo),js(t),null;case 10:return Ii(t.type._context),js(t),null;case 19:if(Sa(Zi),null===(o=t.memoizedState))return js(t),null;if(n=0!==(128&t.flags),null===(c=o.rendering))if(n)Ws(o,!1);else{if(0!==Mc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=eo(e))){for(t.flags|=128,Ws(o,!1),null!==(n=c.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(o=r).flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,e=c.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Aa(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>qc&&(t.flags|=128,n=!0,Ws(o,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=eo(c))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Ws(o,!0),null===o.tail&&"hidden"===o.tailMode&&!c.alternate&&!ai)return js(t),null}else 2*Xe()-o.renderingStartTime>qc&&1073741824!==r&&(t.flags|=128,n=!0,Ws(o,!1),t.lanes=4194304);o.isBackwards?(c.sibling=t.child,t.child=c):(null!==(r=o.last)?r.sibling=c:t.child=c,o.last=c)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,r=Zi.current,Aa(Zi,n?1&r|2:1&r),t):(js(t),null);case 22:case 23:return hl(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Nc)&&(js(t),6&t.subtreeFlags&&(t.flags|=8192)):js(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Gs(e,t){switch(ti(t),t.tag){case 1:return Na(t.type)&&xa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Qi(),Sa(Ra),Sa(_a),ro(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ji(t),null;case 13:if(Sa(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sa(Zi),null;case 4:return Qi(),null;case 10:return Ii(t.type._context),null;case 22:case 23:return hl(),null;default:return null}}Ps=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Ns=function(){},xs=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Gi(Wi.current);var i,o=null;switch(r){case"input":a=Y(e,a),n=Y(e,n),o=[];break;case"select":a=F({},a,{value:void 0}),n=F({},n,{value:void 0}),o=[];break;case"textarea":a=ne(e,a),n=ne(e,n),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(u in ye(r,n),r=null,a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var c=a[u];for(i in c)c.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var l=n[u];if(c=null!=a?a[u]:void 0,n.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(o||(o=[]),o.push(u,r)),r=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(o=o||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Bn("scroll",e),o||c===l||(o=[])):(o=o||[]).push(u,l))}r&&(o=o||[]).push("style",r);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Ms=function(e,t,r,n){r!==n&&(t.flags|=4)};var Ys=!1,Qs=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Js=null;function Zs(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){El(e,t,n)}else r.current=null}function ec(e,t,r){try{r()}catch(n){El(e,t,n)}}var tc=!1;function rc(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&ec(t,r,i)}a=a.next}while(a!==n)}}function nc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ac(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function ic(e){var t=e.alternate;null!==t&&(e.alternate=null,ic(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[da],delete t[fa],delete t[ga],delete t[ma],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function oc(e){return 5===e.tag||3===e.tag||4===e.tag}function sc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||oc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(cc(e,t,r),e=e.sibling;null!==e;)cc(e,t,r),e=e.sibling}function lc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(lc(e,t,r),e=e.sibling;null!==e;)lc(e,t,r),e=e.sibling}var uc=null,hc=!1;function dc(e,t,r){for(r=r.child;null!==r;)fc(e,t,r),r=r.sibling}function fc(e,t,r){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,r)}catch(s){}switch(r.tag){case 5:Qs||Zs(r,t);case 6:var n=uc,a=hc;uc=null,dc(e,t,r),hc=a,null!==(uc=n)&&(hc?(e=uc,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):uc.removeChild(r.stateNode));break;case 18:null!==uc&&(hc?(e=uc,r=r.stateNode,8===e.nodeType?ca(e.parentNode,r):1===e.nodeType&&ca(e,r),qt(e)):ca(uc,r.stateNode));break;case 4:n=uc,a=hc,uc=r.stateNode.containerInfo,hc=!0,dc(e,t,r),uc=n,hc=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&ec(r,t,o),a=a.next}while(a!==n)}dc(e,t,r);break;case 1:if(!Qs&&(Zs(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){El(r,t,s)}dc(e,t,r);break;case 21:dc(e,t,r);break;case 22:1&r.mode?(Qs=(n=Qs)||null!==r.memoizedState,dc(e,t,r),Qs=n):dc(e,t,r);break;default:dc(e,t,r)}}function pc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Xs),t.forEach((function(t){var n=_l.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function gc(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n];try{var o=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,hc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,hc=!0;break e}c=c.return}if(null===uc)throw Error(i(160));fc(o,s,a),uc=null,hc=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(u){El(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mc(t,e),t=t.sibling}function mc(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),vc(e),4&n){try{rc(3,e,e.return),nc(3,e)}catch(m){El(e,e.return,m)}try{rc(5,e,e.return)}catch(m){El(e,e.return,m)}}break;case 1:gc(t,e),vc(e),512&n&&null!==r&&Zs(r,r.return);break;case 5:if(gc(t,e),vc(e),512&n&&null!==r&&Zs(r,r.return),32&e.flags){var a=e.stateNode;try{de(a,"")}catch(m){El(e,e.return,m)}}if(4&n&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==r?r.memoizedProps:o,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===o.type&&null!=o.name&&X(a,o),be(c,s);var u=be(c,o);for(s=0;s<l.length;s+=2){var h=l[s],d=l[s+1];"style"===h?me(a,d):"dangerouslySetInnerHTML"===h?he(a,d):"children"===h?de(a,d):b(a,h,d,u)}switch(c){case"input":J(a,o);break;case"textarea":ie(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?re(a,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?re(a,!!o.multiple,o.defaultValue,!0):re(a,!!o.multiple,o.multiple?[]:"",!1))}a[fa]=o}catch(m){El(e,e.return,m)}}break;case 6:if(gc(t,e),vc(e),4&n){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(m){El(e,e.return,m)}}break;case 3:if(gc(t,e),vc(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(m){El(e,e.return,m)}break;case 4:default:gc(t,e),vc(e);break;case 13:gc(t,e),vc(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(zc=Xe())),4&n&&pc(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Qs=(u=Qs)||h,gc(t,e),Qs=u):gc(t,e),vc(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Js=e,h=e.child;null!==h;){for(d=Js=h;null!==Js;){switch(p=(f=Js).child,f.tag){case 0:case 11:case 14:case 15:rc(4,f,f.return);break;case 1:Zs(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){n=f,r=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){El(n,r,m)}}break;case 5:Zs(f,f.return);break;case 22:if(null!==f.memoizedState){Tc(d);continue}}null!==p?(p.return=f,Js=p):Tc(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{a=d.stateNode,u?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=d.stateNode,s=void 0!==(l=d.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=ge("display",s))}catch(m){El(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){El(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gc(t,e),vc(e),4&n&&pc(e);case 21:}}function vc(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(oc(r)){var n=r;break e}r=r.return}throw Error(i(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(de(a,""),n.flags&=-33),lc(e,sc(e),a);break;case 3:case 4:var o=n.stateNode.containerInfo;cc(e,sc(e),o);break;default:throw Error(i(161))}}catch(s){El(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yc(e,t,r){Js=e,bc(e,t,r)}function bc(e,t,r){for(var n=0!==(1&e.mode);null!==Js;){var a=Js,i=a.child;if(22===a.tag&&n){var o=null!==a.memoizedState||Ys;if(!o){var s=a.alternate,c=null!==s&&null!==s.memoizedState||Qs;s=Ys;var l=Qs;if(Ys=o,(Qs=c)&&!l)for(Js=a;null!==Js;)c=(o=Js).child,22===o.tag&&null!==o.memoizedState?Cc(a):null!==c?(c.return=o,Js=c):Cc(a);for(;null!==i;)Js=i,bc(i,t,r),i=i.sibling;Js=a,Ys=s,Qs=l}wc(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Js=i):wc(e)}}function wc(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||nc(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Qs)if(null===r)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:rs(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&$i(t,o,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}$i(t,s,r)}break;case 5:var c=t.stateNode;if(null===r&&4&t.flags){r=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&qt(d)}}}break;default:throw Error(i(163))}Qs||512&t.flags&&ac(t)}catch(f){El(t,t.return,f)}}if(t===e){Js=null;break}if(null!==(r=t.sibling)){r.return=t.return,Js=r;break}Js=t.return}}function Tc(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Js=r;break}Js=t.return}}function Cc(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nc(4,t)}catch(c){El(t,r,c)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(c){El(t,a,c)}}var i=t.return;try{ac(t)}catch(c){El(t,i,c)}break;case 5:var o=t.return;try{ac(t)}catch(c){El(t,o,c)}}}catch(c){El(t,t.return,c)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var kc,Ec=Math.ceil,Sc=w.ReactCurrentDispatcher,Ac=w.ReactCurrentOwner,Ic=w.ReactCurrentBatchConfig,_c=0,Rc=null,Oc=null,Pc=0,Nc=0,xc=Ea(0),Mc=0,Lc=null,Dc=0,Fc=0,Uc=0,Bc=null,Hc=null,zc=0,qc=1/0,$c=null,Kc=!1,Wc=null,jc=null,Vc=!1,Gc=null,Yc=0,Qc=0,Xc=null,Jc=-1,Zc=0;function el(){return 0!==(6&_c)?Xe():-1!==Jc?Jc:Jc=Xe()}function tl(e){return 0===(1&e.mode)?1:0!==(2&_c)&&0!==Pc?Pc&-Pc:null!==gi.transition?(0===Zc&&(Zc=gt()),Zc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function rl(e,t,r,n){if(50<Qc)throw Qc=0,Xc=null,Error(i(185));vt(e,r,n),0!==(2&_c)&&e===Rc||(e===Rc&&(0===(2&_c)&&(Fc|=r),4===Mc&&sl(e,Pc)),nl(e,n),1===r&&0===_c&&0===(1&t.mode)&&(qc=Xe()+500,Ba&&qa()))}function nl(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,c=a[o];-1===c?0!==(s&r)&&0===(s&n)||(a[o]=ft(s,t)):c<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var n=dt(e,e===Rc?Pc:0);if(0===n)null!==r&&Ge(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Ge(r),1===t)0===e.tag?function(e){Ba=!0,za(e)}(cl.bind(null,e)):za(cl.bind(null,e)),oa((function(){0===(6&_c)&&qa()})),r=null;else{switch(wt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Rl(r,al.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function al(e,t){if(Jc=-1,Zc=0,0!==(6&_c))throw Error(i(327));var r=e.callbackNode;if(Cl()&&e.callbackNode!==r)return null;var n=dt(e,e===Rc?Pc:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=ml(e,n);else{t=n;var a=_c;_c|=2;var o=pl();for(Rc===e&&Pc===t||($c=null,qc=Xe()+500,dl(e,t));;)try{yl();break}catch(c){fl(e,c)}Ai(),Sc.current=o,_c=a,null!==Oc?t=0:(Rc=null,Pc=0,t=Mc)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(n=a,t=il(e,a))),1===t)throw r=Lc,dl(e,0),sl(e,n),nl(e,Xe()),r;if(6===t)sl(e,n);else{if(a=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!sn(i(),a))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=ml(e,n))&&(0!==(o=pt(e))&&(n=o,t=il(e,o))),1===t))throw r=Lc,dl(e,0),sl(e,n),nl(e,Xe()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(i(345));case 2:case 5:Tl(e,Hc,$c);break;case 3:if(sl(e,n),(130023424&n)===n&&10<(t=zc+500-Xe())){if(0!==dt(e,0))break;if(((a=e.suspendedLanes)&n)!==n){el(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=na(Tl.bind(null,e,Hc,$c),t);break}Tl(e,Hc,$c);break;case 4:if(sl(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-ot(n);o=1<<s,(s=t[s])>a&&(a=s),n&=~o}if(n=a,10<(n=(120>(n=Xe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ec(n/1960))-n)){e.timeoutHandle=na(Tl.bind(null,e,Hc,$c),n);break}Tl(e,Hc,$c);break;default:throw Error(i(329))}}}return nl(e,Xe()),e.callbackNode===r?al.bind(null,e):null}function il(e,t){var r=Bc;return e.current.memoizedState.isDehydrated&&(dl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=Hc,Hc=r,null!==t&&ol(t)),e}function ol(e){null===Hc?Hc=e:Hc.push.apply(Hc,e)}function sl(e,t){for(t&=~Uc,t&=~Fc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ot(t),n=1<<r;e[r]=-1,t&=~n}}function cl(e){if(0!==(6&_c))throw Error(i(327));Cl();var t=dt(e,0);if(0===(1&t))return nl(e,Xe()),null;var r=ml(e,t);if(0!==e.tag&&2===r){var n=pt(e);0!==n&&(t=n,r=il(e,n))}if(1===r)throw r=Lc,dl(e,0),sl(e,t),nl(e,Xe()),r;if(6===r)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Tl(e,Hc,$c),nl(e,Xe()),null}function ll(e,t){var r=_c;_c|=1;try{return e(t)}finally{0===(_c=r)&&(qc=Xe()+500,Ba&&qa())}}function ul(e){null!==Gc&&0===Gc.tag&&0===(6&_c)&&Cl();var t=_c;_c|=1;var r=Ic.transition,n=bt;try{if(Ic.transition=null,bt=1,e)return e()}finally{bt=n,Ic.transition=r,0===(6&(_c=t))&&qa()}}function hl(){Nc=xc.current,Sa(xc)}function dl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,aa(r)),null!==Oc)for(r=Oc.return;null!==r;){var n=r;switch(ti(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&xa();break;case 3:Qi(),Sa(Ra),Sa(_a),ro();break;case 5:Ji(n);break;case 4:Qi();break;case 13:case 19:Sa(Zi);break;case 10:Ii(n.type._context);break;case 22:case 23:hl()}r=r.return}if(Rc=e,Oc=e=xl(e.current,null),Pc=Nc=t,Mc=0,Lc=null,Uc=Fc=Dc=0,Hc=Bc=null,null!==Pi){for(t=0;t<Pi.length;t++)if(null!==(n=(r=Pi[t]).interleaved)){r.interleaved=null;var a=n.next,i=r.pending;if(null!==i){var o=i.next;i.next=a,n.next=o}r.pending=n}Pi=null}return e}function fl(e,t){for(;;){var r=Oc;try{if(Ai(),no.current=Jo,lo){for(var n=oo.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}lo=!1}if(io=0,co=so=oo=null,uo=!1,ho=0,Ac.current=null,null===r||null===r.return){Mc=1,Lc=t,Oc=null;break}e:{var o=e,s=r.return,c=r,l=t;if(t=Pc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,h=c,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,vs(p,s,c,0,t),1&p.mode&&gs(o,u,t),l=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(0===(1&t)){gs(o,u,t),gl();break e}l=Error(i(426))}else if(ai&&1&c.mode){var v=ms(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,c,0,t),pi(ls(l,c));break e}}o=l=ls(l,c),4!==Mc&&(Mc=2),null===Bc?Bc=[o]:Bc.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,zi(o,fs(0,l,t));break e;case 1:c=l;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===jc||!jc.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,zi(o,ps(o,c,t));break e}}o=o.return}while(null!==o)}wl(r)}catch(w){t=w,Oc===r&&null!==r&&(Oc=r=r.return);continue}break}}function pl(){var e=Sc.current;return Sc.current=Jo,null===e?Jo:e}function gl(){0!==Mc&&3!==Mc&&2!==Mc||(Mc=4),null===Rc||0===(268435455&Dc)&&0===(268435455&Fc)||sl(Rc,Pc)}function ml(e,t){var r=_c;_c|=2;var n=pl();for(Rc===e&&Pc===t||($c=null,dl(e,t));;)try{vl();break}catch(a){fl(e,a)}if(Ai(),_c=r,Sc.current=n,null!==Oc)throw Error(i(261));return Rc=null,Pc=0,Mc}function vl(){for(;null!==Oc;)bl(Oc)}function yl(){for(;null!==Oc&&!Ye();)bl(Oc)}function bl(e){var t=kc(e.alternate,e,Nc);e.memoizedProps=e.pendingProps,null===t?wl(e):Oc=t,Ac.current=null}function wl(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Vs(r,t,Nc)))return void(Oc=r)}else{if(null!==(r=Gs(r,t)))return r.flags&=32767,void(Oc=r);if(null===e)return Mc=6,void(Oc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Oc=t);Oc=t=e}while(null!==t);0===Mc&&(Mc=5)}function Tl(e,t,r){var n=bt,a=Ic.transition;try{Ic.transition=null,bt=1,function(e,t,r,n){do{Cl()}while(null!==Gc);if(0!==(6&_c))throw Error(i(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ot(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}(e,o),e===Rc&&(Oc=Rc=null,Pc=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Vc||(Vc=!0,Rl(tt,(function(){return Cl(),null}))),o=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||o){o=Ic.transition,Ic.transition=null;var s=bt;bt=1;var c=_c;_c|=4,Ac.current=null,function(e,t){if(ea=Kt,fn(e=dn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch(T){r=null;break e}var s=0,c=-1,l=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==r||0!==a&&3!==d.nodeType||(c=s+a),d!==o||0!==n&&3!==d.nodeType||(l=s+n),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===r&&++u===a&&(c=s),f===o&&++h===n&&(l=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}r=-1===c||-1===l?null:{start:c,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ta={focusedElem:e,selectionRange:r},Kt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:rs(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(T){El(t,t.return,T)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}g=tc,tc=!1}(e,r),mc(r,e),pn(ta),Kt=!!ea,ta=ea=null,e.current=r,yc(r,e,a),Qe(),_c=c,bt=s,Ic.transition=o}else e.current=r;if(Vc&&(Vc=!1,Gc=e,Yc=a),o=e.pendingLanes,0===o&&(jc=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),nl(e,Xe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Kc)throw Kc=!1,e=Wc,Wc=null,e;0!==(1&Yc)&&0!==e.tag&&Cl(),o=e.pendingLanes,0!==(1&o)?e===Xc?Qc++:(Qc=0,Xc=e):Qc=0,qa()}(e,t,r,n)}finally{Ic.transition=a,bt=n}return null}function Cl(){if(null!==Gc){var e=wt(Yc),t=Ic.transition,r=bt;try{if(Ic.transition=null,bt=16>e?16:e,null===Gc)var n=!1;else{if(e=Gc,Gc=null,Yc=0,0!==(6&_c))throw Error(i(331));var a=_c;for(_c|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var c=o.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Js=u;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:rc(8,h,o)}var d=h.child;if(null!==d)d.return=h,Js=d;else for(;null!==Js;){var f=(h=Js).sibling,p=h.return;if(ic(h),h===u){Js=null;break}if(null!==f){f.return=p,Js=f;break}Js=p}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:rc(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Js=y;break e}Js=o.return}}var b=e.current;for(Js=b;null!==Js;){var w=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Js=w;else e:for(s=b;null!==Js;){if(0!==(2048&(c=Js).flags))try{switch(c.tag){case 0:case 11:case 15:nc(9,c)}}catch(C){El(c,c.return,C)}if(c===s){Js=null;break e}var T=c.sibling;if(null!==T){T.return=c.return,Js=T;break e}Js=c.return}}if(_c=a,qa(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(C){}n=!0}return n}finally{bt=r,Ic.transition=t}}return!1}function kl(e,t,r){e=Bi(e,t=fs(0,t=ls(r,t),1),1),t=el(),null!==e&&(vt(e,1,t),nl(e,t))}function El(e,t,r){if(3===e.tag)kl(e,e,r);else for(;null!==t;){if(3===t.tag){kl(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===jc||!jc.has(n))){t=Bi(t,e=ps(t,e=ls(r,e),1),1),e=el(),null!==t&&(vt(t,1,e),nl(t,e));break}}t=t.return}}function Sl(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&r,Rc===e&&(Pc&r)===r&&(4===Mc||3===Mc&&(130023424&Pc)===Pc&&500>Xe()-zc?dl(e,0):Uc|=r),nl(e,t)}function Al(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var r=el();null!==(e=Mi(e,t))&&(vt(e,t,r),nl(e,r))}function Il(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Al(e,r)}function _l(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(i(314))}null!==n&&n.delete(t),Al(e,r)}function Rl(e,t){return Ve(e,t)}function Ol(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pl(e,t,r,n){return new Ol(e,t,r,n)}function Nl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function xl(e,t){var r=e.alternate;return null===r?((r=Pl(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ml(e,t,r,n,a,o){var s=2;if(n=e,"function"===typeof e)Nl(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return Ll(r.children,a,o,t);case E:s=8,a|=8;break;case S:return(e=Pl(12,r,t,2|a)).elementType=S,e.lanes=o,e;case R:return(e=Pl(13,r,t,a)).elementType=R,e.lanes=o,e;case O:return(e=Pl(19,r,t,a)).elementType=O,e.lanes=o,e;case x:return Dl(r,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:s=10;break e;case I:s=9;break e;case _:s=11;break e;case P:s=14;break e;case N:s=16,n=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Pl(s,r,t,a)).elementType=e,t.type=n,t.lanes=o,t}function Ll(e,t,r,n){return(e=Pl(7,e,n,t)).lanes=r,e}function Dl(e,t,r,n){return(e=Pl(22,e,n,t)).elementType=x,e.lanes=r,e.stateNode={isHidden:!1},e}function Fl(e,t,r){return(e=Pl(6,e,null,t)).lanes=r,e}function Ul(e,t,r){return(t=Pl(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bl(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Hl(e,t,r,n,a,i,o,s,c){return e=new Bl(e,t,r,s,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Pl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Di(i),e}function zl(e){if(!e)return Ia;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Na(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var r=e.type;if(Na(r))return La(e,r,t)}return t}function ql(e,t,r,n,a,i,o,s,c){return(e=Hl(r,n,!0,e,0,i,0,s,c)).context=zl(null),r=e.current,(i=Ui(n=el(),a=tl(r))).callback=void 0!==t&&null!==t?t:null,Bi(r,i,a),e.current.lanes=a,vt(e,a,n),nl(e,n),e}function $l(e,t,r,n){var a=t.current,i=el(),o=tl(a);return r=zl(r),null===t.context?t.context=r:t.pendingContext=r,(t=Ui(i,o)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Bi(a,t,o))&&(rl(e,a,o,i),Hi(e,a,o)),o}function Kl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function jl(e,t){Wl(e,t),(e=e.alternate)&&Wl(e,t)}kc=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ra.current)bs=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return bs=!1,function(e,t,r){switch(t.tag){case 3:Rs(t),fi();break;case 5:Xi(t);break;case 1:Na(t.type)&&Da(t);break;case 4:Yi(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Aa(Ci,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Aa(Zi,1&Zi.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Fs(e,t,r):(Aa(Zi,1&Zi.current),null!==(e=Ks(e,t,r))?e.sibling:null);Aa(Zi,1&Zi.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return qs(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Aa(Zi,Zi.current),n)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,r)}return Ks(e,t,r)}(e,t,r);bs=0!==(131072&e.flags)}else bs=!1,ai&&0!==(1048576&t.flags)&&Za(t,ja,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;$s(e,t),e=t.pendingProps;var a=Pa(t,_a.current);Ri(t,r),a=mo(null,t,n,e,a,r);var o=vo();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Na(n)?(o=!0,Da(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Di(t),a.updater=as,t.stateNode=a,a._reactInternals=t,cs(t,n,e,r),t=_s(null,t,n,!0,o,r)):(t.tag=0,ai&&o&&ei(t),ws(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch($s(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"===typeof e)return Nl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===_)return 11;if(e===P)return 14}return 2}(n),e=rs(n,e),a){case 0:t=As(null,t,n,e,r);break e;case 1:t=Is(null,t,n,e,r);break e;case 11:t=Ts(null,t,n,e,r);break e;case 14:t=Cs(null,t,n,rs(n.type,e),r);break e}throw Error(i(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,As(e,t,n,a=t.elementType===n?a:rs(n,a),r);case 1:return n=t.type,a=t.pendingProps,Is(e,t,n,a=t.elementType===n?a:rs(n,a),r);case 3:e:{if(Rs(t),null===e)throw Error(i(387));n=t.pendingProps,a=(o=t.memoizedState).element,Fi(e,t),qi(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated){if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Os(e,t,n,r,a=ls(Error(i(423)),t));break e}if(n!==a){t=Os(e,t,n,r,a=ls(Error(i(424)),t));break e}for(ni=la(t.stateNode.containerInfo.firstChild),ri=t,ai=!0,ii=null,r=Ti(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(fi(),n===a){t=Ks(e,t,r);break e}ws(e,t,n,r)}t=t.child}return t;case 5:return Xi(t),null===e&&li(t),n=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,ra(n,a)?s=null:null!==o&&ra(n,o)&&(t.flags|=32),Ss(e,t),ws(e,t,s,r),t.child;case 6:return null===e&&li(t),null;case 13:return Fs(e,t,r);case 4:return Yi(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=wi(t,null,n,r):ws(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,Ts(e,t,n,a=t.elementType===n?a:rs(n,a),r);case 7:return ws(e,t,t.pendingProps,r),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Aa(Ci,n._currentValue),n._currentValue=s,null!==o)if(sn(o.value,s)){if(o.children===a.children&&!Ra.current){t=Ks(e,t,r);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var c=o.dependencies;if(null!==c){s=o.child;for(var l=c.firstContext;null!==l;){if(l.context===n){if(1===o.tag){(l=Ui(-1,r&-r)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),_i(o.return,r,t),c.lanes|=r;break}l=l.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),_i(s,r,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ri(t,r),n=n(a=Oi(a)),t.flags|=1,ws(e,t,n,r),t.child;case 14:return a=rs(n=t.type,t.pendingProps),Cs(e,t,n,a=rs(n.type,a),r);case 15:return ks(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:rs(n,a),$s(e,t),t.tag=1,Na(n)?(e=!0,Da(t)):e=!1,Ri(t,r),os(t,n,a),cs(t,n,a,r),_s(null,t,n,!0,e,r);case 19:return qs(e,t,r);case 22:return Es(e,t,r)}throw Error(i(156,t.tag))};var Vl="function"===typeof reportError?reportError:function(e){console.error(e)};function Gl(e){this._internalRoot=e}function Yl(e){this._internalRoot=e}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jl(){}function Zl(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Kl(o);s.call(e)}}$l(t,o,e,a)}else o=function(e,t,r,n,a){if(a){if("function"===typeof n){var i=n;n=function(){var e=Kl(o);i.call(e)}}var o=ql(t,n,e,0,null,!1,0,"",Jl);return e._reactRootContainer=o,e[pa]=o.current,qn(8===e.nodeType?e.parentNode:e),ul(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof n){var s=n;n=function(){var e=Kl(c);s.call(e)}}var c=Hl(e,0,!1,null,0,!1,0,"",Jl);return e._reactRootContainer=c,e[pa]=c.current,qn(8===e.nodeType?e.parentNode:e),ul((function(){$l(t,c,r,n)})),c}(r,t,e,a,n);return Kl(o)}Yl.prototype.render=Gl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));$l(e,t,null,null)},Yl.prototype.unmount=Gl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ul((function(){$l(null,e,null,null)})),t[pa]=null}},Yl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var r=0;r<xt.length&&0!==t&&t<xt[r].priority;r++);xt.splice(r,0,e),0===r&&Ft(e)}},Tt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(yt(t,1|r),nl(t,Xe()),0===(6&_c)&&(qc=Xe()+500,qa()))}break;case 13:ul((function(){var t=Mi(e,1);if(null!==t){var r=el();rl(t,e,1,r)}})),jl(e,1)}},Ct=function(e){if(13===e.tag){var t=Mi(e,134217728);if(null!==t)rl(t,e,134217728,el());jl(e,134217728)}},kt=function(e){if(13===e.tag){var t=tl(e),r=Mi(e,t);if(null!==r)rl(r,e,t,el());jl(e,t)}},Et=function(){return bt},St=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},Ce=function(e,t,r){switch(t){case"input":if(J(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Ta(n);if(!a)throw Error(i(90));V(n),J(n,a)}}}break;case"textarea":ie(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},_e=ll,Re=ul;var eu={usingClientEntryPoint:!1,Events:[ba,wa,Ta,Ae,Ie,ll]},tu={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{at=nu.inject(ru),it=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ql(t))throw Error(i(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:C,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Ql(e))throw Error(i(299));var r=!1,n="",a=Vl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Hl(e,1,!1,null,0,r,0,n,a),e[pa]=t.current,qn(8===e.nodeType?e.parentNode:e),new Gl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return ul(e)},t.hydrate=function(e,t,r){if(!Xl(t))throw Error(i(200));return Zl(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Ql(e))throw Error(i(405));var n=null!=r&&r.hydratedSources||null,a=!1,o="",s=Vl;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(o=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=ql(t,null,e,1,null!=r?r:null,a,0,o,s),e[pa]=t.current,qn(e),n)for(e=0;e<n.length;e++)a=(a=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Yl(t)},t.render=function(e,t,r){if(!Xl(t))throw Error(i(200));return Zl(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Xl(e))throw Error(i(40));return!!e._reactRootContainer&&(ul((function(){Zl(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Xl(r))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zl(e,t,r,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,r)=>{var n=r(950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(730)},153:(e,t,r)=>{var n=r(43),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,i={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:a,type:e,key:l,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},202:(e,t)=>{var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||p}function y(){}function b(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,g(w,v.prototype),w.isPureReactComponent=!0;var T=Array.isArray,C=Object.prototype.hasOwnProperty,k={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)C.call(t,a)&&!E.hasOwnProperty(a)&&(i[a]=t[a]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===i[a]&&(i[a]=c[a]);return{$$typeof:r,type:e,key:o,ref:s,props:i,_owner:k.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var I=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return o=o(c=e),e=""===i?"."+_(c,0):i,T(o)?(a="",null!=e&&(a=e.replace(I,"$&/")+"/"),R(o,t,a,"",(function(e){return e}))):null!=o&&(A(o)&&(o=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(I,"$&/")+"/")+e)),t.push(o)),1;if(c=0,i=""===i?".":i+":",T(e))for(var l=0;l<e.length;l++){var u=i+_(s=e[l],l);c+=R(s,t,a,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(s=e.next()).done;)c+=R(s=s.value,t,a,u=i+_(s,l++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function O(e,t,r){if(null==e)return e;var n=[],a=0;return R(e,n,"","",(function(e){return t.call(r,e,a++)})),n}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},x={transition:null},M={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:x,ReactCurrentOwner:k};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,r){O(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=L,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=g({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=k.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)C.call(t,l)&&!E.hasOwnProperty(l)&&(a[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:r,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=x.transition;x.transition={};try{e()}finally{x.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,r){return N.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,r){return N.current.useReducer(e,t,r)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return N.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return N.current.useTransition()},t.version="18.3.1"},43:(e,t,r)=>{e.exports=r(202)},579:(e,t,r)=>{e.exports=r(153)},234:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(!(0<i(a,t)))break e;e[n]=t,e[r]=a,r=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,o=a>>>1;n<o;){var s=2*(n+1)-1,c=e[s],l=s+1,u=e[l];if(0>i(c,r))l<a&&0>i(u,c)?(e[n]=u,e[l]=r,n=l):(e[n]=c,e[s]=r,n=s);else{if(!(l<a&&0>i(u,r)))break e;e[n]=u,e[l]=r,n=l}}}return t}function i(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,r(l,t)}t=n(u)}}function T(e){if(m=!1,w(e),!g)if(null!==n(l))g=!0,x(C);else{var t=n(u);null!==t&&M(T,t.startTime-e)}}function C(e,r){g=!1,m&&(m=!1,y(A),A=-1),p=!0;var i=f;try{for(w(r),d=n(l);null!==d&&(!(d.expirationTime>r)||e&&!R());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?d.callback=s:d===n(l)&&a(l),w(r)}else a(l);d=n(l)}if(null!==d)var c=!0;else{var h=n(u);null!==h&&M(T,h.startTime-r),c=!1}return c}finally{d=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,E=!1,S=null,A=-1,I=5,_=-1;function R(){return!(t.unstable_now()-_<I)}function O(){if(null!==S){var e=t.unstable_now();_=e;var r=!0;try{r=S(!0,e)}finally{r?k():(E=!1,S=null)}}else E=!1}if("function"===typeof b)k=function(){b(O)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,N=P.port2;P.port1.onmessage=O,k=function(){N.postMessage(null)}}else k=function(){v(O,0)};function x(e){S=e,E||(E=!0,k())}function M(e,r){A=v((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,x(C))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,r(u,e),null===n(l)&&e===n(u)&&(m?(y(A),A=-1):m=!0,M(T,i-o))):(e.sortIndex=s,r(l,e),g||p||(g=!0,x(C))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},853:(e,t,r)=>{e.exports=r(234)}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"===typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"===typeof n.then)return n}var i=Object.create(null);r.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,r.d(i,o),i}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>"static/js/"+e+".8ab44547.chunk.js",r.miniCssF=e=>{},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="frontend:";r.l=(n,a,i,o)=>{if(e[n])e[n].push(a);else{var s,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var h=l[u];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+i){s=h;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[a];var d=(t,r)=>{s.onerror=s.onload=null,clearTimeout(f);var a=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((e=>e(r))),t)return t(r)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/",(()=>{var e={792:0};r.f.j=(t,n)=>{var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise(((r,n)=>a=e[t]=[r,n]));n.push(a[2]=i);var o=r.p+r.u(t),s=new Error;r.l(o,(n=>{if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var a,i,o=n[0],s=n[1],c=n[2],l=0;if(o.some((t=>0!==e[t]))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(c)c(r)}for(t&&t(n);l<o.length;l++)i=o[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkfrontend=self.webpackChunkfrontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n,a=r(43),i=r.t(a,2),o=r(391),s=r(950),c=r.t(s,2);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const u="popstate";function h(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function d(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,r,n){return void 0===r&&(r=null),l({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?m(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function m(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function v(e,t,r,a){void 0===a&&(a={});let{window:i=document.defaultView,v5Compat:o=!1}=a,s=i.history,c=n.Pop,d=null,m=v();function v(){return(s.state||{idx:null}).idx}function y(){c=n.Pop;let e=v(),t=null==e?null:e-m;m=e,d&&d({action:c,location:w.location,delta:t})}function b(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,r="string"===typeof e?e:g(e);return r=r.replace(/ $/,"%20"),h(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==m&&(m=0,s.replaceState(l({},s.state,{idx:m}),""));let w={get action(){return c},get location(){return e(i,s)},listen(e){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(u,y),d=e,()=>{i.removeEventListener(u,y),d=null}},createHref:e=>t(i,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){c=n.Push;let a=p(w.location,e,t);r&&r(a,e),m=v()+1;let l=f(a,m),u=w.createHref(a);try{s.pushState(l,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;i.location.assign(u)}o&&d&&d({action:c,location:w.location,delta:1})},replace:function(e,t){c=n.Replace;let a=p(w.location,e,t);r&&r(a,e),m=v();let i=f(a,m),l=w.createHref(a);s.replaceState(i,"",l),o&&d&&d({action:c,location:w.location,delta:0})},go:e=>s.go(e)};return w}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,r){return void 0===r&&(r="/"),w(e,t,r,!1)}function w(e,t,r,n){let a=M(("string"===typeof t?m(t):t).pathname||"/",r);if(null==a)return null;let i=T(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let o=null;for(let s=0;null==o&&s<i.length;++s){let e=x(a);o=P(i[s],e,n)}return o}function T(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");let a=(e,a,i)=>{let o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(h(o.relativePath.startsWith(n),'Absolute route path "'+o.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(n.length));let s=B([n,o.relativePath]),c=r.concat(o);e.children&&e.children.length>0&&(h(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),T(e.children,t,c,s)),(null!=e.path||e.index)&&t.push({path:s,score:O(s,e.index),routesMeta:c})};return e.forEach(((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let n of C(e.path))a(e,t,n);else a(e,t)})),t}function C(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(0===n.length)return a?[i,""]:[i];let o=C(n.join("/")),s=[];return s.push(...o.map((e=>""===e?i:[i,e].join("/")))),a&&s.push(...o),s.map((t=>e.startsWith("/")&&""===t?"/":t))}const k=/^:[\w-]+$/,E=3,S=2,A=1,I=10,_=-2,R=e=>"*"===e;function O(e,t){let r=e.split("/"),n=r.length;return r.some(R)&&(n+=_),t&&(n+=S),r.filter((e=>!R(e))).reduce(((e,t)=>e+(k.test(t)?E:""===t?A:I)),n)}function P(e,t,r){void 0===r&&(r=!1);let{routesMeta:n}=e,a={},i="/",o=[];for(let s=0;s<n.length;++s){let e=n[s],c=s===n.length-1,l="/"===i?t:t.slice(i.length)||"/",u=N({path:e.relativePath,caseSensitive:e.caseSensitive,end:c},l),h=e.route;if(!u&&c&&r&&!n[n.length-1].route.index&&(u=N({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},l)),!u)return null;Object.assign(a,u.params),o.push({params:a,pathname:B([i,u.pathname]),pathnameBase:H(B([i,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(i=B([i,u.pathnameBase]))}return o}function N(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);d("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,n]}(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:n.reduce(((e,t,r)=>{let{paramName:n,isOptional:a}=t;if("*"===n){let e=s[r]||"";o=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const c=s[r];return e[n]=a&&!c?void 0:(c||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:o,pattern:e}}function x(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return d(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function M(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function L(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function F(e,t){let r=D(e);return t?r.map(((e,t)=>t===r.length-1?e.pathname:e.pathnameBase)):r.map((e=>e.pathnameBase))}function U(e,t,r,n){let a;void 0===n&&(n=!1),"string"===typeof e?a=m(e):(a=l({},e),h(!a.pathname||!a.pathname.includes("?"),L("?","pathname","search",a)),h(!a.pathname||!a.pathname.includes("#"),L("#","pathname","hash",a)),h(!a.search||!a.search.includes("#"),L("#","search","hash",a)));let i,o=""===e||""===a.pathname,s=o?"/":a.pathname;if(null==s)i=r;else{let e=t.length-1;if(!n&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let c=function(e,t){void 0===t&&(t="/");let{pathname:r,search:n="",hash:a=""}="string"===typeof e?m(e):e,i=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:i,search:z(n),hash:q(a)}}(a,i),u=s&&"/"!==s&&s.endsWith("/"),d=(o||"."===s)&&r.endsWith("/");return c.pathname.endsWith("/")||!u&&!d||(c.pathname+="/"),c}const B=e=>e.join("/").replace(/\/\/+/g,"/"),H=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),z=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function K(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const W=["post","put","patch","delete"],j=(new Set(W),["get",...W]);new Set(j),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function V(){return V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V.apply(this,arguments)}const G=a.createContext(null);const Y=a.createContext(null);const Q=a.createContext(null);const X=a.createContext(null);const J=a.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=a.createContext(null);function ee(){return null!=a.useContext(X)}function te(){return ee()||h(!1),a.useContext(X).location}function re(e){a.useContext(Q).static||a.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=a.useContext(J);return e?function(){let{router:e}=de(ue.UseNavigateStable),t=pe(he.UseNavigateStable),r=a.useRef(!1);return re((()=>{r.current=!0})),a.useCallback((function(n,a){void 0===a&&(a={}),r.current&&("number"===typeof n?e.navigate(n):e.navigate(n,V({fromRouteId:t},a)))}),[e,t])}():function(){ee()||h(!1);let e=a.useContext(G),{basename:t,future:r,navigator:n}=a.useContext(Q),{matches:i}=a.useContext(J),{pathname:o}=te(),s=JSON.stringify(F(i,r.v7_relativeSplatPath)),c=a.useRef(!1);return re((()=>{c.current=!0})),a.useCallback((function(r,a){if(void 0===a&&(a={}),!c.current)return;if("number"===typeof r)return void n.go(r);let i=U(r,JSON.parse(s),o,"path"===a.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:B([t,i.pathname])),(a.replace?n.replace:n.push)(i,a.state,a)}),[t,n,s,o,e])}()}function ae(e,t,r,i){ee()||h(!1);let{navigator:o}=a.useContext(Q),{matches:s}=a.useContext(J),c=s[s.length-1],l=c?c.params:{},u=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let d,f=te();if(t){var p;let e="string"===typeof t?m(t):t;"/"===u||(null==(p=e.pathname)?void 0:p.startsWith(u))||h(!1),d=e}else d=f;let g=d.pathname||"/",v=g;if("/"!==u){let e=u.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=b(e,{pathname:v});let w=le(y&&y.map((e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:B([u,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:B([u,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),s,r,i);return t&&w?a.createElement(X.Provider,{value:{location:V({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:n.Pop}},w):w}function ie(){let e=function(){var e;let t=a.useContext(Z),r=fe(he.UseRouteError),n=pe(he.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[n]}(),t=K(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),r?a.createElement("pre",{style:i},r):null,null)}const oe=a.createElement(ie,null);class se extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(J.Provider,{value:this.props.routeContext},a.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:r,children:n}=e,i=a.useContext(G);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),a.createElement(J.Provider,{value:t},n)}function le(e,t,r,n){var i;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===n&&(n=null),null==e){var o;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(o=n)&&o.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let s=e,c=null==(i=r)?void 0:i.errors;if(null!=c){let e=s.findIndex((e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id])));e>=0||h(!1),s=s.slice(0,Math.min(s.length,e+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let a=0;a<s.length;a++){let e=s[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=a),e.route.id){let{loaderData:t,errors:n}=r,a=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||a){l=!0,s=u>=0?s.slice(0,u+1):[s[0]];break}}}return s.reduceRight(((e,n,i)=>{let o,h=!1,d=null,f=null;var p;r&&(o=c&&n.route.id?c[n.route.id]:void 0,d=n.route.errorElement||oe,l&&(u<0&&0===i?(p="route-fallback",!1||ge[p]||(ge[p]=!0),h=!0,f=null):u===i&&(h=!0,f=n.route.hydrateFallbackElement||null)));let g=t.concat(s.slice(0,i+1)),m=()=>{let t;return t=o?d:h?f:n.route.Component?a.createElement(n.route.Component,null):n.route.element?n.route.element:e,a.createElement(ce,{match:n,routeContext:{outlet:e,matches:g,isDataRoute:null!=r},children:t})};return r&&(n.route.ErrorBoundary||n.route.errorElement||0===i)?a.createElement(se,{location:r.location,revalidation:r.revalidation,component:d,error:o,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()}),null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),he=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(he||{});function de(e){let t=a.useContext(G);return t||h(!1),t}function fe(e){let t=a.useContext(Y);return t||h(!1),t}function pe(e){let t=function(){let e=a.useContext(J);return e||h(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||h(!1),r.route.id}const ge={};i.startTransition;function me(e){let{to:t,replace:r,state:n,relative:i}=e;ee()||h(!1);let{future:o,static:s}=a.useContext(Q),{matches:c}=a.useContext(J),{pathname:l}=te(),u=ne(),d=U(t,F(c,o.v7_relativeSplatPath),l,"path"===i),f=JSON.stringify(d);return a.useEffect((()=>u(JSON.parse(f),{replace:r,state:n,relative:i})),[u,f,i,r,n]),null}function ve(e){h(!1)}function ye(e){let{basename:t="/",children:r=null,location:i,navigationType:o=n.Pop,navigator:s,static:c=!1,future:l}=e;ee()&&h(!1);let u=t.replace(/^\/*/,"/"),d=a.useMemo((()=>({basename:u,navigator:s,static:c,future:V({v7_relativeSplatPath:!1},l)})),[u,l,s,c]);"string"===typeof i&&(i=m(i));let{pathname:f="/",search:p="",hash:g="",state:v=null,key:y="default"}=i,b=a.useMemo((()=>{let e=M(f,u);return null==e?null:{location:{pathname:e,search:p,hash:g,state:v,key:y},navigationType:o}}),[u,f,p,g,v,y,o]);return null==b?null:a.createElement(Q.Provider,{value:d},a.createElement(X.Provider,{children:r,value:b}))}function be(e){let{children:t,location:r}=e;return ae(we(t),r)}new Promise((()=>{}));a.Component;function we(e,t){void 0===t&&(t=[]);let r=[];return a.Children.forEach(e,((e,n)=>{if(!a.isValidElement(e))return;let i=[...t,n];if(e.type===a.Fragment)return void r.push.apply(r,we(e.props.children,i));e.type!==ve&&h(!1),e.props.index&&e.props.children&&h(!1);let o={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=we(e.props.children,i)),r.push(o)})),r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(Ww){}new Map;const Te=i.startTransition;c.flushSync,i.useId;function Ce(e){let{basename:t,children:r,future:n,window:i}=e,o=a.useRef();var s;null==o.current&&(o.current=(void 0===(s={window:i,v5Compat:!0})&&(s={}),v((function(e,t){let{pathname:r,search:n,hash:a}=e.location;return p("",{pathname:r,search:n,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:g(t)}),null,s)));let c=o.current,[l,u]=a.useState({action:c.action,location:c.location}),{v7_startTransition:h}=n||{},d=a.useCallback((e=>{h&&Te?Te((()=>u(e))):u(e)}),[u,h]);return a.useLayoutEffect((()=>c.listen(d)),[c,d]),a.createElement(ye,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:c,future:n})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var ke,Ee;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ke||(ke={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ee||(Ee={}));const Se={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Ae=400,Ie=499,_e=500,Re=599,Oe=[Se.OPENID_SCOPE,Se.PROFILE_SCOPE,Se.OFFLINE_ACCESS_SCOPE],Pe=[...Oe,Se.EMAIL_SCOPE],Ne="Content-Type",xe="Retry-After",Me="X-AnchorMailbox",Le="x-ms-request-id",De="x-ms-httpver",Fe="idtoken",Ue="client.info",Be="adal.idtoken",He="error",ze="error.description",qe="active-account",$e="active-account-filters",Ke="common",We="organizations",je="consumers",Ve="access_token",Ge="xms_cc",Ye={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Qe={PLAIN:"plain",S256:"S256"},Xe={QUERY:"query",FRAGMENT:"fragment"},Je={...Xe,FORM_POST:"form_post"},Ze="authorization_code",et="refresh_token",tt="MSSTS",rt="ADFS",nt="Generic",at="-",it=".",ot={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},st="appmetadata",ct="1",lt="authority-metadata",ut=86400,ht="config",dt="cache",ft="network",pt="hardcoded_values",gt={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},mt={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},vt=60,yt=3600,bt="throttling",wt="retry-after, h429",Tt="invalid_grant",Ct="client_mismatch",kt="username",Et="password",St=200,At=400,It="1",_t="3",Rt="4",Ot="2",Pt="4",Nt="5",xt="0",Mt="1",Lt="2",Dt="3",Ft="4",Ut="pop";var Bt;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(Bt||(Bt={}));class Ht{constructor(e,t,r){this.level=Bt.Info;const n=e||Ht.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"===typeof n.logLevel?n.logLevel:Bt.Info,this.correlationId=n.correlationId||Se.EMPTY_STRING,this.packageName=t||Se.EMPTY_STRING,this.packageVersion=r||Se.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Bt.Info}}clone(e,t,r){return new Ht({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`${`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Bt[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:Bt.Error,containsPii:!1,correlationId:t||Se.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Bt.Error,containsPii:!0,correlationId:t||Se.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Bt.Warning,containsPii:!1,correlationId:t||Se.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Bt.Warning,containsPii:!0,correlationId:t||Se.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Bt.Info,containsPii:!1,correlationId:t||Se.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Bt.Info,containsPii:!0,correlationId:t||Se.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Bt.Verbose,containsPii:!1,correlationId:t||Se.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Bt.Verbose,containsPii:!0,correlationId:t||Se.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Bt.Trace,containsPii:!1,correlationId:t||Se.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Bt.Trace,containsPii:!0,correlationId:t||Se.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const zt="AAD",qt="OIDC",$t="none",Kt="unexpected_error",Wt="post_request_failed",jt={[Kt]:"Unexpected error in authentication.",[Wt]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Vt extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,Vt.prototype),this.errorCode=e||Se.EMPTY_STRING,this.errorMessage=t||Se.EMPTY_STRING,this.subError=r||Se.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function Gt(e,t){return new Vt(e,t?`${jt[e]} ${t}`:jt[e])}const Yt="client_info_decoding_error",Qt="client_info_empty_error",Xt="token_parsing_error",Jt="null_or_empty_token",Zt="endpoints_resolution_error",er="network_error",tr="openid_config_error",rr="hash_not_deserialized",nr="invalid_state",ar="state_mismatch",ir="state_not_found",or="nonce_mismatch",sr="auth_time_not_found",cr="max_age_transpired",lr="multiple_matching_tokens",ur="multiple_matching_accounts",hr="multiple_matching_appMetadata",dr="request_cannot_be_made",fr="cannot_remove_empty_scope",pr="cannot_append_scopeset",gr="empty_input_scopeset",mr="device_code_polling_cancelled",vr="device_code_expired",yr="device_code_unknown_error",br="no_account_in_silent_request",wr="invalid_cache_record",Tr="invalid_cache_environment",Cr="no_account_found",kr="no_crypto_object",Er="unexpected_credential_type",Sr="invalid_assertion",Ar="invalid_client_credential",Ir="token_refresh_required",_r="user_timeout_reached",Rr="token_claims_cnf_required_for_signedjwt",Or="authorization_code_missing_from_server_response",Pr="binding_key_not_removed",Nr="end_session_endpoint_not_supported",xr="key_id_missing",Mr="no_network_connectivity",Lr="user_canceled",Dr="missing_tenant_id_error",Fr="method_not_implemented",Ur="nested_app_auth_bridge_disabled",Br={[Yt]:"The client info could not be parsed/decoded correctly",[Qt]:"The client info was empty",[Xt]:"Token cannot be parsed",[Jt]:"The token is null or empty",[Zt]:"Endpoints cannot be resolved",[er]:"Network request failed",[tr]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[rr]:"The hash parameters could not be deserialized",[nr]:"State was not the expected format",[ar]:"State mismatch error",[ir]:"State not found",[or]:"Nonce mismatch error",[sr]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[cr]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[lr]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[ur]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[hr]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[dr]:"Token request cannot be made without authorization code or refresh token.",[fr]:"Cannot remove null or empty scope from ScopeSet",[pr]:"Cannot append ScopeSet",[gr]:"Empty input ScopeSet cannot be processed",[mr]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[vr]:"Device code is expired.",[yr]:"Device code stopped polling for unknown reasons.",[br]:"Please pass an account object, silent flow is not supported without account information",[wr]:"Cache record object was null or undefined.",[Tr]:"Invalid environment when attempting to create cache entry",[Cr]:"No account found in cache for given key.",[kr]:"No crypto object detected.",[Er]:"Unexpected credential type.",[Sr]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Ar]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Ir]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[_r]:"User defined timeout for device code polling reached",[Rr]:"Cannot generate a POP jwt if the token_claims are not populated",[Or]:"Server response does not contain an authorization code to proceed",[Pr]:"Could not remove the credential's binding key from storage.",[Nr]:"The provided authority does not support logout",[xr]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Mr]:"No network connectivity. Check your internet connection.",[Lr]:"User cancelled the flow.",[Dr]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Fr]:"This method has not been implemented",[Ur]:"The nested app auth bridge is disabled"};class Hr extends Vt{constructor(e,t){super(e,t?`${Br[e]}: ${t}`:Br[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Hr.prototype)}}function zr(e,t){return new Hr(e,t)}const qr={createNewGuid:()=>{throw zr(Fr)},base64Decode:()=>{throw zr(Fr)},base64Encode:()=>{throw zr(Fr)},base64UrlEncode:()=>{throw zr(Fr)},encodeKid:()=>{throw zr(Fr)},async getPublicKeyThumbprint(){throw zr(Fr)},async removeTokenBindingKey(){throw zr(Fr)},async clearKeystore(){throw zr(Fr)},async signJwt(){throw zr(Fr)},async hashString(){throw zr(Fr)}},$r="@azure/msal-common",Kr="14.15.0";function Wr(e,t){const r=function(e){if(!e)throw zr(Jt);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw zr(Xt);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(n){throw zr(Xt)}}function jr(e,t){if(0===t||Date.now()-3e5>e+t)throw zr(cr)}function Vr(){return Math.round((new Date).getTime()/1e3)}function Gr(e,t){const r=Number(e)||0;return Vr()+t>r}function Yr(e){return[nn(e),an(e),on(e),sn(e),cn(e)].join(at).toLowerCase()}function Qr(e,t,r,n,a){return{credentialType:ot.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:a}}function Xr(e,t,r,n,a,i,o,s,c,l,u,h,d,f,p){const g={homeAccountId:e,credentialType:ot.ACCESS_TOKEN,secret:r,cachedAt:Vr().toString(),expiresOn:o.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:a,target:i,tokenType:u||mt.BEARER};if(h&&(g.userAssertionHash=h),l&&(g.refreshOn=l.toString()),f&&(g.requestedClaims=f,g.requestedClaimsHash=p),g.tokenType?.toLowerCase()!==mt.BEARER.toLowerCase())switch(g.credentialType=ot.ACCESS_TOKEN_WITH_AUTH_SCHEME,g.tokenType){case mt.POP:const e=Wr(r,c);if(!e?.cnf?.kid)throw zr(Rr);g.keyId=e.cnf.kid;break;case mt.SSH:g.keyId=d}return g}function Jr(e,t,r,n,a,i,o){const s={credentialType:ot.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return i&&(s.userAssertionHash=i),a&&(s.familyId=a),o&&(s.expiresOn=o.toString()),s}function Zr(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function en(e){return!!e&&(Zr(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===ot.ACCESS_TOKEN||e.credentialType===ot.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function tn(e){return!!e&&(Zr(e)&&e.hasOwnProperty("realm")&&e.credentialType===ot.ID_TOKEN)}function rn(e){return!!e&&(Zr(e)&&e.credentialType===ot.REFRESH_TOKEN)}function nn(e){return[e.homeAccountId,e.environment].join(at).toLowerCase()}function an(e){const t=e.credentialType===ot.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(at).toLowerCase()}function on(e){return(e.target||"").toLowerCase()}function sn(e){return(e.requestedClaimsHash||"").toLowerCase()}function cn(e){return e.tokenType&&e.tokenType.toLowerCase()!==mt.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function ln(){return Vr()+ut}function un(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function hn(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function dn(e){return e.expiresAt<=Vr()}const fn="redirect_uri_empty",pn="claims_request_parsing_error",gn="authority_uri_insecure",mn="url_parse_error",vn="empty_url_error",yn="empty_input_scopes_error",bn="invalid_prompt_value",wn="invalid_claims",Tn="token_request_empty",Cn="logout_request_empty",kn="invalid_code_challenge_method",En="pkce_params_missing",Sn="invalid_cloud_discovery_metadata",An="invalid_authority_metadata",In="untrusted_authority",_n="missing_ssh_jwk",Rn="missing_ssh_kid",On="missing_nonce_authentication_header",Pn="invalid_authentication_header",Nn="cannot_set_OIDCOptions",xn="cannot_allow_native_broker",Mn="authority_mismatch",Ln={[fn]:"A redirect URI is required for all calls, and none has been set.",[pn]:"Could not parse the given claims request object.",[gn]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[mn]:"URL could not be parsed into appropriate segments.",[vn]:"URL was empty or null.",[yn]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[bn]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[wn]:"Given claims parameter must be a stringified JSON object.",[Tn]:"Token request was empty and not found in cache.",[Cn]:"The logout request was null or undefined.",[kn]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[En]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Sn]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[An]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[In]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[_n]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Rn]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[On]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Pn]:"Invalid authentication header provided",[Nn]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[xn]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[Mn]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Dn extends Vt{constructor(e){super(e,Ln[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Dn.prototype)}}function Fn(e){return new Dn(e)}class Un{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(Ww){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach((e=>{if(e.trim()){const[r,a]=e.split(/=(.+)/g,2);r&&a&&(t[n(r)]=n(a))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(Ww){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Bn{constructor(e){const t=e?Un.trimArrayEntries([...e]):[],r=t?Un.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||Se.EMPTY_STRING).split(" ");return new Bn(t)}static createSearchScopes(e){const t=new Bn(e);return t.containsOnlyOIDCScopes()?t.removeScope(Se.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw Fn(yn)}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new Bn(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e))))}containsOnlyOIDCScopes(){let e=0;return Pe.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(Ww){throw zr(pr)}}removeScope(e){if(!e)throw zr(fr);this.scopes.delete(e.trim())}removeOIDCScopes(){Pe.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw zr(gr);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw zr(gr);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return Se.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function Hn(e,t){if(!e)throw zr(Qt);try{const r=t(e);return JSON.parse(r)}catch(Ww){throw zr(Yt)}}function zn(e){if(!e)throw zr(Yt);const t=e.split(it,2);return{uid:t[0],utid:t.length<2?Se.EMPTY_STRING:t[1]}}function qn(e,t){return!!e&&!!t&&e===t.split(".")[1]}function $n(e,t,r,n){if(n){const{oid:t,sub:r,tid:a,name:i,tfp:o,acr:s}=n,c=a||o||s||"";return{tenantId:c,localAccountId:t||r||"",name:i,isHomeTenant:qn(c,e)}}return{tenantId:r,localAccountId:t,isHomeTenant:qn(r,e)}}function Kn(e,t,r,n){let a=e;if(t){const{isHomeTenant:r,...n}=t;a={...e,...n}}if(r){const{isHomeTenant:t,...i}=$n(e.homeAccountId,e.localAccountId,e.tenantId,r);return a={...a,...i,idTokenClaims:r,idToken:n},a}return a}const Wn=0,jn=1,Vn=2,Gn=3;function Yn(e){if(e){return e.tid||e.tfp||e.acr||null}return null}class Qn{generateAccountId(){return[this.homeAccountId,this.environment].join(at).toLowerCase()}generateAccountKey(){return Qn.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((e=>[e.tenantId,e])))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(at).toLowerCase()}static createAccount(e,t,r){const n=new Qn;let a;t.authorityType===jn?n.authorityType=rt:t.protocolMode===zt?n.authorityType=tt:n.authorityType=nt,e.clientInfo&&r&&(a=Hn(e.clientInfo,r)),n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const i=e.environment||t&&t.getPreferredCache();if(!i)throw zr(Tr);n.environment=i,n.realm=a?.utid||Yn(e.idTokenClaims)||"",n.localAccountId=a?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const o=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(n.username=o||s||"",n.name=e.idTokenClaims?.name||"",n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,e.tenantProfiles)n.tenantProfiles=e.tenantProfiles;else{const t=$n(e.homeAccountId,n.localAccountId,n.realm,e.idTokenClaims);n.tenantProfiles=[t]}return n}static createFromAccountInfo(e,t,r){const n=new Qn;return n.authorityType=e.authorityType||nt,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,a){if(t!==jn&&t!==Vn){if(e)try{const t=Hn(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(Ww){}r.warning("No client info in response")}return a?.sub||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},a=t.idTokenClaims||{};n=r.iat===a.iat&&r.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function Xn(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function Jn(e){if(!e||e.indexOf("=")<0)return null;try{const t=Xn(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.error||r.error_description||r.state)return r}catch(Ww){throw zr(rr)}return null}class Zn{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Fn(vn);e.includes("#")||(this._urlString=Zn.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Un.endsWith(t,"?")?t=t.slice(0,-1):Un.endsWith(t,"?/")&&(t=t.slice(0,-2)),Un.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(Ww){throw Fn(mn)}if(!e.HostNameAndPort||!e.PathSegments)throw Fn(mn);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Fn(gn)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Zn.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==Ke&&r[0]!==We||(r[0]=e),Zn.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Fn(mn);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let n=r.AbsolutePath.split("/");return n=n.filter((e=>e&&e.length>0)),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Fn(mn);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===Se.FORWARD_SLASH){const r=new Zn(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Zn(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Jn(e)}}const ea={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},ta={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},ra=new Set;function na(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){const a=aa(t,e);if(a)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),a.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function aa(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}ta.metadata.forEach((e=>{e.aliases.forEach((e=>{ra.add(e)}))}));const ia="cache_quota_exceeded",oa="cache_error_unknown",sa={[ia]:"Exceeded cache storage capacity.",[oa]:"Unexpected error occurred when using cache storage."};class ca extends Error{constructor(e,t){const r=t||(sa[e]?sa[e]:sa[oa]);super(`${e}: ${r}`),Object.setPrototypeOf(this,ca.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}class la{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone($r,Kr),this.staticAuthorityOptions=n}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);if(t.length>1){return t.sort((e=>e.idTokenClaims?-1:1))[0]}return 1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap((e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t)))}getTenantedAccountInfoByFilter(e,t,r,n){let a,i=null;if(n&&!this.tenantProfileMatchesFilter(r,n))return null;const o=this.getIdToken(e,t,r.tenantId);return o&&(a=Wr(o.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,n))?null:(i=Kn(e,r,a,o?.secret),i)}getTenantProfilesFromAccountEntity(e,t,r){const n=e.getAccountInfo();let a=n.tenantProfiles||new Map;const i=this.getTokenKeys();if(t){const e=a.get(t);if(!e)return[];a=new Map([[t,e]])}const o=[];return a.forEach((e=>{const t=this.getTenantedAccountInfoByFilter(n,i,e,r);t&&o.push(t)})),o}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,r){if(!e)throw zr(wr);try{e.account&&this.setAccount(e.account),e.idToken&&!1!==t?.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&!1!==t?.accessToken&&await this.saveAccessToken(e.accessToken),e.refreshToken&&!1!==t?.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(Ww){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),Ww instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${Ww.message}`,r),"QuotaExceededError"===Ww.name||"NS_ERROR_DOM_QUOTA_REACHED"===Ww.name||Ww.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",r),new ca(ia)):new ca(Ww.name,Ww.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${Ww}`,r),new ca(oa))}}async saveAccessToken(e){const t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=Bn.fromString(e.target),a=[];r.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,t,!1))return;const r=this.getAccessTokenCredential(e);if(r&&this.credentialMatchesFilter(r,t)){Bn.fromString(r.target).intersectingScopeSets(n)&&a.push(this.removeAccessToken(e))}})),await Promise.all(a),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId))return;const n=this.getAccount(t,this.commonLogger);if(!n)return;if(e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId))return;if(e.username&&!this.matchUsername(n.username,e.username))return;if(e.environment&&!this.matchEnvironment(n,e.environment))return;if(e.realm&&!this.matchRealm(n,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(n,e.authorityType))return;const a={localAccountId:e?.localAccountId,name:e?.name},i=n.tenantProfiles?.filter((e=>this.tenantProfileMatchesFilter(e,a)));i&&0===i.length||r.push(n)})),r}isAccountKey(e,t,r){return!(e.split(at).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(r&&!e.toLowerCase().includes(r.toLowerCase())))}isCredentialKey(e){if(e.split(at).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(ot.ID_TOKEN.toLowerCase())&&-1===t.indexOf(ot.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(ot.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(ot.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(ot.REFRESH_TOKEN.toLowerCase())>-1){const e=`${ot.REFRESH_TOKEN}${at}${this.clientId}${at}`,r=`${ot.REFRESH_TOKEN}${at}${ct}${at}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===ot.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===mt.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach((t=>{if(!this.isAppMetadata(t))return;const n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))})),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)})),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach((e=>{0===e.indexOf(r)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)})),await Promise.all(n)}updateOutdatedCachedAccount(e,t,r){if(t&&t.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const n=this.getAccountKeys().filter((e=>e.startsWith(t.homeAccountId))),a=[];n.forEach((e=>{const t=this.getCachedAccountEntity(e);t&&a.push(t)}));const i=a.find((e=>qn(e.realm,e.homeAccountId)))||a[0];i.tenantProfiles=a.map((e=>({tenantId:e.realm,localAccountId:e.localAccountId,name:e.name,isHomeTenant:qn(e.realm,e.homeAccountId)})));const o=la.toObject(new Qn,{...i}),s=o.generateAccountKey();return n.forEach((t=>{t!==s&&this.removeOutdatedAccount(e)})),this.setAccount(o),r?.verbose("Updated an outdated account entity in the cache"),o}return t}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===ot.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===mt.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(r){throw zr(Pr)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readAccountFromCache(e){const t=Qn.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,n,a){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ot.ID_TOKEN,clientId:this.clientId,realm:r},o=this.getIdTokensByFilter(i,t),s=o.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let t=o;if(!r){const r=new Map;o.forEach(((t,n)=>{t.realm===e.tenantId&&r.set(n,t)}));const n=r.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),o.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),r.values().next().value;t=r}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach(((e,t)=>{this.removeIdToken(t)})),n&&a&&n.addFields({multiMatchedID:o.size},a),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),o.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,n=new Map;return r.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.set(t,r)})),n}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,n,a,i){this.commonLogger.trace("CacheManager - getAccessToken called");const o=Bn.createSearchScopes(t.scopes),s=t.authenticationScheme||mt.BEARER,c=s&&s.toLowerCase()!==mt.BEARER.toLowerCase()?ot.ACCESS_TOKEN_WITH_AUTH_SCHEME:ot.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:n||e.tenantId,target:o,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=r&&r.accessToken||this.getTokenKeys().accessToken,h=[];u.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,l)&&h.push(t)}}));const d=h.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),h.forEach((e=>{this.removeAccessToken(Yr(e))})),a&&i&&a.addFields({multiMatchedAT:h.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),h[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)})),r}getRefreshToken(e,t,r,n,a){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?ct:void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ot.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];s.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,o)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,o)&&c.push(t)}}));const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&n&&a&&n.addFields({multiMatchedRT:l},a),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((e=>r[e])),a=n.length;if(a<1)return null;if(a>1)throw zr(hr);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==ct)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!==typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=function(e,t){let r;const n=e.canonicalAuthority;if(n){const a=new Zn(n).getUrlComponents().HostNameAndPort;r=na(a,e.cloudDiscoveryMetadata?.metadata,ht,t)||na(a,ta.metadata,pt,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==ot.ACCESS_TOKEN&&e.credentialType!==ot.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return Bn.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(st)}isAuthorityMetadata(e){return-1!==e.indexOf(lt)}generateAuthorityMetadataCacheKey(e){return`${lt}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class ua extends la{setAccount(){throw zr(Fr)}getAccount(){throw zr(Fr)}getCachedAccountEntity(){throw zr(Fr)}setIdTokenCredential(){throw zr(Fr)}getIdTokenCredential(){throw zr(Fr)}setAccessTokenCredential(){throw zr(Fr)}getAccessTokenCredential(){throw zr(Fr)}setRefreshTokenCredential(){throw zr(Fr)}getRefreshTokenCredential(){throw zr(Fr)}setAppMetadata(){throw zr(Fr)}getAppMetadata(){throw zr(Fr)}setServerTelemetry(){throw zr(Fr)}getServerTelemetry(){throw zr(Fr)}setAuthorityMetadata(){throw zr(Fr)}getAuthorityMetadata(){throw zr(Fr)}getAuthorityMetadataKeys(){throw zr(Fr)}setThrottlingCache(){throw zr(Fr)}getThrottlingCache(){throw zr(Fr)}removeItem(){throw zr(Fr)}getKeys(){throw zr(Fr)}getAccountKeys(){throw zr(Fr)}getTokenKeys(){throw zr(Fr)}async clear(){throw zr(Fr)}updateCredentialCacheKey(){throw zr(Fr)}removeOutdatedAccount(){throw zr(Fr)}}const ha={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},da={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Bt.Info,correlationId:Se.EMPTY_STRING},fa={claimsBasedCachingEnabled:!1},pa={async sendGetRequestAsync(){throw zr(Fr)},async sendPostRequestAsync(){throw zr(Fr)}},ga={sku:Se.SKU,version:Kr,cpu:Se.EMPTY_STRING,os:Se.EMPTY_STRING},ma={clientSecret:Se.EMPTY_STRING,clientAssertion:void 0},va={azureCloudInstance:$t,tenant:`${Se.DEFAULT_COMMON_TENANT}`},ya={application:{appName:"",appVersion:""}};function ba(e){return e.authOptions.authority.options.protocolMode===qt}const wa={sendGetRequestAsync:()=>Promise.reject(zr(Fr)),sendPostRequestAsync:()=>Promise.reject(zr(Fr))},Ta="acquireTokenByCode",Ca="acquireTokenByRefreshToken",ka="acquireTokenSilent",Ea="acquireTokenSilentAsync",Sa="acquireTokenPopup",Aa="acquireTokenPreRedirect",Ia="acquireTokenRedirect",_a="cryptoOptsGetPublicKeyThumbprint",Ra="cryptoOptsSignJwt",Oa="silentCacheClientAcquireToken",Pa="silentIframeClientAcquireToken",Na="awaitConcurrentIframe",xa="silentRefreshClientAcquireToken",Ma="ssoSilent",La="standardInteractionClientGetDiscoveredAuthority",Da="fetchAccountIdWithNativeBroker",Fa="nativeInteractionClientAcquireToken",Ua="refreshTokenClientExecutePostToTokenEndpoint",Ba="authorizationCodeClientExecutePostToTokenEndpoint",Ha="refreshTokenClientExecuteTokenRequest",za="refreshTokenClientAcquireToken",qa="refreshTokenClientAcquireTokenWithCachedRefreshToken",$a="refreshTokenClientAcquireTokenByRefreshToken",Ka="refreshTokenClientCreateTokenRequestBody",Wa="acquireTokenFromCache",ja="silentFlowClientAcquireCachedToken",Va="silentFlowClientGenerateResultFromCacheRecord",Ga="acquireTokenBySilentIframe",Ya="initializeBaseRequest",Qa="initializeSilentRequest",Xa="initializeClientApplication",Ja="silentIframeClientTokenHelper",Za="silentHandlerInitiateAuthRequest",ei="silentHandlerMonitorIframeForHash",ti="silentHandlerLoadFrame",ri="silentHandlerLoadFrameSync",ni="standardInteractionClientCreateAuthCodeClient",ai="standardInteractionClientGetClientConfiguration",ii="standardInteractionClientInitializeAuthorizationRequest",oi="standardInteractionClientInitializeAuthorizationCodeRequest",si="getAuthCodeUrl",ci="handleCodeResponseFromServer",li="handleCodeResponse",ui="updateTokenEndpointAuthority",hi="authClientAcquireToken",di="authClientExecuteTokenRequest",fi="authClientCreateTokenRequestBody",pi="authClientCreateQueryString",gi="popTokenGenerateCnf",mi="popTokenGenerateKid",vi="handleServerTokenResponse",yi="deserializeResponse",bi="authorityFactoryCreateDiscoveredInstance",wi="authorityResolveEndpointsAsync",Ti="authorityGetCloudDiscoveryMetadataFromNetwork",Ci="authorityUpdateCloudDiscoveryMetadata",ki="authorityGetEndpointMetadataFromNetwork",Ei="authorityUpdateEndpointMetadata",Si="authorityUpdateMetadataWithRegionalInformation",Ai="regionDiscoveryDetectRegion",Ii="regionDiscoveryGetRegionFromIMDS",_i="regionDiscoveryGetCurrentVersion",Ri="acquireTokenByCodeAsync",Oi="handleRedirectPromise",Pi="handleNativeRedirectPromise",Ni="nativeMessageHandlerHandshake",xi="removeHiddenIframe",Mi="clearTokensAndKeysWithClaims",Li="cacheManagerGetRefreshToken",Di="generatePkceCodes",Fi="generateCodeVerifier",Ui="generateCodeChallengeFromVerifier",Bi="sha256Digest",Hi="getRandomValues",zi=(new Map([[Ta,"ATByCode"],[Ca,"ATByRT"],[ka,"ATS"],[Ea,"ATSAsync"],[Sa,"ATPopup"],[Ia,"ATRedirect"],[_a,"CryptoGetPKThumb"],[Ra,"CryptoSignJwt"],[Oa,"SltCacheClientAT"],[Pa,"SltIframeClientAT"],[xa,"SltRClientAT"],[Ma,"SsoSlt"],[La,"StdIntClientGetDiscAuth"],[Da,"FetchAccIdWithNtvBroker"],[Fa,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Ua,"RTClientExecPost"],[Ba,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[Ha,"RTClientExecTReq"],[za,"RTClientAT"],[qa,"RTClientATWithCachedRT"],[$a,"RTClientATByRT"],[Ka,"RTClientCreateTReqBody"],[Wa,"ATFromCache"],[ja,"SltFlowClientATCached"],[Va,"SltFlowClientGenResFromCache"],[Ga,"ATBySltIframe"],[Ya,"InitBaseReq"],[Qa,"InitSltReq"],[Xa,"InitClientApplication"],[Ja,"SIClientTHelper"],[Za,"SHandlerInitAuthReq"],[ei,"SltHandlerMonitorIframeForHash"],[ti,"SHandlerLoadFrame"],[ri,"SHandlerLoadFrameSync"],[ni,"StdIntClientCreateAuthCodeClient"],[ai,"StdIntClientGetClientConf"],[ii,"StdIntClientInitAuthReq"],[oi,"StdIntClientInitAuthCodeReq"],[si,"GetAuthCodeUrl"],[ci,"HandleCodeResFromServer"],[li,"HandleCodeResp"],[ui,"UpdTEndpointAuth"],[hi,"AuthClientAT"],[di,"AuthClientExecTReq"],[fi,"AuthClientCreateTReqBody"],[pi,"AuthClientCreateQueryStr"],[gi,"PopTGenCnf"],[mi,"PopTGenKid"],[vi,"HandleServerTRes"],[yi,"DeserializeRes"],[bi,"AuthFactCreateDiscInst"],[wi,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[Ti,"AuthGetCDMetaFromNet"],[Ci,"AuthUpdCDMeta"],[ki,"AuthUpdCDMetaFromNet"],[Ei,"AuthUpdEndpointMeta"],[Si,"AuthUpdMetaWithRegInfo"],[Ai,"RegDiscDetectReg"],[Ii,"RegDiscGetRegFromIMDS"],[_i,"RegDiscGetCurrentVer"],[Ri,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[Oi,"HandleRedirectPromise"],[Pi,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[Ni,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[xi,"RemoveHiddenIframe"],[Mi,"ClearTAndKeysWithClaims"],[Li,"CacheManagerGetRT"],[Di,"GenPkceCodes"],[Fi,"GenCodeVerifier"],[Ui,"GenCodeChallengeFromVerifier"],[Bi,"Sha256Digest"],[Hi,"GetRandomValues"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"]);class qi{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class $i{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:zi,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new qi}}startPerformanceMeasurement(){return new qi}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const Ki="invalid_grant",Wi=483,ji=600,Vi="msal",Gi=30,Yi="msal.js.browser",Qi="53ee284d-920a-4b59-9d30-a60315b26836",Xi="ppnbnpeolgkicgegkbkbjmhlideopiji",Ji="MATS",Zi="Handshake",eo="HandshakeResponse",to="GetToken",ro="Response",no="localStorage",ao="sessionStorage",io="memoryStorage",oo="GET",so="POST",co="authority",lo="request.state",uo="nonce.id_token",ho="request.origin",fo="urlHash",po="request.params",go="interaction.status",mo="ccs.credential",vo="request.correlationId",yo="request.native",bo="msal.account.keys",wo="msal.token.keys",To="wrapper.sku",Co="wrapper.version",ko=861,Eo=862,So=863,Ao=865,Io=866,_o=61,Ro=961,Oo=962;var Po;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Po||(Po={}));const No={scopes:Oe},xo="msal.db",Mo=`${xo}.keys`,Lo=0,Do=1,Fo=2,Uo=3,Bo=4,Ho=5,zo=[Lo,Ho,Bo];class qo{navigateInternal(e,t){return qo.defaultNavigateWindow(e,t)}navigateExternal(e,t){return qo.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}const $o="pkce_not_created",Ko="crypto_nonexistent",Wo="empty_navigate_uri",jo="hash_empty_error",Vo="no_state_in_hash",Go="hash_does_not_contain_known_properties",Yo="unable_to_parse_state",Qo="state_interaction_type_mismatch",Xo="interaction_in_progress",Jo="popup_window_error",Zo="empty_window_error",es="user_cancelled",ts="monitor_popup_timeout",rs="monitor_window_timeout",ns="redirect_in_iframe",as="block_iframe_reload",is="block_nested_popups",os="iframe_closed_prematurely",ss="silent_logout_unsupported",cs="no_account_error",ls="silent_prompt_value_error",us="no_token_request_cache_error",hs="unable_to_parse_token_request_cache_error",ds="no_cached_authority_error",fs="auth_request_not_set_error",ps="invalid_cache_type",gs="non_browser_environment",ms="database_not_open",vs="no_network_connectivity",ys="post_request_failed",bs="get_request_failed",ws="failed_to_parse_response",Ts="unable_to_load_token",Cs="crypto_key_not_found",ks="auth_code_required",Es="auth_code_or_nativeAccountId_required",Ss="spa_code_and_nativeAccountId_present",As="database_unavailable",Is="unable_to_acquire_token_from_native_platform",_s="native_handshake_timeout",Rs="native_extension_not_installed",Os="native_connection_not_established",Ps="uninitialized_public_client_application",Ns="native_prompt_not_supported",xs="invalid_base64_string",Ms="invalid_pop_token_request",Ls="For more visit: aka.ms/msaljs/browser-errors",Ds={[$o]:"The PKCE code challenge and verifier could not be generated.",[Ko]:"The crypto object or function is not available.",[Wo]:"Navigation URI is empty. Please check stack trace for more info.",[jo]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Ls}`,[Vo]:"Hash does not contain state. Please verify that the request originated from msal.",[Go]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Ls}`,[Yo]:"Unable to parse state. Please verify that the request originated from msal.",[Qo]:"Hash contains state but the interaction type does not match the caller.",[Xo]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Ls}`,[Jo]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Zo]:"window.open returned null or undefined window object.",[es]:"User cancelled the flow.",[ts]:`Token acquisition in popup failed due to timeout.  ${Ls}`,[rs]:`Token acquisition in iframe failed due to timeout.  ${Ls}`,[ns]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[as]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Ls}`,[is]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[os]:"The iframe being monitored was closed prematurely.",[ss]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[cs]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[ls]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[us]:"No token request found in cache.",[hs]:"The cached token request could not be parsed.",[ds]:"No cached authority found.",[fs]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[ps]:"Invalid cache type",[gs]:"Login and token requests are not supported in non-browser environments.",[ms]:"Database is not open!",[vs]:"No network connectivity. Check your internet connection.",[ys]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[bs]:"Network request failed. Please check the network trace to determine root cause.",[ws]:"Failed to parse network response. Check network trace.",[Ts]:"Error loading token to cache.",[Cs]:"Cryptographic Key or Keypair not found in browser storage.",[ks]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Es]:"An authorization code or nativeAccountId must be provided to this flow.",[Ss]:"Request cannot contain both spa code and native account id.",[As]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Is]:`Unable to acquire token from native platform.  ${Ls}`,[_s]:"Timed out while attempting to establish connection to browser extension",[Rs]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Os]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Ls}`,[Ps]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Ls}`,[Ns]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[xs]:"Invalid base64 encoded string.",[Ms]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true."};class Fs extends Vt{constructor(e){super(e,Ds[e]),Object.setPrototypeOf(this,Fs.prototype),this.name="BrowserAuthError"}}function Us(e){return new Fs(e)}class Bs{async sendGetRequestAsync(e,t){let r;try{r=await fetch(e,{method:oo,headers:this.getFetchHeaders(t)})}catch(Ww){throw window.navigator.onLine?Us(bs):Us(vs)}try{return{headers:this.getHeaderDict(r.headers),body:await r.json(),status:r.status}}catch(Ww){throw Us(ws)}}async sendPostRequestAsync(e,t){const r=t&&t.body||Se.EMPTY_STRING;let n;try{n=await fetch(e,{method:so,headers:this.getFetchHeaders(t),body:r})}catch(Ww){throw window.navigator.onLine?Us(ys):Us(vs)}try{return{headers:this.getHeaderDict(n.headers),body:await n.json(),status:n.status}}catch(Ww){throw Us(ws)}}getFetchHeaders(e){const t=new Headers;if(!e||!e.headers)return t;const r=e.headers;return Object.keys(r).forEach((e=>{t.append(e,r[e])})),t}getHeaderDict(e){const t={};return e.forEach(((e,r)=>{t[r]=e})),t}}const Hs=1e4;const zs="3.26.1";class qs{static loggerCallback(e,t){switch(e){case Bt.Error:return void console.error(t);case Bt.Info:return void console.info(t);case Bt.Verbose:return void console.debug(t);case Bt.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){let t;this.browserEnvironment="undefined"!==typeof window,this.config=function(e,t){let{auth:r,cache:n,system:a,telemetry:i}=e;const o={clientId:Se.EMPTY_STRING,authority:`${Se.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:Se.EMPTY_STRING,authorityMetadata:Se.EMPTY_STRING,redirectUri:Se.EMPTY_STRING,postLogoutRedirectUri:Se.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:zt,OIDCOptions:{serverResponseType:Xe.FRAGMENT,defaultScopes:[Se.OPENID_SCOPE,Se.PROFILE_SCOPE,Se.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:$t,tenant:Se.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},s={cacheLocation:ao,temporaryCacheLocation:ao,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!n||n.cacheLocation!==no),claimsBasedCachingEnabled:!1},c={loggerCallback:()=>{},logLevel:Bt.Info,piiLoggingEnabled:!1},l={...{...ha,loggerOptions:c,networkClient:t?new Bs:wa,navigationClient:new qo,loadFrameTimeout:0,windowHashTimeout:a?.loadFrameTimeout||6e4,iframeHashTimeout:a?.loadFrameTimeout||Hs,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:a?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:Gi},...a,loggerOptions:a?.loggerOptions||c},u={application:{appName:Se.EMPTY_STRING,appVersion:Se.EMPTY_STRING},client:new $i};r?.protocolMode!==qt&&r?.OIDCOptions&&new Ht(l.loggerOptions).warning(JSON.stringify(Fn(Nn)));if(r?.protocolMode&&r.protocolMode!==zt&&l?.allowNativeBroker)throw Fn(xn);return{auth:{...o,...r,OIDCOptions:{...o.OIDCOptions,...r?.OIDCOptions}},cache:{...s,...n},system:l,telemetry:{...u,...i}}}(e,this.browserEnvironment);try{t=window[ao]}catch(Ww){}const r=t?.getItem("msal.browser.log.level"),n=t?.getItem("msal.browser.log.pii")?.toLowerCase(),a="true"===n||"false"!==n&&void 0,i={...this.config.system.loggerOptions},o=r&&Object.keys(Bt).includes(r)?Bt[r]:void 0;o&&(i.loggerCallback=qs.loggerCallback,i.logLevel=o),void 0!==a&&(i.piiLoggingEnabled=a),this.logger=new Ht(i,"@azure/msal-browser",zs),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class $s extends qs{getModuleName(){return $s.MODULE_NAME}getId(){return $s.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}$s.MODULE_NAME="",$s.ID="StandardOperatingContext";const Ks="missing_kid_error",Ws="missing_alg_error",js={[Ks]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Ws]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Vs extends Vt{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Vs.prototype)}}function Gs(e){return new Vs(e,js[e])}class Ys{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Gs(Ks);if(!e.alg)throw Gs(Ws);const t=new Ys({typ:e.typ||Ut,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}function Qs(e){return encodeURIComponent(Js(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Xs(e){return Zs(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Js(e){return Zs((new TextEncoder).encode(e))}function Zs(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}function ec(e){return(new TextDecoder).decode(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Us(xs)}const r=atob(t);return Uint8Array.from(r,(e=>e.codePointAt(0)||0))}(e))}const tc="SHA-256",rc=new Uint8Array([1,0,1]),nc="0123456789abcdef",ac=new Uint32Array(1),ic={name:"RSASSA-PKCS1-v1_5",hash:tc,modulusLength:2048,publicExponent:rc};async function oc(e,t,r){t?.addQueueMeasurement(Bi,r);const n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(tc,n)}function sc(e){return window.crypto.getRandomValues(e)}function cc(){return window.crypto.getRandomValues(ac),ac[0]}function lc(){const e=Date.now(),t=1024*cc()+(1023&cc()),r=new Uint8Array(16),n=Math.trunc(t/2**30),a=t&2**30-1,i=cc();r[0]=e/2**40,r[1]=e/2**32,r[2]=e/2**24,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|a>>>24,r[9]=a>>>16,r[10]=a>>>8,r[11]=a,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let o="";for(let s=0;s<r.length;s++)o+=nc.charAt(r[s]>>>4),o+=nc.charAt(15&r[s]),3!==s&&5!==s&&7!==s&&9!==s||(o+="-");return o}async function uc(e){return window.crypto.subtle.exportKey("jwk",e)}async function hc(e){const t=await oc(e);return Xs(new Uint8Array(t))}class dc{constructor(){this.dbName=xo,this.version=1,this.tableName=Mo,this.dbOpen=!1}async open(){return new Promise(((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),r.addEventListener("success",(t=>{const r=t;this.db=r.target.result,this.dbOpen=!0,e()})),r.addEventListener("error",(()=>t(Us(As))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Us(ms));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new Promise(((r,n)=>{if(!this.db)return n(Us(ms));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",(()=>{this.closeConnection(),r()})),a.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Us(ms));const n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",(()=>{this.closeConnection(),t()})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Promise(((e,t)=>{if(!this.db)return t(Us(ms));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",(t=>{const r=t;this.closeConnection(),e(r.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Us(ms));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(1===r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise(((e,t)=>{const r=window.indexedDB.deleteDatabase(xo),n=setTimeout((()=>t(!1)),200);r.addEventListener("success",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("blocked",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("error",(()=>(clearTimeout(n),t(!1))))}))}}class fc{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,r)=>{e.push(r)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class pc{constructor(e){this.inMemoryCache=new fc,this.indexedDBCache=new dc,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof Fs&&e.errorCode===As))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(Ww){this.handleDatabaseAccessError(Ww)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(Ww){this.handleDatabaseAccessError(Ww)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(Ww){this.handleDatabaseAccessError(Ww)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(Ww){this.handleDatabaseAccessError(Ww)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(Ww){this.handleDatabaseAccessError(Ww)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(Ww){return this.handleDatabaseAccessError(Ww),!1}}}class gc{constructor(e,t){this.logger=e,function(e){if(!("crypto"in window))throw e.error("BrowserCrypto: crypto interface is unavailable"),Us(Ko);e.verbose("BrowserCrypto: modern crypto interface available")}(e),this.cache=new pc(this.logger),this.performanceClient=t}createNewGuid(){return lc()}base64Encode(e){return Js(e)}base64Decode(e){return ec(e)}base64UrlEncode(e){return Qs(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(_a,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(ic,e,t)}(gc.EXTRACTABLE,gc.POP_KEY_USAGES),n=await uc(r.publicKey),a=mc({e:n.e,kty:n.kty,n:n.n}),i=await this.hashString(a),o=await uc(r.privateKey),s=await async function(e,t,r){return window.crypto.subtle.importKey("jwk",e,ic,t,r)}(o,!1,["sign"]);return await this.cache.setItem(i,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){await this.cache.removeItem(e);return!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(Ww){return Ww instanceof Error?this.logger.error(`Clearing keystore failed with error: ${Ww.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){const a=this.performanceClient?.startMeasurement(Ra,n),i=await this.cache.getItem(t);if(!i)throw Us(Cs);const o=await uc(i.publicKey),s=mc(o),c=Qs(JSON.stringify({kid:t})),l=Qs(Ys.getShrHeaderString({...r?.header,alg:o.alg,kid:c}));e.cnf={jwk:JSON.parse(s)};const u=`${l}.${Qs(JSON.stringify(e))}`,h=(new TextEncoder).encode(u),d=await async function(e,t){return window.crypto.subtle.sign(ic,e,t)}(i.privateKey,h),f=`${u}.${Xs(new Uint8Array(d))}`;return a&&a.end({success:!0}),f}async hashString(e){return hc(e)}}function mc(e){return JSON.stringify(e,Object.keys(e).sort())}gc.POP_KEY_USAGES=["sign","verify"],gc.EXTRACTABLE=!0;const vc=(e,t,r,n,a)=>function(){r.trace(`Executing function ${t}`);const i=n?.startMeasurement(t,a);if(a){const e=t+"CallCount";n?.incrementFields({[e]:1},a)}try{const n=e(...arguments);return i?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(Ww){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(Ww))}catch(Ww){r.trace("Unable to print error message.")}throw i?.end({success:!1},Ww),Ww}},yc=(e,t,r,n,a)=>function(){r.trace(`Executing function ${t}`);const i=n?.startMeasurement(t,a);if(a){const e=t+"CallCount";n?.incrementFields({[e]:1},a)}return n?.setPreQueueTime(t,a),e(...arguments).then((e=>(r.trace(`Returning result from ${t}`),i?.end({success:!0}),e))).catch((e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw i?.end({success:!1},e),e}))};class bc{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(Ai,this.correlationId);let r=e;if(r)t.region_source=_t;else{const e=bc.IMDS_OPTIONS;try{const n=await yc(this.getRegionFromIMDS.bind(this),Ii,this.logger,this.performanceClient,this.correlationId)(Se.IMDS_VERSION,e);if(n.status===St&&(r=n.body,t.region_source=Rt),n.status===At){const n=await yc(this.getCurrentVersion.bind(this),_i,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source=It,null;const a=await yc(this.getRegionFromIMDS.bind(this),Ii,this.logger,this.performanceClient,this.correlationId)(n,e);a.status===St&&(r=a.body,t.region_source=Rt)}}catch(Ww){return t.region_source=It,null}}return r||(t.region_source=It),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(Ii,this.correlationId),this.networkInterface.sendGetRequestAsync(`${Se.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,Se.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(_i,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${Se.IMDS_ENDPOINT}?format=json`,e);return t.status===At&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(Ww){return null}}}bc.IMDS_OPTIONS={headers:{Metadata:"true"}};class wc{constructor(e,t,r,n,a,i,o,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=a,this.performanceClient=o,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new bc(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(Se.CIAM_AUTH_URL))return Gn;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case Se.ADFS:return jn;case Se.DSTS:return Vn}return Wn}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Zn(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw zr(Zt)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw zr(Zt)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw zr(Zt)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw zr(Nr);return this.replacePath(this.metadata.end_session_endpoint)}throw zr(Zt)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw zr(Zt)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw zr(Zt)}canReplaceTenant(e){return 1===e.PathSegments.length&&!wc.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Wn&&this.protocolMode===zt}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new Zn(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,a)=>{let i=n[a];if(0===a&&this.canReplaceTenant(r)){const e=new Zn(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===jn||this.protocolMode!==zt&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(wi,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await yc(this.updateCloudDiscoveryMetadata.bind(this),Ci,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await yc(this.updateEndpointMetadata.bind(this),Ei,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:ln(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==dt&&r?.source!==dt&&(e.expiresAt=ln(),e.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(Ei,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===pt&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){un(e,await yc(this.updateMetadataWithRegionalInformation.bind(this),Si,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority}return t.source}let r=await yc(this.getEndpointMetadataFromNetwork.bind(this),ki,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await yc(this.updateMetadataWithRegionalInformation.bind(this),Si,this.logger,this.performanceClient,this.correlationId)(r)),un(e,r,!0),ft;throw zr(tr,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),un(e,t,!1),{source:ht};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return un(e,t,!1),{source:pt,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=dn(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:dt}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Zn(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(Ww){throw Fn(An)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(ki,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const r=await this.networkInterface.sendGetRequestAsync(t,e),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(r.body);return n?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(Ww){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${Ww}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in ea?ea[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(Si,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==Se.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Ot,this.regionDiscoveryMetadata.region_used=t,wc.replaceWithRegionalInformation(e,t);const r=await yc(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Ai,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome=Pt,this.regionDiscoveryMetadata.region_used=r,wc.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome=Nt}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(Ci,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await yc(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Ti,this.logger,this.performanceClient,this.correlationId)();if(r)return hn(e,r,!0),ft;throw Fn(In)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||Se.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||Se.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||Se.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),hn(e,t,!1),ht;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(r=this.hostnameAndPort,aa(ta.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),hn(e,t,!1),pt;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var r;const n=dn(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),dt):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Gn)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),wc.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=aa(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(Ww){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Fn(Sn)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),wc.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Ti,this.correlationId);const e=`${Se.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const n=await this.networkInterface.sendGetRequestAsync(e,t);let a,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body))a=n.body,i=a.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${a.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(n.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${n.status}`),a=n.body,a.error===Se.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${a.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${a.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=aa(i,this.hostnameAndPort)}catch(n){if(n instanceof Vt)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${n.errorCode}\nError Description: ${n.errorMessage}`);else{const e=n;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${e.name}\nError Description: ${e.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=wc.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>e&&Zn.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==$t){const e=t.tenant?t.tenant:Se.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return Se.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw zr(Zt)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return ra.has(e)}static isPublicCloudAuthority(e){return Se.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const n=new Zn(e);n.validateAsUri();const a=n.getUrlComponents();let i=`${t}.${a.HostNameAndPort}`;this.isPublicCloudAuthority(a.HostNameAndPort)&&(i=`${t}.${Se.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const o=Zn.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:i}).urlString;return r?`${o}?${r}`:o}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=wc.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=wc.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=wc.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const r=new Zn(e).getUrlComponents();if(0===r.PathSegments.length&&r.HostNameAndPort.endsWith(Se.CIAM_AUTH_URL)){t=`${t}${r.HostNameAndPort.split(".")[0]}${Se.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}function Tc(e){return e.endsWith(Se.FORWARD_SLASH)?e:`${e}${Se.FORWARD_SLASH}`}wc.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Ke,je,We]);const Cc="no_tokens_found",kc="native_account_unavailable",Ec="refresh_token_expired",Sc="bad_token",Ac=["interaction_required","consent_required","login_required",Sc],Ic=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],_c={[Cc]:"No refresh token found in the cache. Please sign-in.",[kc]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Ec]:"Refresh token has expired.",[Sc]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class Rc extends Vt{constructor(e,t,r,n,a,i,o,s){super(e,t,r),Object.setPrototypeOf(this,Rc.prototype),this.timestamp=n||Se.EMPTY_STRING,this.traceId=a||Se.EMPTY_STRING,this.correlationId=i||Se.EMPTY_STRING,this.claims=o||Se.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=s}}function Oc(e,t,r){const n=!!e&&Ac.indexOf(e)>-1,a=!!r&&Ic.indexOf(r)>-1,i=!!t&&Ac.some((e=>t.indexOf(e)>-1));return n||i||a}function Pc(e){return new Rc(e,_c[e])}class Nc{static setRequestState(e,t,r){const n=Nc.generateLibraryState(e,r);return t?`${n}${Se.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw zr(kr);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw zr(kr);if(!t)throw zr(nr);try{const r=t.split(Se.RESOURCE_DELIM),n=r[0],a=r.length>1?r.slice(1).join(Se.RESOURCE_DELIM):Se.EMPTY_STRING,i=e.base64Decode(n),o=JSON.parse(i);return{userRequestState:a||Se.EMPTY_STRING,libraryState:o}}catch(Ww){throw zr(nr)}}}const xc="home_account_id",Mc="UPN",Lc="storage_not_supported",Dc="stubbed_public_client_application_called",Fc="in_mem_redirect_unavailable",Uc={[Lc]:"Given storage configuration option was not supported.",[Dc]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Fc]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class Bc extends Vt{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Bc.prototype)}}function Hc(e){return new Bc(e,Uc[e])}class zc{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==no&&e!==ao||!window[e])throw Hc(Lc)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,t){this.windowStorage.setItem(e,t)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}}function qc(e,t){if(!t)return null;try{return Nc.parseRequestState(e,t).libraryState.meta}catch(Ww){throw zr(nr)}}class $c extends la{constructor(e,t,r,n,a,i){super(e,r,n,a),this.COOKIE_LIFE_MULTIPLIER=864e5,this.cacheConfig=t,this.logger=n,this.internalStorage=new fc,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=i}setupBrowserStorage(e){switch(e){case no:case ao:try{return new zc(e)}catch(Ww){this.logger.verbose(Ww);break}}return this.cacheConfig.cacheLocation=io,new fc}setupTemporaryCacheStorage(e,t){switch(t){case no:case ao:try{return new zc(e||ao)}catch(Ww){return this.logger.verbose(Ww),this.internalStorage}default:return this.internalStorage}}migrateCacheEntries(){const e=`${Se.CACHE_PREFIX}.${Fe}`,t=`${Se.CACHE_PREFIX}.${Ue}`,r=`${Se.CACHE_PREFIX}.${He}`,n=`${Se.CACHE_PREFIX}.${ze}`,a=[this.browserStorage.getItem(e),this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n)];[Fe,Ue,He,ze].forEach(((e,t)=>{const r=a[t];r&&this.setTemporaryCache(e,r,!0)}))}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(bo),t=this.getItem(`${wo}.${this.clientId}`);if(e&&t)return void this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");this.browserStorage.getKeys().forEach((e=>{if(this.isCredentialKey(e)){const t=this.getItem(e);if(t){const r=this.validateAndParseJson(t);if(r&&r.hasOwnProperty("credentialType"))switch(r.credentialType){case ot.ID_TOKEN:if(tn(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${e} found, saving key to token key map`);const t=r,n=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(n,ot.ID_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${e}`);break;case ot.ACCESS_TOKEN:case ot.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(en(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${e} found, saving key to token key map`);const t=r,n=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(n,ot.ACCESS_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${e}`);break;case ot.REFRESH_TOKEN:if(rn(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${e} found, saving key to token key map`);const t=r,n=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(n,ot.REFRESH_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${e}`)}}}if(this.isAccountKey(e)){const t=this.getItem(e);if(t){const r=this.validateAndParseJson(t);r&&Qn.isAccountEntity(r)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${e} found, saving key to account key map`),this.addAccountKeyToMap(e))}}}))}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,r,t)}getCachedAccountEntity(e){const t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return r&&Qn.isAccountEntity(r)?la.toObject(new Qn,r):(this.removeAccountKeyFromMap(e),null)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(bo);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(bo,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(bo,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,ot.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,ot.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,ot.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${wo}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case ot.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case ot.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case ot.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),zr(Er)}this.setItem(`${wo}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case ot.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case ot.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const a=r.accessToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case ot.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),zr(Er)}this.setItem(`${wo}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,ot.ID_TOKEN),null;const r=this.validateAndParseJson(t);return r&&tn(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,ot.ID_TOKEN),null)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const t=Yr(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,ot.ID_TOKEN)}getAccessTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,ot.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return r&&en(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,ot.ACCESS_TOKEN),null)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const t=Yr(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,ot.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,ot.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return r&&rn(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,ot.REFRESH_TOKEN),null)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const t=Yr(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,ot.REFRESH_TOKEN)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&(n=e,(a=r)&&0===n.indexOf(st)&&a.hasOwnProperty("clientId")&&a.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var n,a}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=function(e){let{environment:t,clientId:r}=e;return[st,t,r].join(at).toLowerCase()}(e);this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){const r=0===e.indexOf(gt.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){return!!t&&0===e.indexOf(lt)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(To,e),this.internalStorage.setItem(Co,t)}getWrapperMetadata(){return[this.internalStorage.getItem(To)||Se.EMPTY_STRING,this.internalStorage.getItem(Co)||Se.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey($e),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const e=this.generateCacheKey(qe),t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const r=this.getAccountInfoFilteredBy({localAccountId:t});return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(r),r):null}const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey($e),r=this.generateCacheKey(qe);if(e){this.logger.verbose("setActiveAccount: Active account set");const n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(n)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){let r=!1;e&&(r=0===e.indexOf(bt));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.getItemCookie(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===no){const e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){const n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach((e=>{-1===e.indexOf(Se.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)})),this.browserStorage.getKeys().forEach((e=>{-1===e.indexOf(Se.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(Mi,t);const r=this.getTokenKeys(),n=[];r.accessToken.forEach((e=>{const t=this.getAccessTokenCredential(e);t?.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&n.push(this.removeAccessToken(e))})),await Promise.all(n),n.length>0&&this.logger.warning(`${n.length} access tokens with claims in the cache keys have been removed from the cache.`)}setItemCookie(e,t,r){let n=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(r){n+=`expires=${this.getCookieExpirationTime(r)};`}this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n}getItemCookie(e){const t=`${encodeURIComponent(e)}=`,r=document.cookie.split(";");for(let n=0;n<r.length;n++){let e=r[n];for(;" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(t))return decodeURIComponent(e.substring(t.length,e.length))}return Se.EMPTY_STRING}clearMsalCookies(){const e=`${Se.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach((t=>{for(;" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(e)){const e=t.split("=")[0];this.clearItemCookie(e)}}))}clearItemCookie(e){this.setItemCookie(e,Se.EMPTY_STRING,-1)}getCookieExpirationTime(e){const t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):Un.startsWith(e,Se.CACHE_PREFIX)||Un.startsWith(e,Be)?e:`${Se.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=Nc.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${co}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=Nc.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${uo}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=Nc.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${lo}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;const n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)}updateCacheEntries(e,t,r,n,a){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);const o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1);const s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),a){const e={credential:a.homeAccountId,type:xc};this.setTemporaryCache(mo,JSON.stringify(e),!0)}else if(n){const e={credential:n,type:Mc};this.setTemporaryCache(mo,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach((t=>{-1!==t.indexOf(e)&&this.removeTemporaryItem(t)})),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(po)),this.removeTemporaryItem(this.generateCacheKey(ho)),this.removeTemporaryItem(this.generateCacheKey(fo)),this.removeTemporaryItem(this.generateCacheKey(vo)),this.removeTemporaryItem(this.generateCacheKey(mo)),this.removeTemporaryItem(this.generateCacheKey(yo)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||Se.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach((t=>{if(-1===t.indexOf(lo))return;const r=this.temporaryCacheStorage.getItem(t);if(!r)return;const n=qc(this.cryptoImpl,r);n&&n.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))})),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=Js(JSON.stringify(e));this.setTemporaryCache(po,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(po,!0);if(!t)throw Us(us);let r;try{r=JSON.parse(ec(t))}catch(Ww){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${Ww}`),Us(hs)}if(this.removeTemporaryItem(this.generateCacheKey(po)),!r.authority){const t=this.generateAuthorityKey(e),n=this.getTemporaryCache(t);if(!n)throw Us(ds);r.authority=n}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(yo,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${Se.CACHE_PREFIX}.${go}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${Se.CACHE_PREFIX}.${go}`;if(e){if(this.getInteractionInProgress())throw Us(Xo);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(Be);e&&(this.browserStorage.removeItem(Be),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(Fe,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(Fe)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const r=t||e;if(r){const e=Wr(r,ec);if(e.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),e.preferred_username;if(e.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),e.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){const r=Yr(t);if(e!==r){const n=this.getItem(e);if(n)return this.browserStorage.removeItem(e),this.setItem(r,n),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),r;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,t){const r=Qr(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let n;t.claims&&(n=await this.cryptoImpl.hashString(t.claims));const a={idToken:r,accessToken:Xr(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,ec,void 0,e.tokenType,void 0,t.sshKid,t.claims,n)};return this.saveCacheRecord(a)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(Ww){if(Ww instanceof ca&&this.performanceClient&&r)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},r)}catch(Ww){}throw Ww}}}function Kc(){return window.parent!==window}function Wc(){return window.location.href.split("?")[0].split("#")[0]}function jc(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf(`${Vi}.`))throw Us(is)}function Vc(){if("undefined"===typeof window)throw Us(gs)}function Gc(e){if(!e)throw Us(Ps)}function Yc(e){Vc(),function(){if(Zn.hashContainsKnownProperties(window.location.hash)&&Kc())throw Us(as)}(),jc(),Gc(e)}function Qc(e,t){if(Yc(e),function(e){if(Kc()&&!e)throw Us(ns)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===io&&!t.cache.storeAuthStateInCookie)throw Hc(Fc)}function Xc(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((()=>{try{document.head.removeChild(t)}catch{}}),1e4)}const Jc="msal:initializeStart",Zc="msal:initializeEnd",el="msal:accountAdded",tl="msal:accountRemoved",rl="msal:activeAccountChanged",nl="msal:loginStart",al="msal:loginSuccess",il="msal:loginFailure",ol="msal:acquireTokenStart",sl="msal:acquireTokenSuccess",cl="msal:acquireTokenFailure",ll="msal:acquireTokenFromNetworkStart",ul="msal:ssoSilentStart",hl="msal:ssoSilentSuccess",dl="msal:ssoSilentFailure",fl="msal:acquireTokenByCodeStart",pl="msal:acquireTokenByCodeSuccess",gl="msal:acquireTokenByCodeFailure",ml="msal:handleRedirectStart",vl="msal:handleRedirectEnd",yl="msal:popupOpened",bl="msal:logoutStart",wl="msal:logoutSuccess",Tl="msal:logoutFailure",Cl="msal:logoutEnd",kl="msal:restoreFromBFCache";class El{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Ht({})}addEventCallback(e,t,r){if("undefined"!==typeof window){const n=r||lc();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){if("undefined"!==typeof window){const a={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.eventCallbacks.forEach(((t,r)=>{let[n,i]=t;(0===i.length||i.includes(e))&&(this.logger.verbose(`Emitting event to callback ${r}: ${e}`),n.apply(null,[a]))}))}}}class Sl extends Vt{constructor(e,t,r,n,a){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=a,Object.setPrototypeOf(this,Sl.prototype)}}class Al{static generateThrottlingStorageKey(e){return`${bt}.${JSON.stringify(e)}`}static preProcess(e,t){const r=Al.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){if(n.throttleTime<Date.now())return void e.removeItem(r);throw new Sl(n.errorCodes?.join(" ")||Se.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,t,r){if(Al.checkResponseStatus(r)||Al.checkResponseForRetryAfter(r)){const n={throttleTime:Al.calculateThrottleTime(parseInt(r.headers[xe])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Al.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(xe)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||vt),r+yt))}static removeThrottle(e,t,r,n){const a={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(a);e.removeItem(i)}}class Il{constructor(e,t){this.networkClient=e,this.cacheManager=t}async sendPostRequest(e,t,r){let n;Al.preProcess(this.cacheManager,e);try{n=await this.networkClient.sendPostRequestAsync(t,r)}catch(Ww){throw Ww instanceof Vt?Ww:zr(er)}return Al.postProcess(this.cacheManager,e,n),n}}const _l="client_id",Rl="response_type",Ol="token_type",Pl="req_cnf",Nl="return_spa_code",xl="x-client-xtra-sku";class Ml{static validateRedirectUri(e){if(!e)throw Fn(fn)}static validatePrompt(e){const t=[];for(const r in Ye)t.push(Ye[r]);if(t.indexOf(e)<0)throw Fn(bn)}static validateClaims(e){try{JSON.parse(e)}catch(Ww){throw Fn(wn)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Fn(En);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Qe.PLAIN,Qe.S256].indexOf(e)<0)throw Fn(kn)}}class Ll{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(Rl,encodeURIComponent(Se.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Rl,encodeURIComponent(`${Se.TOKEN_RESPONSE_TYPE} ${Se.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set("response_mode",encodeURIComponent(e||Je.QUERY))}addNativeBroker(){this.parameters.set("nativebroker",encodeURIComponent("1"))}addScopes(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Oe;!t||r.includes("openid")||e.includes("openid")||r.push("openid");const n=t?[...e||[],...r]:e||[],a=new Bn(n);this.parameters.set("scope",encodeURIComponent(a.printScopes()))}addClientId(e){this.parameters.set(_l,encodeURIComponent(e))}addRedirectUri(e){Ml.validateRedirectUri(e),this.parameters.set("redirect_uri",encodeURIComponent(e))}addPostLogoutRedirectUri(e){Ml.validateRedirectUri(e),this.parameters.set("post_logout_redirect_uri",encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set("id_token_hint",encodeURIComponent(e))}addDomainHint(e){this.parameters.set("domain_hint",encodeURIComponent(e))}addLoginHint(e){this.parameters.set("login_hint",encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(Me,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(Me,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set("sid",encodeURIComponent(e))}addClaims(e,t){const r=this.addClientCapabilitiesToClaims(e,t);Ml.validateClaims(r),this.parameters.set("claims",encodeURIComponent(r))}addCorrelationId(e){this.parameters.set("client-request-id",encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set("x-client-SKU",e.sku),this.parameters.set("x-client-VER",e.version),e.os&&this.parameters.set("x-client-OS",e.os),e.cpu&&this.parameters.set("x-client-CPU",e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set("x-app-name",e.appName),e?.appVersion&&this.parameters.set("x-app-ver",e.appVersion)}addPrompt(e){Ml.validatePrompt(e),this.parameters.set("prompt",encodeURIComponent(e))}addState(e){e&&this.parameters.set("state",encodeURIComponent(e))}addNonce(e){this.parameters.set("nonce",encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Ml.validateCodeChallengeParams(e,t),!e||!t)throw Fn(En);this.parameters.set("code_challenge",encodeURIComponent(e)),this.parameters.set("code_challenge_method",encodeURIComponent(t))}addAuthorizationCode(e){this.parameters.set("code",encodeURIComponent(e))}addDeviceCode(e){this.parameters.set("device_code",encodeURIComponent(e))}addRefreshToken(e){this.parameters.set("refresh_token",encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set("code_verifier",encodeURIComponent(e))}addClientSecret(e){this.parameters.set("client_secret",encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set("client_assertion",encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set("client_assertion_type",encodeURIComponent(e))}addOboAssertion(e){this.parameters.set("assertion",encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set("requested_token_use",encodeURIComponent(e))}addGrantType(e){this.parameters.set("grant_type",encodeURIComponent(e))}addClientInfo(){this.parameters.set("client_info","1")}addExtraQueryParameters(e){Object.entries(e).forEach((e=>{let[t,r]=e;!this.parameters.has(t)&&r&&this.parameters.set(t,r)}))}addClientCapabilitiesToClaims(e,t){let r;if(e)try{r=JSON.parse(e)}catch(Ww){throw Fn(wn)}else r={};return t&&t.length>0&&(r.hasOwnProperty(Ve)||(r[Ve]={}),r[Ve][Ge]={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set(kt,encodeURIComponent(e))}addPassword(e){this.parameters.set(Et,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(Ol,mt.POP),this.parameters.set(Pl,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(Ol,mt.SSH),this.parameters.set(Pl,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set("x-client-current-telemetry",e.generateCurrentRequestHeaderValue()),this.parameters.set("x-client-last-telemetry",e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set("x-ms-lib-capability",wt)}addLogoutHint(e){this.parameters.set("logout_hint",encodeURIComponent(e))}createQueryString(){const e=new Array;return this.parameters.forEach(((t,r)=>{e.push(`${r}=${t}`)})),e.join("&")}}async function Dl(e,t,r,n,a,i,o){o?.addQueueMeasurement(bi,i);const s=wc.transformCIAMAuthority(Tc(e)),c=new wc(s,t,r,n,a,i,o);try{return await yc(c.resolveEndpointsAsync.bind(c),wi,a,o,i)(),c}catch(Ww){throw zr(Zt)}}class Fl{constructor(e,t){this.config=function(e){let{authOptions:t,systemOptions:r,loggerOptions:n,cacheOptions:a,storageInterface:i,networkInterface:o,cryptoInterface:s,clientCredentials:c,libraryInfo:l,telemetry:u,serverTelemetryManager:h,persistencePlugin:d,serializableCache:f}=e;const p={...da,...n};return{authOptions:(g=t,{clientCapabilities:[],azureCloudOptions:va,skipAuthorityMetadataCache:!1,instanceAware:!1,...g}),systemOptions:{...ha,...r},loggerOptions:p,cacheOptions:{...fa,...a},storageInterface:i||new ua(t.clientId,qr,new Ht(p)),networkInterface:o||pa,cryptoInterface:s||qr,clientCredentials:c||ma,libraryInfo:{...ga,...l},telemetry:{...ya,...u},serverTelemetryManager:h||null,persistencePlugin:d||null,serializableCache:f||null};var g}(e),this.logger=new Ht(this.config.loggerOptions,$r,Kr),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Il(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[Ne]=Se.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case xc:try{const r=zn(e.credential);t[Me]=`Oid:${r.uid}@${r.utid}`}catch(Ww){this.logger.verbose("Could not parse home account ID for CCS Header: "+Ww)}break;case Mc:t[Me]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,a,i){i&&this.performanceClient?.addQueueMeasurement(i,a);const o=await this.networkManager.sendPostRequest(n,e,{body:t,headers:r});return this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:o.headers?.[De]||""},a),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(ui,t);const r=`https://${e}/${this.authority.tenant}/`,n=await Dl(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){const t=new Ll;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}}const Ul="sw";class Bl{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(gi,e.correlationId);const r=await yc(this.generateKid.bind(this),gi,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){this.performanceClient?.addQueueMeasurement(mi,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:Ul}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:a,resourceRequestUri:i,shrClaims:o,shrNonce:s,shrOptions:c}=r,l=i?new Zn(i):void 0,u=l?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Vr(),m:a?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:o||void 0,...n},t,c,r.correlationId)}}class Hl{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class zl{constructor(e,t,r,n,a,i,o){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=a,this.persistencePlugin=i,this.performanceClient=o}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?zr(ir,"Cached State"):zr(ir,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(Ww){throw zr(nr,e.state)}try{n=decodeURIComponent(t)}catch(Ww){throw zr(nr,e.state)}if(r!==n)throw zr(ar);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+5):void 0}(e);if(Oc(e.error,e.error_description,e.suberror))throw new Rc(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new Sl(e.error||"",e.error_description,e.suberror,t)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const r=`Error(s): ${e.error_codes||Se.NOT_AVAILABLE} - Timestamp: ${e.timestamp||Se.NOT_AVAILABLE} - Description: ${e.error_description||Se.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||Se.NOT_AVAILABLE} - Trace ID: ${e.trace_id||Se.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,a=new Sl(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=_e&&e.status<=Re)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${a}`);if(t&&e.status&&e.status>=Ae&&e.status<=Ie)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${a}`);if(Oc(e.error,e.error_description,e.suberror))throw new Rc(e.error,e.error_description,e.suberror,e.timestamp||Se.EMPTY_STRING,e.trace_id||Se.EMPTY_STRING,e.correlation_id||Se.EMPTY_STRING,e.claims||Se.EMPTY_STRING,n);throw a}}async handleServerTokenResponse(e,t,r,n,a,i,o,s,c){let l,u;if(this.performanceClient?.addQueueMeasurement(vi,e.correlation_id),e.id_token){if(l=Wr(e.id_token||Se.EMPTY_STRING,this.cryptoObj.base64Decode),a&&a.nonce&&l.nonce!==a.nonce)throw zr(or);if(n.maxAge||0===n.maxAge){const e=l.auth_time;if(!e)throw zr(sr);jr(e,n.maxAge)}}this.homeAccountIdentifier=Qn.generateHomeAccountId(e.client_info||Se.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l),a&&a.state&&(u=Nc.parseRequestState(this.cryptoObj,a.state)),e.key_id=e.key_id||n.sshKid||void 0;const h=this.generateCacheRecord(e,t,r,n,l,i,a);let d;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),d=new Hl(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(d)),o&&!s&&h.account){const e=h.account.generateAccountKey();if(!this.cacheStorage.getAccount(e,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await zl.generateAuthenticationResult(this.cryptoObj,t,h,!1,n,l,u,void 0,c)}await this.cacheStorage.saveCacheRecord(h,n.storeInCache,n.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&d&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(d))}return zl.generateAuthenticationResult(this.cryptoObj,t,h,!1,n,l,u,e,c)}generateCacheRecord(e,t,r,n,a,i,o){const s=t.getPreferredCache();if(!s)throw zr(Tr);const c=Yn(a);let l,u;e.id_token&&a&&(l=Qr(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),u=ql(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,a,e.client_info,s,c,o,void 0,this.logger));let h=null;if(e.access_token){const a=e.scope?Bn.fromString(e.scope):new Bn(n.scopes||[]),o=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,d=r+o,f=d+l,p=u&&u>0?r+u:void 0;h=Xr(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",a.printScopes(),d,f,this.cryptoObj.base64Decode,p,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let d=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=r+("string"===typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}d=Jr(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let f=null;return e.foci&&(f={clientId:this.clientId,environment:s,familyId:e.foci}),{account:u,idToken:l,accessToken:h,refreshToken:d,appMetadata:f}}static async generateAuthenticationResult(e,t,r,n,a,i,o,s,c){let l,u,h=Se.EMPTY_STRING,d=[],f=null,p=Se.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==mt.POP||a.popKid)h=r.accessToken.secret;else{const t=new Bl(e),{secret:n,keyId:i}=r.accessToken;if(!i)throw zr(xr);h=await t.signPopToken(n,i,a)}d=Bn.fromString(r.accessToken.target).asArray(),f=new Date(1e3*Number(r.accessToken.expiresOn)),l=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),r.accessToken.refreshOn&&(u=new Date(1e3*Number(r.accessToken.refreshOn)))}r.appMetadata&&(p=r.appMetadata.familyId===ct?ct:"");const g=i?.oid||i?.sub||"",m=i?.tid||"";s?.spa_accountid&&r.account&&(r.account.nativeAccountId=s?.spa_accountid);const v=r.account?Kn(r.account.getAccountInfo(),void 0,i,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:g,tenantId:m,scopes:d,account:v,idToken:r?.idToken?.secret||"",idTokenClaims:i||{},accessToken:h,fromCache:n,expiresOn:f,extExpiresOn:l,refreshOn:u,correlationId:a.correlationId,requestId:c||Se.EMPTY_STRING,familyId:p,tokenType:r.accessToken?.tokenType||Se.EMPTY_STRING,state:o?o.userRequestState:Se.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||Se.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||Se.EMPTY_STRING,code:s?.spa_code,fromNativeBroker:!1}}}function ql(e,t,r,n,a,i,o,s,c,l,u){u?.verbose("setCachedAccount called");const h=e.getAccountKeys().find((e=>e.startsWith(r)));let d=null;h&&(d=e.getAccount(h,u));const f=d||Qn.createAccount({homeAccountId:r,idTokenClaims:a,clientInfo:i,environment:o,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},t,n),p=f.tenantProfiles||[],g=s||f.realm;if(g&&!p.find((e=>e.tenantId===g))){const e=$n(r,f.localAccountId,g,a);p.push(e)}return f.tenantProfiles=p,f}async function $l(e,t,r){if("string"===typeof e)return e;return e({clientId:t,tokenEndpoint:r})}class Kl extends Fl{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async getAuthCodeUrl(e){this.performanceClient?.addQueueMeasurement(si,e.correlationId);const t=await yc(this.createAuthCodeUrlQueryString.bind(this),pi,this.logger,this.performanceClient,e.correlationId)(e);return Zn.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(hi,e.correlationId),!e.code)throw zr(dr);const r=Vr(),n=await yc(this.executeTokenRequest.bind(this),di,this.logger,this.performanceClient,e.correlationId)(this.authority,e),a=n.headers?.[Le],i=new zl(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(n.body),yc(i.handleServerTokenResponse.bind(i),vi,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,a)}handleFragmentResponse(e,t){if(new zl(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw zr(Or);return e}getLogoutUri(e){if(!e)throw Fn(Cn);const t=this.createLogoutUrlQueryString(e);return Zn.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(di,t.correlationId);const r=this.createTokenQueryParameters(t),n=Zn.appendQueryString(e.tokenEndpoint,r),a=await yc(this.createTokenRequestBody.bind(this),fi,this.logger,this.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const e=Hn(t.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${e.uid}${it}${e.utid}`,type:xc}}catch(Ww){this.logger.verbose("Could not parse client info for CCS Header: "+Ww)}const o=this.createTokenRequestHeaders(i||t.ccsCredential),s={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return yc(this.executePostToTokenEndpoint.bind(this),Ba,this.logger,this.performanceClient,t.correlationId)(n,a,o,s,t.correlationId,Ba)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(fi,e.correlationId);const t=new Ll;if(t.addClientId(e.tokenBodyParameters?.[_l]||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Ml.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!ba(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await $l(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(r.assertionType)}if(t.addGrantType(Ze),t.addClientInfo(),e.authenticationScheme===mt.POP){const r=new Bl(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await yc(r.generateCnf.bind(r),gi,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}t.addPopToken(n)}else if(e.authenticationScheme===mt.SSH){if(!e.sshJwk)throw Fn(_n);t.addSshJwk(e.sshJwk)}const r=e.correlationId||this.config.cryptoInterface.createNewGuid();let n;if(t.addCorrelationId(r),(!Un.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Hn(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${t.uid}${it}${t.utid}`,type:xc}}catch(Ww){this.logger.verbose("Could not parse client info for CCS Header: "+Ww)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case xc:try{const e=zn(n.credential);t.addCcsOid(e)}catch(Ww){this.logger.verbose("Could not parse home account ID for CCS Header: "+Ww)}break;case Mc:t.addCcsUpn(n.credential)}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Nl]||t.addExtraQueryParameters({[Nl]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){this.performanceClient?.addQueueMeasurement(pi,e.correlationId);const t=new Ll;t.addClientId(e.extraQueryParameters?.[_l]||this.config.authOptions.clientId);const r=[...e.scopes||[],...e.extraScopesToConsent||[]];t.addScopes(r,!0,this.oidcDefaultScopes),t.addRedirectUri(e.redirectUri);const n=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),ba(this.config)||t.addApplicationTelemetry(this.config.telemetry.application),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==Ye.SELECT_ACCOUNT)if(e.sid&&e.prompt===Ye.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){const r=this.extractAccountSid(e.account);let n=this.extractLoginHint(e.account);if(n&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),n=null),n){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),t.addLoginHint(n);try{const r=zn(e.account.homeAccountId);t.addCcsOid(r)}catch(Ww){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(r&&e.prompt===Ye.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(r);try{const r=zn(e.account.homeAccountId);t.addCcsOid(r)}catch(Ww){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{const r=zn(e.account.homeAccountId);t.addCcsOid(r)}catch(Ww){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.addExtraQueryParams(e,t),e.nativeBroker&&(t.addNativeBroker(),e.authenticationScheme===mt.POP)){const r=new Bl(this.cryptoUtils);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await yc(r.generateCnf.bind(r),gi,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}t.addPopToken(n)}return t.createQueryString()}createLogoutUrlQueryString(e){const t=new Ll;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}}function Wl(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:a,extensionVersion:i}=e,o=new Map([[0,[r,n]],[2,[a,i]]]);let s=[];if(t?.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},(()=>"|"));return o.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:a}=e;if(r>=t.length)return;t[r]=[n,a].join("|")}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})})),s.join(",")}class jl{constructor(e,t){this.cacheOutcome=xt,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Se.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Se.EMPTY_STRING,this.telemetryCacheKey=gt.CACHE_KEY+at+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${gt.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(gt.VALUE_SEPARATOR),a=[e,this.getRegionDiscoveryFields()].join(gt.VALUE_SEPARATOR);return[gt.SCHEMA_VERSION,a,n].join(gt.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=jl.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(gt.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(gt.VALUE_SEPARATOR),a=e.errors.length,i=[a,t<a?gt.OVERFLOW_TRUE:gt.OVERFLOW_FALSE].join(gt.VALUE_SEPARATOR);return[gt.SCHEMA_VERSION,e.cacheHits,r,n,i].join(gt.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=gt.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Vt?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(gt.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=jl.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t,r=0,n=0;const a=e.errors.length;for(t=0;t<a;t++){const a=e.failedRequests[2*t]||Se.EMPTY_STRING,i=e.failedRequests[2*t+1]||Se.EMPTY_STRING,o=e.errors[t]||Se.EMPTY_STRING;if(n+=a.toString().length+i.toString().length+o.length+3,!(n<gt.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||Se.EMPTY_STRING),e.push(this.regionSource||Se.EMPTY_STRING),e.push(this.regionOutcome||Se.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return Wl(e)}}class Vl{constructor(e,t,r,n,a,i,o,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=a,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||lc(),this.logger=n.clone(Yi,zs,this.correlationId),this.performanceClient=o}async clearCacheOnLogout(e){if(e){Qn.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Qn.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(t){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(Ww){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri||Wc();return Zn.getAbsoluteUrl(t,Wc())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new jl(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(La,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.requestAuthority||this.config.auth.authority,i=r?.length?"true"===r:this.config.auth.instanceAware,o=t&&i?this.config.auth.authority.replace(Zn.getDomainFromUrl(a),t.environment):a,s=wc.generateAuthority(o,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await yc(Dl,bi,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Fn(Mn);return c}}async function Gl(e,t,r){e.addQueueMeasurement(Di,r);const n=vc(Yl,Fi,t,e,r)(e,t,r);return{verifier:n,challenge:await yc(Ql,Ui,t,e,r)(n,e,t,r)}}function Yl(e,t,r){try{const n=new Uint8Array(32);vc(sc,Hi,t,e,r)(n);return Xs(n)}catch(Ww){throw Us($o)}}async function Ql(e,t,r,n){t.addQueueMeasurement(Ui,n);try{const a=await yc(oc,Bi,r,t,n)(e,t,n);return Xs(new Uint8Array(a))}catch(Ww){throw Us($o)}}async function Xl(e,t,r,n){r.addQueueMeasurement(Ya,e.correlationId);const a=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],o={...e,correlationId:e.correlationId,authority:a,scopes:i};if(o.authenticationScheme){if(o.authenticationScheme===mt.SSH){if(!e.sshJwk)throw Fn(_n);if(!e.sshKid)throw Fn(Rn)}n.verbose(`Authentication Scheme set to "${o.authenticationScheme}" as configured in Auth request`)}else o.authenticationScheme=mt.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Un.isEmptyObj(e.claims)&&(o.requestedClaimsHash=await hc(e.claims)),o}async function Jl(e,t,r,n,a){n.addQueueMeasurement(Qa,e.correlationId);const i=await yc(Xl,Ya,a,n,e.correlationId)(e,r,n,a);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}class Zl extends Vl{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(oi,this.correlationId);const t=await yc(Gl,Di,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:Se.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=Se.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||lc(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(e.postLogoutRedirectUri,Wc())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Wc())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(Wc(),Wc())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(ni,this.correlationId);const t=await yc(this.getClientConfiguration.bind(this),ai,this.logger,this.performanceClient,this.correlationId)(e);return new Kl(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:a,account:i}=e;this.performanceClient.addQueueMeasurement(ai,this.correlationId);const o=await yc(this.getDiscoveredAuthority.bind(this),La,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:a,account:i}),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Yi,version:zs,cpu:Se.EMPTY_STRING,os:Se.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(ii,this.correlationId);const r=this.getRedirectUri(e.redirectUri),n={interactionType:t},a=Nc.setRequestState(this.browserCrypto,e&&e.state||Se.EMPTY_STRING,n),i={...await yc(Xl,Ya,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:a,nonce:e.nonce||lc(),responseMode:this.config.auth.OIDCOptions.serverResponseType},o=e.account||this.browserStorage.getActiveAccount();if(o&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${o.homeAccountId}`,this.correlationId),i.account=o),!i.loginHint&&!o){const e=this.browserStorage.getLegacyLoginHint();e&&(i.loginHint=e)}return i}}const eu="user_switch",tu={[eu]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class ru extends Vt{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,ru.prototype),this.name="NativeAuthError",this.ext=r}}function nu(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||(!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode)}function au(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return Pc(kc);case"USER_INTERACTION_REQUIRED":return new Rc(e,t);case"USER_CANCEL":return Us(es);case"NO_NETWORK":return Us(vs)}return new ru(e,tu[e]||t,r)}class iu extends Fl{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(za,e.correlationId);const t=Vr(),r=await yc(this.executeTokenRequest.bind(this),Ha,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[Le],a=new zl(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return a.validateTokenResponse(r.body),yc(a.handleServerTokenResponse.bind(a),vi,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw Fn(Tn);if(this.performanceClient?.addQueueMeasurement($a,e.correlationId),!e.account)throw zr(br);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await yc(this.acquireTokenWithCachedRefreshToken.bind(this),qa,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(Ww){const r=Ww instanceof Rc&&Ww.errorCode===Cc,n=Ww instanceof Sl&&Ww.errorCode===Tt&&Ww.subError===Ct;if(r||n)return yc(this.acquireTokenWithCachedRefreshToken.bind(this),qa,this.logger,this.performanceClient,e.correlationId)(e,!1);throw Ww}return yc(this.acquireTokenWithCachedRefreshToken.bind(this),qa,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(qa,e.correlationId);const r=vc(this.cacheManager.getRefreshToken.bind(this.cacheManager),Li,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw Pc(Cc);if(r.expiresOn&&Gr(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw Pc(Ec);const n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||mt.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:xc}};try{return await yc(this.acquireToken.bind(this),za,this.logger,this.performanceClient,e.correlationId)(n)}catch(Ww){if(Ww instanceof Rc&&Ww.subError===Sc){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const e=Yr(r);this.cacheManager.removeRefreshToken(e)}throw Ww}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Ha,e.correlationId);const r=this.createTokenQueryParameters(e),n=Zn.appendQueryString(t.tokenEndpoint,r),a=await yc(this.createTokenRequestBody.bind(this),Ka,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),o={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return yc(this.executePostToTokenEndpoint.bind(this),Ua,this.logger,this.performanceClient,e.correlationId)(n,a,i,o,e.correlationId,Ua)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Ka,e.correlationId);const t=e.correlationId,r=new Ll;if(r.addClientId(e.tokenBodyParameters?.[_l]||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),r.addGrantType(et),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!ba(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addCorrelationId(t),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await $l(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(t.assertionType)}if(e.authenticationScheme===mt.POP){const t=new Bl(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await yc(t.generateCnf.bind(t),gi,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}r.addPopToken(n)}else if(e.authenticationScheme===mt.SSH){if(!e.sshJwk)throw Fn(_n);r.addSshJwk(e.sshJwk)}if((!Un.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case xc:try{const t=zn(e.ccsCredential.credential);r.addCcsOid(t)}catch(Ww){this.logger.verbose("Could not parse home account ID for CCS Header: "+Ww)}break;case Mc:r.addCcsUpn(e.ccsCredential.credential)}return e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()}}class ou extends Fl{constructor(e,t){super(e,t)}async acquireToken(e){try{const[t,r]=await this.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...Oe]});if(r===Ft){this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");new iu(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch((()=>{}))}return t}catch(Ww){if(Ww instanceof Hr&&Ww.errorCode===Ir){return new iu(this.config,this.performanceClient).acquireTokenByRefreshToken(e)}throw Ww}}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(ja,e.correlationId);let t=xt;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Un.isEmptyObj(e.claims))throw this.setCacheOutcome(Mt,e.correlationId),zr(Ir);if(!e.account)throw zr(br);const r=e.account.tenantId||function(e){const t=new Zn(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case Ke:case We:case je:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),a=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient,e.correlationId);if(!a)throw this.setCacheOutcome(Lt,e.correlationId),zr(Ir);if(i=a.cachedAt,Number(i)>Vr()||Gr(a.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Dt,e.correlationId),zr(Ir);var i;a.refreshOn&&Gr(a.refreshOn,0)&&(t=Ft);const o=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account),accessToken:a,idToken:this.cacheManager.getIdToken(e.account,n,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(o)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await yc(this.generateResultFromCacheRecord.bind(this),Va,this.logger,this.performanceClient,e.correlationId)(s,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==xt&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(Va,t.correlationId),e.idToken&&(r=Wr(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=r?.auth_time;if(!e)throw zr(sr);jr(e,t.maxAge)}return zl.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class su extends Zl{async acquireToken(e){this.performanceClient.addQueueMeasurement(Oa,e.correlationId);const t=this.initializeServerTelemetryManager(_o),r=await yc(this.getClientConfiguration.bind(this),ai,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),n=new ou(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await yc(n.acquireCachedToken.bind(n),ja,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(a){throw a instanceof Fs&&a.errorCode===Cs&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),a}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}const cu="brk_client_id",lu="brk_redirect_uri";class uu extends Vl{constructor(e,t,r,n,a,i,o,s,c,l,u,h){super(e,t,r,n,a,i,s,c,h),this.apiId=o,this.accountId=l,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new su(e,this.nativeStorageManager,r,n,a,i,s,c,h),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const d=this.nativeMessageHandler.getExtensionId()===Xi?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=jl.makeExtraSkuString({libraryName:Yi,libraryVersion:zs,extensionName:d,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[xl]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(Fa,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(Fa,e.correlationId),r=Vr();try{const n=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,n);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(Ww){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=n,i={method:to,request:a},o=await this.nativeMessageHandler.sendMessage(i),s=this.validateNativeResponse(o);return await this.handleNativeResponse(s,n,r).then((e=>(t.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),e))).catch((e=>{throw t.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}catch(Ww){throw Ww instanceof ru&&this.serverTelemetryManager.setNativeBrokerErrorCode(Ww.errorCode),Ww}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Bn.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),zr(Cr);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw zr(Cr);try{const e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),a={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:a}}catch(Ww){throw Ww}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const n=await this.initializeNativeRequest(r),a={method:to,request:n};try{const e=await this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(e)}catch(Ww){if(Ww instanceof ru&&(this.serverTelemetryManager.setNativeBrokerErrorCode(Ww.errorCode),nu(Ww)))throw Ww}this.browserStorage.setTemporaryCache(yo,JSON.stringify(n),!0);const i={apiId:ko,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(o,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:n,...a}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(yo));const i={method:to,request:a},o=Vr();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,a,o);this.browserStorage.setInteractionInProgress(!1);const r=await t;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),r}catch(Ww){throw this.browserStorage.setInteractionInProgress(!1),Ww}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const n=Wr(e.id_token,ec),a=this.createHomeAccountIdentifier(e,n),i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(a!==i&&e.account.id!==t.accountId)throw au(eu);const o=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=ql(this.browserStorage,o,a,ec,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,n,s,o.canonicalAuthority,r);return this.cacheAccount(s),this.cacheNativeTokens(e,t,a,n,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return Qn.generateHomeAccountId(e.client_info||Se.EMPTY_STRING,Wn,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?Bn.fromString(e.scope):Bn.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===mt.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new Bl(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw zr(xr);return r.signPopToken(e.access_token,t.keyId,n)}return e.access_token}async generateAuthenticationResult(e,t,r,n,a,i){const o=this.addTelemetryFromNativeResponse(e),s=e.scope?Bn.fromString(e.scope):Bn.fromString(t.scope),c=e.account.properties||{},l=c.UID||r.oid||r.sub||Se.EMPTY_STRING,u=c.TenantId||r.tid||Se.EMPTY_STRING,h=Kn(n.getAccountInfo(),void 0,r,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const d=await this.generatePopAccessToken(e,t),f=t.tokenType===mt.POP?mt.POP:mt.BEARER;return{authority:a,uniqueId:l,tenantId:u,scopes:s.asArray(),account:h,idToken:e.id_token,idTokenClaims:r,accessToken:d,fromCache:!!o&&this.isResponseFromCache(o),expiresOn:new Date(1e3*Number(i+e.expires_in)),tokenType:f,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)}))}cacheNativeTokens(e,t,r,n,a,i,o){const s=Qr(r,t.authority,e.id_token||"",t.clientId,n.tid||""),c=o+(t.tokenType===mt.POP?Se.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,t),u={idToken:s,accessToken:Xr(r,t.authority,a,t.clientId,n.tid||i,l.printScopes(),c,0,ec,void 0,t.tokenType,void 0,t.keyId)};this.nativeStorageManager.saveCacheRecord(u,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Gt(Kt,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(Ww){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new Zn(t);r.validateAsUri();const{scopes:n,...a}=e,i=new Bn(n||[]);i.appendScopes(Oe);const o={...a,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case So:case _o:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Ye.NONE}if(e.prompt)switch(e.prompt){case Ye.NONE:case Ye.CONSENT:case Ye.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Us(Ns)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(o.signPopToken&&e.popKid)throw Us(Ms);if(this.handleExtraBrokerParams(o),o.extraParameters=o.extraParameters||{},o.extraParameters.telemetry=Ji,e.authenticationScheme===mt.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},r=new Bl(this.browserCrypto);let n;if(o.keyId)n=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:o.keyId})),o.signPopToken=!1;else{const a=await yc(r.generateCnf.bind(r),gi,this.logger,this.performanceClient,e.correlationId)(t,this.logger);n=a.reqCnfString,o.keyId=a.kid,o.signPopToken=!0}o.reqCnf=n}return this.addRequestSKUs(o),o}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(cu)&&e.extraParameters.hasOwnProperty(lu)&&e.extraParameters.hasOwnProperty(_l)){const t=e.extraParameters[_l],r=e.redirectUri,n=e.extraParameters[lu];e.extraParameters={child_client_id:t,child_redirect_uri:r},e.redirectUri=n}}}class hu{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(Ni)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Qi,extensionId:this.extensionId,responseId:lc(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise(((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})}))}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const n=new hu(e,t,r,Xi);return await n.sendHandshakeRequest(),n}catch(Ww){const a=new hu(e,t,r);return await a.sendHandshakeRequest(),a}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Qi,extensionId:this.extensionId,responseId:lc(),body:{method:Zi}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise(((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Us(_s)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===Qi&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Zi){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(Us(Rs))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===ro){if(!r)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(au(e.code,e.description,e.ext));else{if(!e.result)throw Gt(Kt,"Event does not contain result.");e.result.code&&e.result.description?r.reject(au(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===eo){if(!n)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(a){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${a}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(a):n&&n.reject(a)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case mt.BEARER:case mt.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class du{constructor(e,t,r,n,a){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=a}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(li,t.correlationId);try{r=this.authModule.handleFragmentResponse(e,t.state)}catch(Ww){throw Ww instanceof Sl&&Ww.subError===es?Us(es):Ww}return yc(this.handleCodeResponseFromServer.bind(this),ci,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(ci,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await yc(this.authModule.updateAuthority.bind(this.authModule),ui,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await yc(this.authModule.acquireToken.bind(this.authModule),hi,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:xc}:e.loginHint?{credential:e.loginHint,type:Mc}:null}}function fu(e,t,r){const n=Jn(e);if(!n)throw Xn(e)?(r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),Us(Go)):(r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),Us(jo));return n}class pu extends Zl{constructor(e,t,r,n,a,i,o,s,c,l){super(e,t,r,n,a,i,o,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s}acquireToken(e){try{const t={popupName:this.generatePopupName(e.scopes||Oe,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),t.popup=this.openSizedPopup("about:blank",t),this.acquireTokenPopupAsync(e,t))}catch(Ww){return Promise.reject(Ww)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,a=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,a)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,a))}catch(Ww){return Promise.reject(Ww)}}async acquireTokenPopupAsync(e,t){this.logger.verbose("acquireTokenPopupAsync called");const r=this.initializeServerTelemetryManager(Eo),n=await yc(this.initializeAuthorizationRequest.bind(this),ii,this.logger,this.performanceClient,this.correlationId)(e,Po.Popup);Xc(n.authority);try{const a=await yc(this.initializeAuthorizationCodeRequest.bind(this),oi,this.logger,this.performanceClient,this.correlationId)(n),i=await yc(this.createAuthCodeClient.bind(this),ni,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),o=hu.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let s;o&&(s=this.performanceClient.startMeasurement(Da,e.correlationId));const c=await i.getAuthCodeUrl({...n,nativeBroker:o}),l=new du(i,this.browserStorage,a,this.logger,this.performanceClient),u=this.initiateAuthRequest(c,t);this.eventHandler.emitEvent(yl,Po.Popup,{popupWindow:u},null);const h=await this.monitorPopupForHash(u,t.popupWindowParent),d=vc(fu,yi,this.logger,this.performanceClient,this.correlationId)(h,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Al.removeThrottle(this.browserStorage,this.config.auth.clientId,a),d.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),s&&s.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Us(Os);const e=new uu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Eo,this.performanceClient,this.nativeMessageHandler,d.accountId,this.nativeStorage,n.correlationId),{userRequestState:t}=Nc.parseRequestState(this.browserCrypto,n.state);return await e.acquireToken({...n,state:t,prompt:void 0})}return await l.handleCodeResponse(d,n)}catch(Ww){throw t.popup?.close(),Ww instanceof Vt&&(Ww.setCorrelationId(this.correlationId),r.cacheFailedRequest(Ww)),Ww}}async logoutPopupAsync(e,t,r,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(bl,Po.Popup,e);const a=this.initializeServerTelemetryManager(Oo);try{await this.clearCacheOnLogout(e.account);const i=await yc(this.createAuthCodeClient.bind(this),ni,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:a,requestAuthority:r,account:e.account||void 0});try{i.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&i.authority.protocolMode===qt){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(wl,Po.Popup,e),n){const e={apiId:Oo,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Zn.getAbsoluteUrl(n,Wc());await this.navigationClient.navigateInternal(t,e)}return void t.popup?.close()}}const o=i.getLogoutUri(e);this.eventHandler.emitEvent(wl,Po.Popup,e);const s=this.openPopup(o,t);if(this.eventHandler.emitEvent(yl,Po.Popup,{popupWindow:s},null),await this.monitorPopupForHash(s,t.popupWindowParent).catch((()=>{})),n){const e={apiId:Oo,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Zn.getAbsoluteUrl(n,Wc());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(Ww){throw t.popup?.close(),Ww instanceof Vt&&(Ww.setCorrelationId(this.correlationId),a.cacheFailedRequest(Ww)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Tl,Po.Popup,null,Ww),this.eventHandler.emitEvent(Cl,Po.Popup),Ww}this.eventHandler.emitEvent(Cl,Po.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Us(Wo)}monitorPopupForHash(e,t){return new Promise(((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r(Us(es));let a="";try{a=e.location.href}catch(Ww){}if(!a||"about:blank"===a)return;clearInterval(n);let i="";const o=this.config.auth.OIDCOptions.serverResponseType;e&&(i=o===Xe.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)}),this.config.system.pollIntervalMilliseconds)})).finally((()=>{this.cleanPopup(e,t)}))}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw Us(Zo);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(Ww){throw this.logger.error("error opening popup "+Ww.message),this.browserStorage.setInteractionInProgress(!1),Us(Jo)}}openSizedPopup(e,t){let{popupName:r,popupWindowAttributes:n,popupWindowParent:a}=t;const i=a.screenLeft?a.screenLeft:a.screenX,o=a.screenTop?a.screenTop:a.screenY,s=a.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=a.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let l=n.popupSize?.width,u=n.popupSize?.height,h=n.popupPosition?.top,d=n.popupPosition?.left;return(!l||l<0||l>s)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),l=Wi),(!u||u<0||u>c)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=ji),(!h||h<0||h>c)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),h=Math.max(0,c/2-ji/2+o)),(!d||d<0||d>s)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,s/2-Wi/2+i)),a.open(e,r,`width=${l}, height=${u}, top=${h}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(Po.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${Vi}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${Vi}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class gu{constructor(e,t,r,n,a){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=a}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(ho,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(vo,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:ko,timeout:t.redirectTimeout,noHistory:!1};if("function"===typeof t.onRedirectNavigate){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==t.onRedirectNavigate(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await t.navigationClient.navigateExternal(e,r)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await t.navigationClient.navigateExternal(e,r)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Us(Wo)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(t),n=this.browserStorage.getTemporaryCache(r);if(!n)throw zr(ir,"Cached State");let a;try{a=this.authModule.handleFragmentResponse(e,n)}catch(Ww){throw Ww instanceof Sl&&Ww.subError===es?Us(es):Ww}const i=this.browserStorage.generateNonceKey(n),o=this.browserStorage.getTemporaryCache(i);if(this.authCodeRequest.code=a.code,a.cloud_instance_host_name&&await yc(this.authModule.updateAuthority.bind(this.authModule),ui,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(a.cloud_instance_host_name,this.authCodeRequest.correlationId),a.nonce=o||void 0,a.state=n,a.client_info)this.authCodeRequest.clientInfo=a.client_info;else{const e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}const s=await this.authModule.acquireToken(this.authCodeRequest,a);return this.browserStorage.cleanRequestByState(t),s}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(mo,!0);if(e)try{return JSON.parse(e)}catch(Ww){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}class mu extends Zl{constructor(e,t,r,n,a,i,o,s,c,l){super(e,t,r,n,a,i,o,c,l),this.nativeStorage=s}async acquireToken(e){const t=await yc(this.initializeAuthorizationRequest.bind(this),ii,this.logger,this.performanceClient,this.correlationId)(e,Po.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const r=this.initializeServerTelemetryManager(ko),n=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(kl,Po.Redirect))};try{const a=await yc(this.initializeAuthorizationCodeRequest.bind(this),oi,this.logger,this.performanceClient,this.correlationId)(t),i=await yc(this.createAuthCodeClient.bind(this),ni,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new gu(i,this.browserStorage,a,this.logger,this.performanceClient),s=await i.getAuthCodeUrl({...t,nativeBroker:hu.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${c}`),window.addEventListener("pageshow",n),await o.initiateAuthRequest(s,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(Ww){throw Ww instanceof Vt&&(Ww.setCorrelationId(this.correlationId),r.cacheFailedRequest(Ww)),window.removeEventListener("pageshow",n),this.browserStorage.cleanRequestByState(t.state),Ww}}async handleRedirectPromise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;const r=this.initializeServerTelemetryManager(Ao);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[n,a]=this.getRedirectResponse(e||"");if(!n)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Po.Redirect),"back_forward"!==function(){if("undefined"===typeof window||"undefined"===typeof window.performance||"function"!==typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const i=this.browserStorage.getTemporaryCache(ho,!0)||Se.EMPTY_STRING,o=Zn.removeHashFromUrl(i);if(o===Zn.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),i.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(i);return await this.handleResponse(n,r)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(n,r);if(!Kc()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(fo,a,!0);const e={apiId:Ao,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let t=!0;if(i&&"null"!==i)this.logger.verbose(`Navigating to loginRequestUrl: ${i}`),t=await this.navigationClient.navigateInternal(i,e);else{const r=function(){const e=new Zn(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(ho,r,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),t=await this.navigationClient.navigateInternal(r,e)}if(!t)return await this.handleResponse(n,r)}return null}catch(Ww){throw Ww instanceof Vt&&(Ww.setCorrelationId(this.correlationId),r.cacheFailedRequest(Ww)),this.browserStorage.cleanRequestByInteractionType(Po.Redirect),Ww}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===Xe.QUERY?window.location.search:window.location.hash);let r=Jn(t);if(r){try{!function(e,t,r){if(!e.state)throw Us(Vo);const n=qc(t,e.state);if(!n)throw Us(Yo);if(n.interactionType!==r)throw Us(Qo)}(r,this.browserCrypto,Po.Redirect)}catch(Ww){return Ww instanceof Vt&&this.logger.error(`Interaction type validation failed due to ${Ww.errorCode}: ${Ww.errorMessage}`),[null,""]}return(n=window).location.hash="","function"===typeof n.history.replaceState&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}var n;const a=this.browserStorage.getTemporaryCache(fo,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(fo)),a&&(r=Jn(a),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,a]):[null,""]}async handleResponse(e,t){const r=e.state;if(!r)throw Us(Vo);const n=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Us(Os);const t=new uu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Eo,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,n.correlationId),{userRequestState:a}=Nc.parseRequestState(this.browserCrypto,r);return t.acquireToken({...n,state:a,prompt:void 0}).finally((()=>{this.browserStorage.cleanRequestByState(r)}))}const a=this.browserStorage.getCachedAuthority(r);if(!a)throw Us(ds);const i=await yc(this.createAuthCodeClient.bind(this),ni,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:a});Al.removeThrottle(this.browserStorage,this.config.auth.clientId,n);return new gu(i,this.browserStorage,n,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(Ro);try{this.eventHandler.emitEvent(bl,Po.Redirect,e),await this.clearCacheOnLogout(t.account);const n={apiId:Ro,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await yc(this.createAuthCodeClient.bind(this),ni,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===qt)try{a.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId),void this.eventHandler.emitEvent(wl,Po.Redirect,t)}const i=a.getLogoutUri(t);if(this.eventHandler.emitEvent(wl,Po.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(i,n);if(!1!==e.onRedirectNavigate(i))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(i,n);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(Ww){throw Ww instanceof Vt&&(Ww.setCorrelationId(this.correlationId),r.cacheFailedRequest(Ww)),this.eventHandler.emitEvent(Tl,Po.Redirect,null,Ww),this.eventHandler.emitEvent(Cl,Po.Redirect),Ww}this.eventHandler.emitEvent(Cl,Po.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Zn.getAbsoluteUrl(t,Wc())}}async function vu(e,t,r,n,a){if(t.addQueueMeasurement(Za,n),!e)throw r.info("Navigate url is empty"),Us(Wo);return a?yc(bu,ti,r,t,n)(e,a,t,n):vc(wu,ri,r,t,n)(e)}async function yu(e,t,r,n,a,i,o){return n.addQueueMeasurement(ei,i),new Promise(((n,i)=>{t<Hs&&a.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const s=window.setTimeout((()=>{window.clearInterval(c),i(Us(rs))}),t),c=window.setInterval((()=>{let t="";const r=e.contentWindow;try{t=r?r.location.href:""}catch(Ww){}if(!t||"about:blank"===t)return;let a="";r&&(a=o===Xe.QUERY?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(c),n(a)}),r)})).finally((()=>{vc(Cu,xi,a,n,i)(e)}))}function bu(e,t,r,n){return r.addQueueMeasurement(ti,n),new Promise(((r,n)=>{const a=Tu();window.setTimeout((()=>{a?(a.src=e,r(a)):n("Unable to load iframe")}),t)}))}function wu(e){const t=Tu();return t.src=e,t}function Tu(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function Cu(e){document.body===e.parentNode&&document.body.removeChild(e)}class ku extends Zl{constructor(e,t,r,n,a,i,o,s,c,l,u){super(e,t,r,n,a,i,s,l,u),this.apiId=o,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(Pa,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Ye.NONE&&t.prompt!==Ye.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Ye.NONE}`),t.prompt=Ye.NONE):t.prompt=Ye.NONE;const r=await yc(this.initializeAuthorizationRequest.bind(this),ii,this.logger,this.performanceClient,e.correlationId)(t,Po.Silent);Xc(r.authority);const n=this.initializeServerTelemetryManager(this.apiId);let a;try{return a=await yc(this.createAuthCodeClient.bind(this),ni,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),await yc(this.silentTokenHelper.bind(this),Ja,this.logger,this.performanceClient,e.correlationId)(a,r)}catch(Ww){if(Ww instanceof Vt&&(Ww.setCorrelationId(this.correlationId),n.cacheFailedRequest(Ww)),!a||!(Ww instanceof Vt)||Ww.errorCode!==Ki)throw Ww;this.performanceClient.addFields({retryError:Ww.errorCode},this.correlationId);const i=await yc(this.initializeAuthorizationRequest.bind(this),ii,this.logger,this.performanceClient,e.correlationId)(t,Po.Silent);return await yc(this.silentTokenHelper.bind(this),Ja,this.logger,this.performanceClient,this.correlationId)(a,i)}}logout(){return Promise.reject(Us(ss))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(Ja,r);const n=await yc(this.initializeAuthorizationCodeRequest.bind(this),oi,this.logger,this.performanceClient,r)(t),a=await yc(e.getAuthCodeUrl.bind(e),si,this.logger,this.performanceClient,r)({...t,nativeBroker:hu.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),i=new du(e,this.browserStorage,n,this.logger,this.performanceClient),o=await yc(vu,Za,this.logger,this.performanceClient,r)(a,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,c=await yc(yu,ei,this.logger,this.performanceClient,r)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),l=vc(fu,yi,this.logger,this.performanceClient,this.correlationId)(c,s,this.logger);if(l.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Us(Os);const e=new uu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,l.accountId,this.browserStorage,r),{userRequestState:n}=Nc.parseRequestState(this.browserCrypto,t.state);return yc(e.acquireToken.bind(e),Fa,this.logger,this.performanceClient,r)({...t,state:n,prompt:t.prompt||Ye.NONE})}return yc(i.handleCodeResponse.bind(i),li,this.logger,this.performanceClient,r)(l,t)}}class Eu extends Zl{async acquireToken(e){this.performanceClient.addQueueMeasurement(xa,e.correlationId);const t=await yc(Xl,Ya,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const n=this.initializeServerTelemetryManager(_o),a=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return yc(a.acquireTokenByRefreshToken.bind(a),$a,this.logger,this.performanceClient,e.correlationId)(r).catch((e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e}))}logout(){return Promise.reject(Us(ss))}async createRefreshTokenClient(e){const t=await yc(this.getClientConfiguration.bind(this),ai,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new iu(t,this.performanceClient)}}class Su{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw Us(gs);const n=t.id_token?Wr(t.id_token,ec):void 0,a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.authority?new wc(wc.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,a,this.logger,e.correlationId||lc()):void 0,o=this.loadAccount(e,r.clientInfo||t.client_info||"",n,i),s=this.loadIdToken(t,o.homeAccountId,o.environment,o.realm),c=this.loadAccessToken(e,t,o.homeAccountId,o.environment,o.realm,r),l=this.loadRefreshToken(t,o.homeAccountId,o.environment);return this.generateAuthenticationResult(e,{account:o,idToken:s,accessToken:c,refreshToken:l},n,i)}loadAccount(e,t,r,n){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=Qn.createFromAccountInfo(e.account);return this.storage.setAccount(t),t}if(!n||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Us(Ts);const a=Qn.generateHomeAccountId(t,n.authorityType,this.logger,this.cryptoObj,r),i=r?.tid,o=ql(this.storage,n,a,ec,r,t,n.hostnameAndPort,i,void 0,void 0,this.logger);return this.storage.setAccount(o),o}loadIdToken(e,t,r,n){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const a=Qr(t,r,e.id_token,this.config.auth.clientId,n);return this.storage.setIdTokenCredential(a),a}loadAccessToken(e,t,r,n,a,i){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const o=t.scope?Bn.fromString(t.scope):new Bn(e.scopes),s=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+(new Date).getTime()/1e3,l=Xr(r,n,t.access_token,this.config.auth.clientId,a,o.printScopes(),s,c,ec);return this.storage.setAccessTokenCredential(l),l}loadRefreshToken(e,t,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const n=Jr(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(n),n}generateAuthenticationResult(e,t,r,n){let a,i="",o=[],s=null;t?.accessToken&&(i=t.accessToken.secret,o=Bn.fromString(t.accessToken.target).asArray(),s=new Date(1e3*Number(t.accessToken.expiresOn)),a=new Date(1e3*Number(t.accessToken.extendedExpiresOn)));const c=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:o,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:a,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}class Au extends Kl{constructor(e){super(e),this.includeRedirectUri=!1}}class Iu extends Zl{constructor(e,t,r,n,a,i,o,s,c,l){super(e,t,r,n,a,i,s,c,l),this.apiId=o}async acquireToken(e){if(!e.code)throw Us(ks);const t=await yc(this.initializeAuthorizationRequest.bind(this),ii,this.logger,this.performanceClient,e.correlationId)(e,Po.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const n={...t,code:e.code},a=await yc(this.getClientConfiguration.bind(this),ai,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new Au(a);this.logger.verbose("Auth code client created");const o=new du(i,this.browserStorage,n,this.logger,this.performanceClient);return await yc(o.handleCodeResponseFromServer.bind(o),ci,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(Ww){throw Ww instanceof Vt&&(Ww.setCorrelationId(this.correlationId),r.cacheFailedRequest(Ww)),Ww}}logout(){return Promise.reject(Us(ss))}}function _u(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function Ru(e,t){try{Yc(e)}catch(Ww){throw t.end({success:!1},Ww),Ww}}class Ou{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new gc(this.logger,this.performanceClient):qr,this.eventHandler=new El(this.logger),this.browserStorage=this.isBrowserEnvironment?new $c(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,function(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(Ww){throw Fn(Sn)}return{canonicalAuthority:e.authority?Tc(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}(this.config.auth),this.performanceClient):((e,t)=>new $c(e,{cacheLocation:io,temporaryCacheLocation:io,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},qr,t))(this.config.auth.clientId,this.logger);const t={cacheLocation:io,temporaryCacheLocation:io,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new $c(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new Su(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const r=new Ou(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(Zc);const t=e?.correlationId||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,n=this.performanceClient.startMeasurement(Xa,t);if(this.eventHandler.emitEvent(Jc),r)try{this.nativeExtensionProvider=await hu.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(Ww){this.logger.verbose(Ww)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await yc(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Mi,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(Zc),n.end({allowNativeBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Gc(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return"undefined"===typeof r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),n=r&&hu.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,a=n?r?.correlationId:this.browserStorage.getTemporaryCache(vo,!0)||"",i=this.performanceClient.startMeasurement(Ia,a);let o;if(this.eventHandler.emitEvent(ml,Po.Redirect),n&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new uu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ao,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);o=yc(e.handleRedirectPromise.bind(e),Pi,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const t=this.createRedirectClient(a);o=yc(t.handleRedirectPromise.bind(t),Oi,this.logger,this.performanceClient,i.event.correlationId)(e,i)}return o.then((e=>{if(e){t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(al,Po.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(sl,Po.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:_u(e.account)})}else i.event.errorCode?i.end({success:!1}):i.discard();return this.eventHandler.emitEvent(vl,Po.Redirect),e})).catch((e=>{const r=e;throw t.length>0?this.eventHandler.emitEvent(cl,Po.Redirect,null,r):this.eventHandler.emitEvent(il,Po.Redirect,null,r),this.eventHandler.emitEvent(vl,Po.Redirect),i.end({success:!1},r),e}))}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement(Aa,t);r.add({accountType:_u(e.account),scenarioId:e.scenarioId});const n=e.onRedirectNavigate;if(n)e.onRedirectNavigate=e=>{const t="function"===typeof n?n(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const n="function"===typeof e?e(t):void 0;return!1!==n?r.end({success:!0}):r.discard(),n}}const a=this.getAllAccounts().length>0;try{let n;if(Qc(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),a?this.eventHandler.emitEvent(ol,Po.Redirect,e):this.eventHandler.emitEvent(nl,Po.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)){n=new uu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ko,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch((r=>{if(r instanceof ru&&nu(r)){this.nativeExtensionProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(r instanceof Rc){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw this.browserStorage.setInteractionInProgress(!1),r}))}else{n=this.createRedirectClient(t).acquireToken(e)}return await n}catch(Ww){throw r.end({success:!1},Ww),a?this.eventHandler.emitEvent(cl,Po.Redirect,null,Ww):this.eventHandler.emitEvent(il,Po.Redirect,null,Ww),Ww}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(Sa,t);r.add({scenarioId:e.scenarioId,accountType:_u(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Ru(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(Ww){return Promise.reject(Ww)}const n=this.getAllAccounts();let a;if(n.length>0?this.eventHandler.emitEvent(ol,Po.Popup,e):this.eventHandler.emitEvent(nl,Po.Popup,e),this.canUseNative(e))a=this.acquireTokenNative({...e,correlationId:t},Eo).then((e=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,requestId:e.requestId,accountType:_u(e.account)}),e))).catch((r=>{if(r instanceof ru&&nu(r)){this.nativeExtensionProvider=void 0;return this.createPopupClient(t).acquireToken(e)}if(r instanceof Rc){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e)}throw this.browserStorage.setInteractionInProgress(!1),r}));else{a=this.createPopupClient(t).acquireToken(e)}return a.then((e=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(al,Po.Popup,e):this.eventHandler.emitEvent(sl,Po.Popup,e),r.end({success:!0,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:_u(e.account)}),e))).catch((e=>(n.length>0?this.eventHandler.emitEvent(cl,Po.Popup,null,e):this.eventHandler.emitEvent(il,Po.Popup,null,e),r.end({success:!1},e),Promise.reject(e))))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};let n;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Ma,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:_u(e.account)}),Ru(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(ul,Po.Silent,r),this.canUseNative(r))n=this.acquireTokenNative(r,So).catch((e=>{if(e instanceof ru&&nu(e)){this.nativeExtensionProvider=void 0;return this.createSilentIframeClient(r.correlationId).acquireToken(r)}throw e}));else{n=this.createSilentIframeClient(r.correlationId).acquireToken(r)}return n.then((e=>(this.eventHandler.emitEvent(hl,Po.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:_u(e.account)}),e))).catch((e=>{throw this.eventHandler.emitEvent(dl,Po.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(Ta,t);Ru(this.initialized,r),this.eventHandler.emitEvent(fl,Po.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Us(Ss);if(e.code){const n=e.code;let a=this.hybridAuthCodeResponses.get(n);return a?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),a=this.acquireTokenByCodeAsync({...e,correlationId:t}).then((e=>(this.eventHandler.emitEvent(pl,Po.Silent,e),this.hybridAuthCodeResponses.delete(n),r.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:_u(e.account)}),e))).catch((e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(gl,Po.Silent,null,e),r.end({success:!1},e),e})),this.hybridAuthCodeResponses.set(n,a)),await a}if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId)){const n=await this.acquireTokenNative({...e,correlationId:t},Io,e.nativeAccountId).catch((e=>{throw e instanceof ru&&nu(e)&&(this.nativeExtensionProvider=void 0),e}));return r.end({accountType:_u(n.account),success:!0}),n}throw Us(Is)}throw Us(Es)}catch(Ww){throw this.eventHandler.emitEvent(gl,Po.Silent,null,Ww),r.end({success:!1},Ww),Ww}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Ri,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then((e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e))).catch((e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Wa,e.correlationId),t){case Lo:case Do:case Fo:const t=this.createSilentCacheClient(e.correlationId);return yc(t.acquireToken.bind(t),Oa,this.logger,this.performanceClient,e.correlationId)(e);default:throw zr(Ir)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Ca,e.correlationId),t){case Lo:case Fo:case Uo:case Bo:const t=this.createSilentRefreshClient(e.correlationId);return yc(t.acquireToken.bind(t),xa,this.logger,this.performanceClient,e.correlationId)(e);default:throw zr(Ir)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Ga,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return yc(t.acquireToken.bind(t),Pa,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);Qc(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);Yc(this.initialized),this.browserStorage.setInteractionInProgress(!0);return this.createPopupClient(t).logout(e)}catch(Ww){return Promise.reject(Ww)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return function(e,t,r,n){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(n):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return function(e,t,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const n=r.getAccountInfoFilteredBy(e);return n?(t.verbose("getAccount: Account matching provided filter found, returning"),n):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByUsername(e){return function(e,t,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const n=r.getAccountInfoFilteredBy({username:e});return n?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),n):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return function(e,t,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const n=r.getAccountInfoFilteredBy({homeAccountId:e});return n?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),n):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return function(e,t,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const n=r.getAccountInfoFilteredBy({localAccountId:e});return n?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),n):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}setActiveAccount(e){!function(e,t){t.setActiveAccount(e)}(e,this.browserStorage)}getActiveAccount(){return this.browserStorage.getActiveAccount()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=Qn.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Us(Os);return new uu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!hu.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Ye.NONE:case Ye.CONSENT:case Ye.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new pu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new mu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new ku(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,So,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new su(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Eu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Iu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Io,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Vc(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){try{e.key?.includes($e)&&this.eventHandler.emitEvent(rl);const t=e.newValue||e.oldValue;if(!t)return;const r=JSON.parse(t);if("object"!==typeof r||!Qn.isAccountEntity(r))return;const n=la.toObject(new Qn,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(el,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(tl,void 0,n))}catch(e){return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?lc():Se.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||No})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||No})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(ka,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Ru(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const n=e.account||this.getActiveAccount();if(!n)throw Us(cs);r.add({accountType:_u(n)});const a={clientId:this.config.auth.clientId,authority:e.authority||Se.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},i=JSON.stringify(a),o=this.activeSilentTokenRequests.get(i);if("undefined"===typeof o){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const a=yc(this.acquireTokenSilentAsync.bind(this),Ea,this.logger,this.performanceClient,t)({...e,correlationId:t},n).then((t=>(this.activeSilentTokenRequests.delete(i),r.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),t))).catch((e=>{throw this.activeSilentTokenRequests.delete(i),r.end({success:!1},e),e}));return this.activeSilentTokenRequests.set(i,a),{...await a,state:e.state}}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discard(),{...await o,state:e.state}}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Ea,e.correlationId),this.eventHandler.emitEvent(ol,Po.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const n=await yc(Jl,Qa,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),a=e.cacheLookupPolicy||Lo;return this.acquireTokenSilentNoIframe(n,a).catch((async e=>{const t=function(e,t){const r=!(e instanceof Rc&&e.subError!==Sc),n=e.errorCode===Ki||e.errorCode===Ir,a=r&&n||e.errorCode===Cc||e.errorCode===Ec,i=zo.includes(t);return a&&i}(e,a);if(t){if(this.activeIframeRequest){if(a!==Ho){const[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,n.correlationId);const i=this.performanceClient.startMeasurement(Na,n.correlationId);i.add({awaitIframeCorrelationId:r});const o=await t;if(i.end({success:o}),o)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,a);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),yc(this.acquireTokenBySilentIframe.bind(this),Ga,this.logger,this.performanceClient,n.correlationId)(n)}{let e;return this.activeIframeRequest=[new Promise((t=>{e=t})),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),yc(this.acquireTokenBySilentIframe.bind(this),Ga,this.logger,this.performanceClient,n.correlationId)(n).then((t=>(e(!0),t))).catch((t=>{throw e(!1),t})).finally((()=>{this.activeIframeRequest=void 0}))}}throw e})).then((t=>(this.eventHandler.emitEvent(sl,Po.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId},e.correlationId),t))).catch((e=>{throw this.eventHandler.emitEvent(cl,Po.Silent,null,e),e})).finally((()=>{document.removeEventListener("visibilitychange",r)}))}async acquireTokenSilentNoIframe(e,t){return hu.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,_o).catch((async e=>{if(e instanceof ru&&nu(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,zr(Ir);throw e}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),yc(this.acquireTokenFromCache.bind(this),Wa,this.logger,this.performanceClient,e.correlationId)(e,t).catch((r=>{if(t===Do)throw r;return this.eventHandler.emitEvent(ll,Po.Silent,e),yc(this.acquireTokenByRefreshToken.bind(this),Ca,this.logger,this.performanceClient,e.correlationId)(e,t)})))}}class Pu{static async createPublicClientApplication(e){const t=await async function(e,t){const r=new $s(e);return await r.initialize(),Ou.createController(r,t)}(e);return new Pu(e,t)}constructor(e,t){this.controller=t||new Ou(new $s(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const Nu="b!LaHqOUwB_E6Sn69xhvPUtoG0Qa-dX8dMnq7ayHsvAz4uxaEhOaTLQ7K-kDZ2Itwf",xu={auth:{clientId:"99ca919b-3dd0-488f-b3e6-603c8b351f87",authority:"https://login.microsoftonline.com/64b55024-8293-414d-9162-34e53bb5aa08",redirectUri:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_REDIRECT_URI||window.location.origin},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},Mu={scopes:["User.Read","Files.Read","Files.Read.All","Files.ReadWrite","Sites.Read.All","Sites.ReadWrite.All","Channel.ReadBasic.All","Team.ReadBasic.All","User.Read.All","Directory.Read.All"]},Lu=new Pu(xu);var Du=r(579);const Fu=(0,a.createContext)(),Uu=e=>{let{children:t}=e;const[r,n]=(0,a.useState)(!!localStorage.getItem("msalAccount"));return(0,Du.jsx)(Fu.Provider,{value:{isAuthenticated:r,login:()=>{n(!0),localStorage.setItem("isAuthenticated","true")},logout:async()=>{try{const e=window.location.origin;await Lu.logoutPopup({postLogoutRedirectUri:e,mainWindowRedirectUri:e}),localStorage.removeItem("msalAccount"),localStorage.removeItem("isAuthenticated"),n(!1),localStorage.setItem("isAuthenticated","false")}catch(e){console.error("Logout failed",e)}}},children:t})},Bu=()=>(0,a.useContext)(Fu);class Hu{static async initialize(){return this.initializationPromise||(this.initializationPromise=Lu.initialize().then((()=>{this.isInitialized=!0})).catch((e=>{throw console.error("MSAL initialization failed:",e),this.isInitialized=!1,e}))),this.initializationPromise}static async ensureInitialized(){this.isInitialized||await this.initialize()}static async getAccessToken(){await this.ensureInitialized();const e=Lu.getAllAccounts()[0];if(!e)throw new Error("No active account! Please log in.");try{return(await Lu.acquireTokenSilent({...Mu,account:e})).accessToken}catch(t){if(console.error("Silent token acquisition failed:",t),"InteractionRequiredAuthError"===t.name)try{return(await Lu.acquireTokenPopup(Mu)).accessToken}catch(r){throw console.error("Popup token acquisition failed:",r),r}throw t}}static async handlePageLoad(){await this.ensureInitialized();return Lu.getAllAccounts().length>0}}Hu.isInitialized=!1,Hu.initializationPromise=null;const zu=Hu;const qu=function(){const[e,t]=(0,a.useState)(""),[r,n]=(0,a.useState)(""),i=ne(),{login:o}=Bu(),[s,c]=(0,a.useState)(!1);return(0,Du.jsxs)("div",{className:"login-container",children:[(0,Du.jsx)("img",{src:"https://i.imgur.com/SROEj2Q.jpeg",alt:"Logo",className:"logo"}),(0,Du.jsx)("h2",{children:"Login"}),(0,Du.jsx)("button",{onClick:async()=>{if(!s){c(!0);try{const e=await Lu.loginPopup(Mu);e&&e.account&&(localStorage.setItem("msalAccount",e.account.username),o(),n("Microsoft login successful!"),i("/secure"))}catch(e){console.error("Microsoft login failed:",e),t("Microsoft login failed. Please try again.")}finally{c(!1)}}},className:"login-button",children:"Login with Microsoft"}),r&&(0,Du.jsx)("p",{className:"success-message",children:r}),e&&(0,Du.jsx)("p",{className:"error-message",children:e})]})},$u=3,Ku=2e3,Wu=1e4,ju=2,Vu=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;try{const i=await zu.getAccessToken(),o=new Headers;o.append("Authorization",`Bearer ${i}`),o.append("Content-Type","application/json");const s={method:t,headers:o,body:r?JSON.stringify(r):null},c=await fetch(`https://graph.microsoft.com/v1.0${e}`,s);if(429===c.status){if(console.error("Rate limit hit:",{url:e,method:t,retryCount:n,headers:Object.fromEntries(c.headers.entries())}),n>=$u)throw new Error("Maximum retry attempts reached");const i=c.headers.get("Retry-After"),o=(i?1e3*parseInt(i):Math.min(Ku*Math.pow(ju,n),Wu))*(1+Math.random());return console.warn(`Rate limited. Retrying in ${o/1e3} seconds...`),await(a=o,new Promise((e=>setTimeout(e,a)))),Vu(e,t,r,n+1)}if(!c.ok)throw new Error(`Graph API request failed with status ${c.status}`);return await c.json()}catch(i){throw console.error("Error in graphApiFetch:",i),i}var a},Gu=async()=>{const e=(await(async()=>await Vu(`/drives/${Nu}/root/children`))()).value.find((e=>"Digital File Cabinet"===e.name));if(!e)throw new Error("Digital Filing Cabinet folder not found");return e.id},Yu=async(e,t)=>{const r=(await Ju(e,t)).value.find((e=>"File Cabinet"===e.name));if(!r)throw new Error("File Cabinet folder not found");return r.id},Qu=async(e,t)=>{const r=(await Ju(e,t)).value.find((e=>"Student Records"===e.name));if(!r)throw new Error("Student Records folder not found");return r.id},Xu=async(e,t)=>{const r=(await Ju(e,t)).value.find((e=>"01 Current Students"===e.name));if(!r)throw new Error("01 Current Students folder not found");return r.id},Ju=async(e,t)=>Vu(`/drives/${e}/items/${t}/children`),Zu=async(e,t,r)=>{try{const n=await zu.getAccessToken(),a=new Headers;a.append("Authorization",`Bearer ${n}`),a.append("Content-Type","application/json");const i={name:r,folder:{}},o={method:"POST",headers:a,body:JSON.stringify(i)},s=await fetch(`https://graph.microsoft.com/v1.0/drives/${e}/items/${t}/children`,o);if(!s.ok)throw new Error(`Graph API folder creation failed with status ${s.status}`);return await s.json()}catch(n){throw console.error("Error creating student folder:",n),n}},eh=e=>{let{onScanDocuments:t,onRefreshData:r,isLoading:n}=e;const{isAuthenticated:i,logout:o}=Bu(),[s,c]=(0,a.useState)(""),[l,u]=(0,a.useState)(""),[h,d]=(0,a.useState)(!1),f=ne();(0,a.useEffect)((()=>{const e=localStorage.getItem("token"),t=localStorage.getItem("msalAccount");e||t||f("/")}),[f,i]);const p=e=>{c(e),m(e)},g=()=>{c(""),u("")},m=async e=>{d(!0);try{const t=await(async(e,t,r)=>{try{return(await Ju(t,r)).value.filter((e=>e.name.endsWith(".pdf")))}catch(n){return console.error("Error fetching PDFs:",n),[]}})(0,Nu,"01WZNNVP5M4B3WJJNEHJCJKBZ7XZADQWA2"),r=e.toLowerCase().replace(/\s+/g,""),n=t.find((e=>e.name.toLowerCase().replace(/\s+/g,"")===r+".pdf"));if(n){const e=await(async(e,t)=>{try{return(await Vu(`/drives/${e}/items/${t}`))["@microsoft.graph.downloadUrl"]}catch(r){return console.error("Error fetching file download URL:",r),null}})(n.parentReference.driveId,n.id),t=`https://docs.google.com/viewer?url=${encodeURIComponent(e)}&embedded=true`;u(t)}else console.error("PDF not found for:",r),u("")}catch(t){console.error("Error fetching PDF:",t)}finally{d(!1)}};return(0,Du.jsxs)("div",{className:"navbar",children:[(0,Du.jsxs)("div",{className:"container",children:[(0,Du.jsx)("div",{className:"refresh-button "+(n?"loading":""),onClick:r,disabled:n,children:n?"Refreshing...":"Refresh Data"}),(0,Du.jsx)("div",{className:"scan-button",onClick:()=>t(),children:"Scan"}),(0,Du.jsx)("div",{className:"box",onClick:()=>p("coe"),children:"COE"}),(0,Du.jsx)("div",{className:"box",onClick:()=>p("enrollment"),children:"Enrollment MG"}),(0,Du.jsx)("div",{className:"box",onClick:()=>p("schedule"),children:"Schedule"}),(0,Du.jsx)("div",{className:"box",onClick:()=>p("dd214"),children:"DD214"}),(0,Du.jsx)("div",{className:"box",onClick:()=>p("tar"),children:"TAR"}),(0,Du.jsx)("div",{className:"box",onClick:()=>p("awardletter"),children:"Award Letter"}),(0,Du.jsx)("div",{className:"logout-button",onClick:async()=>{sessionStorage.removeItem("isFirstLoad"),localStorage.removeItem("hasScanned"),await o(),f("/")},children:"Logout"})]}),s&&(0,Du.jsx)("div",{className:"modal",onClick:g,children:(0,Du.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Du.jsx)("span",{className:"close",onClick:g,children:"\xd7"}),(0,Du.jsx)("h2",{children:{coe:"Instructions for COE",enrollment:"Instructions for Enrollment MG",schedule:"Instructions for Schedule",dd214:"Instructions for DD214",tar:"Instructions for TAR",awardletter:"Instructions for Award Letter"}[s.toLowerCase().replace(/\s+/g,"")]})," ",h?(0,Du.jsx)("p",{children:"Loading PDF..."}):l?(0,Du.jsx)("iframe",{src:l,width:"100%",height:"600px",title:"PDF Viewer"}):(0,Du.jsx)("p",{children:"No PDF available."})]})})]})};var th={version:"0.18.5"},rh=1200,nh=1252,ah=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ih={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},oh=function(e){-1!=ah.indexOf(e)&&(nh=ih[0]=e)};var sh=function(e){rh=e,oh(e)};function ch(){sh(1200),oh(1252)}function lh(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function uh(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var hh,dh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?uh(e.slice(2)):65279==t?e.slice(1):e},fh=function(e){return String.fromCharCode(e)},ph=function(e){return String.fromCharCode(e)};var gh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mh(e){for(var t="",r=0,n=0,a=0,i=0,o=0,s=0,c=0,l=0;l<e.length;)i=(r=e.charCodeAt(l++))>>2,o=(3&r)<<4|(n=e.charCodeAt(l++))>>4,s=(15&n)<<2|(a=e.charCodeAt(l++))>>6,c=63&a,isNaN(n)?s=c=64:isNaN(a)&&(c=64),t+=gh.charAt(i)+gh.charAt(o)+gh.charAt(s)+gh.charAt(c);return t}function vh(e){var t="",r=0,n=0,a=0,i=0,o=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)r=gh.indexOf(e.charAt(c++))<<2|(i=gh.indexOf(e.charAt(c++)))>>4,t+=String.fromCharCode(r),n=(15&i)<<4|(o=gh.indexOf(e.charAt(c++)))>>2,64!==o&&(t+=String.fromCharCode(n)),a=(3&o)<<6|(s=gh.indexOf(e.charAt(c++))),64!==s&&(t+=String.fromCharCode(a));return t}var yh=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),bh=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(Ww){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function wh(e){return yh?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Th(e){return yh?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Ch=function(e){return yh?bh(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function kh(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Eh(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Eh(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Sh=yh?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:bh(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var Ah=/\u0000/g,Ih=/[\u0001-\u0006]/g;function _h(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Rh(e,t){var r=""+e;return r.length>=t?r:Ud("0",t-r.length)+r}function Oh(e,t){var r=""+e;return r.length>=t?r:Ud(" ",t-r.length)+r}function Ph(e,t){var r=""+e;return r.length>=t?r:r+Ud(" ",t-r.length)}var Nh=Math.pow(2,32);function xh(e,t){return e>Nh||e<-Nh?function(e,t){var r=""+Math.round(e);return r.length>=t?r:Ud("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:Ud("0",t-r.length)+r}(Math.round(e),t)}function Mh(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Lh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Dh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Fh={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Uh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Bh={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Hh(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,s=0,c=1,l=0,u=0,h=Math.floor(a);l<t&&(s=(h=Math.floor(a))*o+i,u=h*l+c,!(a-h<5e-8));)a=1/(a-h),i=o,o=s,c=l,l=u;if(u>t&&(l>t?(u=c,s=i):(u=l,s=o)),!r)return[0,n*s,u];var d=Math.floor(n*s/u);return[d,n*s-d*u,u]}function zh(e,t,r){if(e>2958465||e<0)return null;var n=0|e,a=Math.floor(86400*(e-n)),i=0,o=[],s={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,86400==++a&&(s.T=a=0,++n,++s.D)),60===n)o=r?[1317,10,29]:[1900,2,29],i=3;else if(0===n)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(c,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=a%60,a=Math.floor(a/60),s.M=a%60,a=Math.floor(a/60),s.H=a,s.q=i,s}var qh=new Date(1899,11,31,0,0,0),$h=qh.getTime(),Kh=new Date(1900,2,1,0,0,0);function Wh(e,t){var r=e.getTime();return t?r-=1262304e5:e>=Kh&&(r+=864e5),(r-($h+6e4*(e.getTimezoneOffset()-qh.getTimezoneOffset())))/864e5}function jh(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Vh(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=jh(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=jh(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),jh(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Gh(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Vh(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return gd(14,Wh(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Yh(e,t,r,n){var a,i="",o=0,s=0,c=r.y,l=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:a=c%100,l=2;break;default:a=c%1e4,l=4}break;case 109:switch(t.length){case 1:case 2:a=r.m,l=t.length;break;case 3:return Dh[r.m-1][1];case 5:return Dh[r.m-1][0];default:return Dh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,l=t.length;break;case 3:return Lh[r.q][0];default:return Lh[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(s=n>=2?3===n?1e3:100:1===n?10:1,(o=Math.round(s*(r.S+r.u)))>=60*s&&(o=0),"s"===t?0===o?"0":""+o/s:(i=Rh(o,2+n),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):Rh(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=3===t.length?1:2;break;case 101:a=c,l=1}return l>0?Rh(a,l):""}function Qh(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var Xh=/%/g;function Jh(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Jh(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a)).indexOf("e")){var o=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Zh=/# (\?+)( ?)\/( ?)(\d+)/;var ed=/^#*0*\.([0#]+)/,td=/\).*[0#]/,rd=/\(###\) ###\\?-####/;function nd(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function ad(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function id(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function od(e,t,r){if(40===e.charCodeAt(0)&&!t.match(td)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?od("n",n,r):"("+od("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return ld(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(Xh,""),a=t.length-n.length;return ld(e,n,r*Math.pow(10,2*a))+Ud("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return Jh(t,r);if(36===t.charCodeAt(0))return"$"+od(e,t.substr(" "==t.charAt(1)?2:1),r);var a,i,o,s,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+xh(c,t.length);if(t.match(/^[#?]+$/))return"0"===(a=xh(r,0))&&(a=""),a.length>t.length?a:nd(t.substr(0,t.length-a.length))+a;if(i=t.match(Zh))return function(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,s=n;return r+(0===i?"":""+i)+" "+(0===o?Ud(" ",e[1].length+1+e[4].length):Oh(o,e[1].length)+e[2]+"/"+e[3]+Rh(s,e[4].length))}(i,c,l);if(t.match(/^#+0+$/))return l+xh(c,t.length-t.indexOf("0"));if(i=t.match(ed))return a=ad(r,i[1].length).replace(/^([^\.]+)$/,"$1."+nd(i[1])).replace(/\.$/,"."+nd(i[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Ud("0",nd(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+ad(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+Qh(xh(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+od(e,t,-r):Qh(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,i[1].length)))+"."+Rh(id(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return od(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_h(od(e,t.replace(/[\\-]/g,""),r)),o=0,_h(_h(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return o<a.length?a.charAt(o++):"0"===e?"0":""})));if(t.match(rd))return"("+(a=od(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),s=Hh(c,Math.pow(10,o)-1,!1),a=""+l," "==(u=ld("n",i[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Ph(s[2],o)).length<i[4].length&&(u=nd(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l+((s=Hh(c,Math.pow(10,o)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?Oh(s[1],o)+i[2]+"/"+i[3]+Ph(s[2],o):Ud(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=xh(r,0),t.length<=a.length?a:nd(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,d=t.length-a.length-h;return nd(t.substr(0,h)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=id(r,i[1].length),r<0?"-"+od(e,t,-r):Qh(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Rh(0,3-e.length):"")+e}))+"."+Rh(o,i[1].length);switch(t){case"###,##0.00":return od(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=Qh(xh(c,0));return"0"!==f?l+f:"";case"###,###.00":return od(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return od(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function sd(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+sd(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a)).match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function cd(e,t,r){if(40===e.charCodeAt(0)&&!t.match(td)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cd("n",n,r):"("+cd("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return ld(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(Xh,""),a=t.length-n.length;return ld(e,n,r*Math.pow(10,2*a))+Ud("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return sd(t,r);if(36===t.charCodeAt(0))return"$"+cd(e,t.substr(" "==t.charAt(1)?2:1),r);var a,i,o,s,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+Rh(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,0===r&&(a=""),a.length>t.length?a:nd(t.substr(0,t.length-a.length))+a;if(i=t.match(Zh))return function(e,t,r){return r+(0===t?"":""+t)+Ud(" ",e[1].length+2+e[4].length)}(i,c,l);if(t.match(/^#+0+$/))return l+Rh(c,t.length-t.indexOf("0"));if(i=t.match(ed))return a=(a=(""+r).replace(/^([^\.]+)$/,"$1."+nd(i[1])).replace(/\.$/,"."+nd(i[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Ud("0",nd(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+Qh(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cd(e,t,-r):Qh(""+r)+"."+Ud("0",i[1].length);if(i=t.match(/^#,#*,#0/))return cd(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_h(cd(e,t.replace(/[\\-]/g,""),r)),o=0,_h(_h(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return o<a.length?a.charAt(o++):"0"===e?"0":""})));if(t.match(rd))return"("+(a=cd(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),s=Hh(c,Math.pow(10,o)-1,!1),a=""+l," "==(u=ld("n",i[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Ph(s[2],o)).length<i[4].length&&(u=nd(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l+((s=Hh(c,Math.pow(10,o)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?Oh(s[1],o)+i[2]+"/"+i[3]+Ph(s[2],o):Ud(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:nd(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,d=t.length-a.length-h;return nd(t.substr(0,h)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+cd(e,t,-r):Qh(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Rh(0,3-e.length):"")+e}))+"."+Rh(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=Qh(""+c);return"0"!==f?l+f:"";default:if(t.match(/\.[0#?]*$/))return cd(e,t.slice(0,t.lastIndexOf(".")),r)+nd(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ld(e,t,r){return(0|r)===r?cd(e,t,r):od(e,t,r)}var ud=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function hd(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Mh(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(ud))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var dd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function fd(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function pd(e,t){var r=function(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var i=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,i];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var o=r[0].match(dd),s=r[1].match(dd);return fd(t,o)?[n,r[0]]:fd(t,s)?[n,r[1]]:[n,r[null!=o&&null!=s?2:1]]}return[n,i]}function gd(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:Fh)[e])&&(n=r.table&&r.table[Uh[e]]||Fh[Uh[e]]),null==n&&(n=Bh[e]||"General")}if(Mh(n,0))return Gh(t,r);t instanceof Date&&(t=Wh(t,r.date1904));var a=pd(n,t);if(Mh(a[1]))return Gh(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var a,i,o,s=[],c="",l=0,u="",h="t",d="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!Mh(e,l))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(c="";34!==(o=e.charCodeAt(++l))&&l<e.length;)c+=String.fromCharCode(o);s[s.length]={t:"t",v:c},++l;break;case"\\":var f=e.charAt(++l),p="("===f||")"===f?f:"t";s[s.length]={t:p,v:f},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:t},++l;break;case"B":case"b":if("1"===e.charAt(l+1)||"2"===e.charAt(l+1)){if(null==a&&null==(a=zh(t,r,"2"===e.charAt(l+1))))return"";s[s.length]={t:"X",v:e.substr(l,2)},h=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=zh(t,r)))return"";for(c=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)c+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=d),s[s.length]={t:u,v:c},h=u;break;case"A":case"a":case"\u4e0a":var g={t:u,v:u};if(null==a&&(a=zh(t,r)),"A/P"===e.substr(l,3).toUpperCase()?(null!=a&&(g.v=a.H>=12?"P":"A"),g.t="T",d="h",l+=3):"AM/PM"===e.substr(l,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"PM":"AM"),g.t="T",l+=5,d="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(l,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),g.t="T",l+=5,d="h"):(g.t="t",++l),null==a&&"T"===g.t)return"";s[s.length]=g,h=u;break;case"[":for(c=u;"]"!==e.charAt(l++)&&l<e.length;)c+=e.charAt(l);if("]"!==c.slice(-1))throw'unterminated "[" block: |'+c+"|";if(c.match(ud)){if(null==a&&null==(a=zh(t,r)))return"";s[s.length]={t:"Z",v:c.toLowerCase()},h=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",hd(e)||(s[s.length]={t:"t",v:c}));break;case".":if(null!=a){for(c=u;++l<e.length&&"0"===(u=e.charAt(l));)c+=u;s[s.length]={t:"s",v:c};break}case"0":case"#":for(c=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)c+=u;s[s.length]={t:"n",v:c};break;case"?":for(c=u;e.charAt(++l)===u;)c+=u;s[s.length]={t:u,v:c},h=u;break;case"*":++l," "!=e.charAt(l)&&"*"!=e.charAt(l)||++l;break;case"(":case")":s[s.length]={t:1===n?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)c+=e.charAt(l);s[s.length]={t:"D",v:c};break;case" ":s[s.length]={t:u,v:u},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++l}var m,v=0,y=0;for(l=s.length-1,h="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=d,h="h",v<1&&(v=1);break;case"s":(m=s[l].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=s[l].t;break;case"m":"s"===h&&(s[l].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[l].v.match(/[Hh]/)&&(v=1),v<2&&s[l].v.match(/[Mm]/)&&(v=2),v<3&&s[l].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=Yh(s[l].t.charCodeAt(0),s[l].v,a,y),s[l].t="t";break;case"n":case"?":for(b=l+1;null!=s[b]&&("?"===(u=s[b].t)||"D"===u||(" "===u||"t"===u)&&null!=s[b+1]&&("?"===s[b+1].t||"t"===s[b+1].t&&"/"===s[b+1].v)||"("===s[l].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===s[b].v||" "===s[b].v&&null!=s[b+1]&&"?"==s[b+1].t));)s[l].v+=s[b].v,s[b]={v:"",t:";"},++b;w+=s[l].v,l=b-1;break;case"G":s[l].t="t",s[l].v=Gh(t,r)}var T,C,k="";if(w.length>0){40==w.charCodeAt(0)?(T=t<0&&45===w.charCodeAt(0)?-t:t,C=ld("n",w,T)):(C=ld("n",w,T=t<0&&n>1?-t:t),T<0&&s[0]&&"t"==s[0].t&&(C=C.substr(1),s[0].v="-"+s[0].v)),b=C.length-1;var E=s.length;for(l=0;l<s.length;++l)if(null!=s[l]&&"t"!=s[l].t&&s[l].v.indexOf(".")>-1){E=l;break}var S=s.length;if(E===s.length&&-1===C.indexOf("E")){for(l=s.length-1;l>=0;--l)null!=s[l]&&-1!=="n?".indexOf(s[l].t)&&(b>=s[l].v.length-1?(b-=s[l].v.length,s[l].v=C.substr(b+1,s[l].v.length)):b<0?s[l].v="":(s[l].v=C.substr(0,b+1),b=-1),s[l].t="t",S=l);b>=0&&S<s.length&&(s[S].v=C.substr(0,b+1)+s[S].v)}else if(E!==s.length&&-1===C.indexOf("E")){for(b=C.indexOf(".")-1,l=E;l>=0;--l)if(null!=s[l]&&-1!=="n?".indexOf(s[l].t)){for(i=s[l].v.indexOf(".")>-1&&l===E?s[l].v.indexOf(".")-1:s[l].v.length-1,k=s[l].v.substr(i+1);i>=0;--i)b>=0&&("0"===s[l].v.charAt(i)||"#"===s[l].v.charAt(i))&&(k=C.charAt(b--)+k);s[l].v=k,s[l].t="t",S=l}for(b>=0&&S<s.length&&(s[S].v=C.substr(0,b+1)+s[S].v),b=C.indexOf(".")+1,l=E;l<s.length;++l)if(null!=s[l]&&(-1!=="n?(".indexOf(s[l].t)||l===E)){for(i=s[l].v.indexOf(".")>-1&&l===E?s[l].v.indexOf(".")+1:0,k=s[l].v.substr(0,i);i<s[l].v.length;++i)b<C.length&&(k+=C.charAt(b++));s[l].v=k,s[l].t="t",S=l}}}for(l=0;l<s.length;++l)null!=s[l]&&"n?".indexOf(s[l].t)>-1&&(T=n>1&&t<0&&l>0&&"-"===s[l-1].v?-t:t,s[l].v=ld(s[l].t,s[l].v,T),s[l].t="t");var A="";for(l=0;l!==s.length;++l)null!=s[l]&&(A+=s[l].v);return A}(a[1],t,r,a[0])}function md(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=Fh[r]){if(Fh[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return Fh[t]=e,t}function vd(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Fh=e}var yd={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},bd=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var wd=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var i=[];for(n=1;16!=n;++n)i[n-1]="undefined"!==typeof Int32Array?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return i}(t),n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],c=r[5],l=r[6],u=r[7],h=r[8],d=r[9],f=r[10],p=r[11],g=r[12],m=r[13],v=r[14];return e.table=t,e.bstr=function(e,r){for(var n=~r,a=0,i=e.length;a<i;)n=n>>>8^t[255&(n^e.charCodeAt(a++))];return~n},e.buf=function(e,r){for(var y=~r,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^m[e[w++]^y>>8&255]^g[e[w++]^y>>16&255]^p[e[w++]^y>>>24]^f[e[w++]]^d[e[w++]]^h[e[w++]]^u[e[w++]]^l[e[w++]]^c[e[w++]]^s[e[w++]]^o[e[w++]]^i[e[w++]]^a[e[w++]]^n[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,r){for(var n=~r,a=0,i=e.length,o=0,s=0;a<i;)(o=e.charCodeAt(a++))<128?n=n>>>8^t[255&(n^o)]:o<2048?n=(n=n>>>8^t[255&(n^(192|o>>6&31))])>>>8^t[255&(n^(128|63&o))]:o>=55296&&o<57344?(o=64+(1023&o),s=1023&e.charCodeAt(a++),n=(n=(n=(n=n>>>8^t[255&(n^(240|o>>8&7))])>>>8^t[255&(n^(128|o>>2&63))])>>>8^t[255&(n^(128|s>>6&15|(3&o)<<4))])>>>8^t[255&(n^(128|63&s))]):n=(n=(n=n>>>8^t[255&(n^(224|o>>12&15))])>>>8^t[255&(n^(128|o>>6&63))])>>>8^t[255&(n^(128|63&o))];return~n},e}(),Td=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function i(e){mp(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),a=e.read_shift(2),i=e.l+a,o={};if(21589===n)1&(r=e.read_shift(1))&&(o.mtime=e.read_shift(4)),a>5&&(2&r&&(o.atime=e.read_shift(4)),4&r&&(o.ctime=e.read_shift(4))),o.mtime&&(o.mt=new Date(1e3*o.mtime));e.l=i,t[n]=o}return t}function o(){return e||(e={})}function s(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=C(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(yh&&Buffer.isBuffer(e)?e.toString("binary"):C(e)).split("\r\n"),a=0,i="";for(a=0;a<n.length;++a)if(i=n[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),r||(r=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),i.slice(0,r.length)!=r););var o=(n[1]||"").match(/boundary="(.*?)"/);if(!o)throw new Error("MAD cannot find boundary");var s="--"+(o[1]||""),c=[],l=[],u={FileIndex:c,FullPaths:l};d(u);var h,f=0;for(a=0;a<n.length;++a){var p=n[a];p!==s&&p!==s+"--"||(f++&&le(u,n.slice(h,a),r),h=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,a,i,o,s,f=512,p=[],g=e.slice(0,512);mp(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(r=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&mp(g=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,r);var w=g.read_shift(4,"i");if(3===r&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);g.l+=4,i=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),o=g.read_shift(4,"i"),n=g.read_shift(4,"i"),s=g.read_shift(4,"i"),a=g.read_shift(4,"i");for(var T=-1,k=0;k<109&&!((T=g.read_shift(4,"i"))<0);++k)p[k]=T;var E=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],a=1;a<r;++a)n[a-1]=e.slice(a*t,(a+1)*t);return n[r-1]=e.slice(r*t),n}(e,f);l(s,a,E,f,p);var S=function(e,t,r,n){var a=e.length,i=[],o=[],s=[],c=[],l=n-1,u=0,h=0,d=0,f=0;for(u=0;u<a;++u)if(s=[],(d=u+t)>=a&&(d-=a),!o[d]){c=[];var p=[];for(h=d;h>=0;){p[h]=!0,o[h]=!0,s[s.length]=h,c.push(e[h]);var g=r[Math.floor(4*h/n)];if(n<4+(f=4*h&l))throw new Error("FAT boundary crossed: "+h+" 4 "+n);if(!e[g])break;if(p[h=cp(e[g],f)])break}i[d]={nodes:s,data:Ff([c])}}return i}(E,i,p,f);S[i].name="!Directory",n>0&&o!==v&&(S[o].name="!MiniFAT"),S[p[0]].name="!FAT",S.fat_addrs=p,S.ssz=f;var A=[],I=[],_=[];!function(e,t,r,n,a,i,o,s){for(var l,d=0,f=n.length?2:0,p=t[e].data,g=0,m=0;g<p.length;g+=128){var y=p.slice(g,g+128);mp(y,64),m=y.read_shift(2),l=Bf(y,0,m-f),n.push(l);var b={name:l,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=h(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=h(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(d=b.start,a>0&&d!==v&&(t[d].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(r,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:d!==v&&b.start!==v&&t[d]&&(b.content=c(b,t[d].data,(t[s]||{}).data))),b.content&&mp(b.content,0),i[l]=b,o.push(b)}}(i,S,E,A,n,{},I,o),function(e,t,r){for(var n=0,a=0,i=0,o=0,s=0,c=r.length,l=[],u=[];n<c;++n)l[n]=u[n]=n,t[n]=r[n];for(;s<u.length;++s)a=e[n=u[s]].L,i=e[n].R,o=e[n].C,l[n]===n&&(-1!==a&&l[a]!==a&&(l[n]=l[a]),-1!==i&&l[i]!==i&&(l[n]=l[i])),-1!==o&&(l[o]=n),-1!==a&&n!=l[n]&&(l[a]=l[n],u.lastIndexOf(a)<s&&u.push(a)),-1!==i&&n!=l[n]&&(l[i]=l[n],u.lastIndexOf(i)<s&&u.push(i));for(n=1;n<c;++n)l[n]===n&&(-1!==i&&l[i]!==i?l[n]=l[i]:-1!==a&&l[a]!==a&&(l[n]=l[a]));for(n=1;n<c;++n)if(0!==e[n].type){if((s=n)!=l[s])do{s=l[s],t[n]=t[s]+"/"+t[n]}while(0!==s&&-1!==l[s]&&s!=l[s]);l[n]=-1}for(t[0]+="/",n=1;n<c;++n)2!==e[n].type&&(t[n]+="/")}(I,_,A),A.shift();var R={FileIndex:I,FullPaths:_};return t&&t.raw&&(R.raw={header:b,sectors:E}),R}function c(e,t,r){for(var n=e.start,a=e.size,i=[],o=n;r&&a>0&&o>=0;)i.push(t.slice(o*m,o*m+m)),a-=m,o=cp(r,4*o);return 0===i.length?yp(0):Sh(i).slice(0,e.size)}function l(e,t,r,n,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var o=r[e],s=(n>>>2)-1;if(!o)return;for(var c=0;c<s&&(i=cp(o,4*c))!==v;++c)a.push(i);l(cp(o,n-4),t-1,r,n,a)}}function u(e,t,r,n,a){var i=[],o=[];a||(a=[]);var s=n-1,c=0,l=0;for(c=t;c>=0;){a[c]=!0,i[i.length]=c,o.push(e[c]);var u=r[Math.floor(4*c/n)];if(n<4+(l=4*c&s))throw new Error("FAT boundary crossed: "+c+" 4 "+n);if(!e[u])break;c=cp(e[u],l)}return{nodes:i,data:Ff([o])}}function h(e,t){return new Date(1e3*(sp(e,t+4)/1e7*Math.pow(2,32)+sp(e,t)/1e7-11644473600))}function d(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(Td.find(e,"/"+t))return;var r=yp(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){d(e);for(var a=!1,i=!1,o=e.FullPaths.length-1;o>=0;--o){var s=e.FileIndex[o];switch(s.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(s.R*s.L*s.C)&&(a=!0),s.R>-1&&s.L>-1&&s.R==s.L&&(a=!0);break;default:a=!0}}if(a||t){var c=new Date(1987,1,19),l=0,u=Object.create?Object.create(null):{},h=[];for(o=0;o<e.FullPaths.length;++o)u[e.FullPaths[o]]=!0,0!==e.FileIndex[o].type&&h.push([e.FullPaths[o],e.FileIndex[o]]);for(o=0;o<h.length;++o){var f=r(h[o][0]);(i=u[f])||(h.push([f,{name:n(f).replace("/",""),type:1,clsid:w,ct:c,mt:c,content:null}]),u[f]=!0)}for(h.sort((function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),a=0,i=0,o=Math.min(r.length,n.length);a<o;++a){if(i=r[a].length-n[a].length)return i;if(r[a]!=n[a])return r[a]<n[a]?-1:1}return r.length-n.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],o=0;o<h.length;++o)e.FullPaths[o]=h[o][0],e.FileIndex[o]=h[o][1];for(o=0;o<h.length;++o){var p=e.FileIndex[o],g=e.FullPaths[o];if(p.name=n(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===o)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(l=o+1;l<h.length&&r(e.FullPaths[l])!=g;++l);for(p.C=l>=h.length?-1:l,l=o+1;l<h.length&&r(e.FullPaths[l])!=r(g);++l);p.R=l>=h.length?-1:l,p.type=1}else r(e.FullPaths[o+1]||"")==r(g)&&(p.R=o+1),p.type=2}}}function p(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],i=e.FullPaths[0],o=i,s=e.FileIndex[0],c=1;c<e.FullPaths.length;++c)if(o=e.FullPaths[c].slice(i.length),(s=e.FileIndex[c]).size&&s.content&&"\x01Sh33tJ5"!=o){o=o.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var l=s.content,u=yh&&Buffer.isBuffer(l)?l.toString("binary"):C(l),h=0,d=Math.min(1024,u.length),f=0,p=0;p<=d;++p)(f=u.charCodeAt(p))>=32&&f<128&&++h;var g=h>=4*d/5;a.push(n),a.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+o),a.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),a.push("Content-Type: "+oe(s,o)),a.push(""),a.push(g?ce(u):se(u))}return a.push(n+"--\r\n"),a.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],i=[],o=yp(1),s=r.compression?8:0,c=0;0;var l=0,u=0,h=0,d=0,f=e.FullPaths[0],p=f,g=e.FileIndex[0],m=[],v=0;for(l=1;l<e.FullPaths.length;++l)if(p=e.FullPaths[l].slice(f.length),(g=e.FileIndex[l]).size&&g.content&&"\x01Sh33tJ5"!=p){var y=h,b=yp(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),m[d]=wd.buf(g.content,0);var w=g.content;8==s&&(w=k(w)),(o=yp(30)).write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,c),o.write_shift(2,s),g.mt?a(o,g.mt):o.write_shift(4,0),o.write_shift(-4,8&c?0:m[d]),o.write_shift(4,8&c?0:w.length),o.write_shift(4,8&c?0:g.content.length),o.write_shift(2,b.length),o.write_shift(2,0),h+=o.length,n.push(o),h+=b.length,n.push(b),h+=w.length,n.push(w),8&c&&((o=yp(12)).write_shift(-4,m[d]),o.write_shift(4,w.length),o.write_shift(4,g.content.length),h+=o.l,n.push(o)),(o=yp(46)).write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,c),o.write_shift(2,s),o.write_shift(4,0),o.write_shift(-4,m[d]),o.write_shift(4,w.length),o.write_shift(4,g.content.length),o.write_shift(2,b.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,y),v+=o.l,i.push(o),v+=b.length,i.push(b),++d}return o=yp(22),o.write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,d),o.write_shift(2,d),o.write_shift(4,v),o.write_shift(4,h),o.write_shift(2,0),Sh([Sh(n),Sh(i),o])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var a=e.FileIndex[n];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:r+=i+511>>9)}}for(var o=e.FullPaths.length+3>>2,s=t+127>>7,c=(t+7>>3)+r+o+s,l=c+127>>7,u=l<=109?0:Math.ceil((l-109)/127);c+l+u+127>>7>l;)u=++l<=109?0:Math.ceil((l-109)/127);var h=[1,u,l,s,o,r,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),i=yp(n[7]<<9),o=0,s=0;for(o=0;o<8;++o)i.write_shift(1,b[o]);for(o=0;o<8;++o)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),o=0;o<3;++o)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,n[2]),i.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:v),i.write_shift(4,n[3]),i.write_shift(-4,n[1]?n[0]-1:v),i.write_shift(4,n[1]),o=0;o<109;++o)i.write_shift(-4,o<n[2]?n[1]+o:-1);if(n[1])for(s=0;s<n[1];++s){for(;o<236+127*s;++o)i.write_shift(-4,o<n[2]?n[1]+o:-1);i.write_shift(-4,s===n[1]-1?v:s+1)}var c=function(e){for(s+=e;o<s-1;++o)i.write_shift(-4,o+1);e&&(++o,i.write_shift(-4,v))};for(s=o=0,s+=n[1];o<s;++o)i.write_shift(-4,T.DIFSECT);for(s+=n[2];o<s;++o)i.write_shift(-4,T.FATSECT);c(n[3]),c(n[4]);for(var l=0,u=0,h=e.FileIndex[0];l<e.FileIndex.length;++l)(h=e.FileIndex[l]).content&&((u=h.content.length)<4096||(h.start=s,c(u+511>>9)));for(c(n[6]+7>>3);511&i.l;)i.write_shift(-4,T.ENDOFCHAIN);for(s=o=0,l=0;l<e.FileIndex.length;++l)(h=e.FileIndex[l]).content&&(!(u=h.content.length)||u>=4096||(h.start=s,c(u+63>>6)));for(;511&i.l;)i.write_shift(-4,T.ENDOFCHAIN);for(o=0;o<n[4]<<2;++o){var d=e.FullPaths[o];if(d&&0!==d.length){h=e.FileIndex[o],0===o&&(h.start=h.size?h.start-1:v);var p=0===o&&r.root||h.name;if(u=2*(p.length+1),i.write_shift(64,p,"utf16le"),i.write_shift(2,u),i.write_shift(1,h.type),i.write_shift(1,h.color),i.write_shift(-4,h.L),i.write_shift(-4,h.R),i.write_shift(-4,h.C),h.clsid)i.write_shift(16,h.clsid,"hex");else for(l=0;l<4;++l)i.write_shift(4,0);i.write_shift(4,h.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,h.start),i.write_shift(4,h.size),i.write_shift(4,0)}else{for(l=0;l<17;++l)i.write_shift(4,0);for(l=0;l<3;++l)i.write_shift(4,-1);for(l=0;l<12;++l)i.write_shift(4,0)}}for(o=1;o<e.FileIndex.length;++o)if((h=e.FileIndex[o]).size>=4096)if(i.l=h.start+1<<9,yh&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+511&-512;else{for(l=0;l<h.size;++l)i.write_shift(1,h.content[l]);for(;511&l;++l)i.write_shift(1,0)}for(o=1;o<e.FileIndex.length;++o)if((h=e.FileIndex[o]).size>0&&h.size<4096)if(yh&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+63&-64;else{for(l=0;l<h.size;++l)i.write_shift(1,h.content[l]);for(;63&l;++l)i.write_shift(1,0)}if(yh)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var g,m=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",T={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function C(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function k(e){return g?g.deflateRawSync(e):G(e)}var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],A=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function I(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var _="undefined"!==typeof Uint8Array,R=_?new Uint8Array(256):[],O=0;O<256;++O)R[O]=I(O);function P(e,t){var r=R[255&e];return t<=8?r>>>8-t:(r=r<<8|R[e>>8&255],t<=16?r>>>16-t:(r=r<<8|R[e>>16&255])>>>24-t)}function N(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function x(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function M(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function L(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function D(e,t,r){var n=7&t,a=t>>>3,i=(1<<r)-1,o=e[a]>>>n;return r<8-n?o&i:(o|=e[a+1]<<8-n,r<16-n?o&i:(o|=e[a+2]<<16-n,r<24-n?o&i:(o|=e[a+3]<<24-n)&i))}function F(e,t,r){var n=7&t,a=t>>>3;return n<=5?e[a]|=(7&r)<<n:(e[a]|=r<<n&255,e[a+1]=(7&r)>>8-n),t+3}function U(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function B(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function H(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function z(e,t){var r=e.length,n=2*r>t?2*r:t+5,a=0;if(r>=t)return e;if(yh){var i=Th(n);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(_){var o=new Uint8Array(n);if(o.set)o.set(e);else for(;a<r;++a)o[a]=e[a];return o}return e.length=n,e}function q(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function $(e,t,r){var n=1,a=0,i=0,o=0,s=0,c=e.length,l=_?new Uint16Array(32):q(32);for(i=0;i<32;++i)l[i]=0;for(i=c;i<r;++i)e[i]=0;c=e.length;var u=_?new Uint16Array(c):q(c);for(i=0;i<c;++i)l[a=e[i]]++,n<a&&(n=a),u[i]=0;for(l[0]=0,i=1;i<=n;++i)l[i+16]=s=s+l[i-1]<<1;for(i=0;i<c;++i)0!=(s=e[i])&&(u[i]=l[s+16]++);var h=0;for(i=0;i<c;++i)if(0!=(h=e[i]))for(s=P(u[i],n)>>n-h,o=(1<<n+4-h)-1;o>=0;--o)t[s|o<<h]=15&h|i<<4;return n}var K=_?new Uint16Array(512):q(512),W=_?new Uint16Array(32):q(32);if(!_){for(var j=0;j<512;++j)K[j]=0;for(j=0;j<32;++j)W[j]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);$(e,W,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);$(r,K,288)}();var V=function(){for(var e=_?new Uint8Array(32768):[],t=0,r=0;t<A.length-1;++t)for(;r<A[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=_?new Uint8Array(259):[];for(t=0,r=0;t<S.length-1;++t)for(;r<S[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),a=r+n==e.length;for(t.write_shift(1,+a),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var a=0,i=0,o=_?new Uint16Array(32768):[];i<t.length;){var s=Math.min(65535,t.length-i);if(s<10){for(7&(a=F(r,a,+!(i+s!=t.length)))&&(a+=8-(7&a)),r.l=a/8|0,r.write_shift(2,s),r.write_shift(2,65535&~s);s-- >0;)r[r.l++]=t[i++];a=8*r.l}else{a=F(r,a,+!(i+s!=t.length)+2);for(var c=0;s-- >0;){var l=t[i],u=-1,h=0;if((u=o[c=32767&(c<<5^l)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+h]==t[i+h]&&h<250;)++h;if(h>2){(l=n[h])<=22?a=B(r,a,R[l+1]>>1)-1:(B(r,a,3),B(r,a+=5,R[l-23]>>5),a+=3);var d=l<8?0:l-4>>2;d>0&&(H(r,a,h-S[l]),a+=d),l=e[i-u],a=B(r,a,R[l]>>3),a-=3;var f=l<4?0:l-2>>1;f>0&&(H(r,a,i-u-A[l]),a+=f);for(var p=0;p<h;++p)o[c]=32767&i,c=32767&(c<<5^t[i]),++i;s-=h-1}else l<=143?l+=48:a=U(r,a,1),a=B(r,a,R[l]),o[c]=32767&i,++i}a=B(r,a,0)-1}}return r.l=(a+7)/8|0,r.l}(t,r)}}();function G(e){var t=yp(50+Math.floor(1.1*e.length)),r=V(e,t);return t.slice(0,r)}var Y=_?new Uint16Array(32768):q(32768),Q=_?new Uint16Array(32768):q(32768),X=_?new Uint16Array(128):q(128),J=1,Z=1;function ee(e,t){var r=M(e,t)+257,n=M(e,t+=5)+1,a=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var i=0,o=_?new Uint8Array(19):q(19),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=1,l=_?new Uint8Array(8):q(8),u=_?new Uint8Array(8):q(8),h=o.length,d=0;d<a;++d)o[E[d]]=i=x(e,t),c<i&&(c=i),l[i]++,t+=3;var f=0;for(l[0]=0,d=1;d<=c;++d)u[d]=f=f+l[d-1]<<1;for(d=0;d<h;++d)0!=(f=o[d])&&(s[d]=u[f]++);var p=0;for(d=0;d<h;++d)if(0!=(p=o[d])){f=R[s[d]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)X[f|g<<p]=7&p|d<<3}var m=[];for(c=1;m.length<r+n;)switch(t+=7&(f=X[L(e,t)]),f>>>=3){case 16:for(i=3+N(e,t),t+=2,f=m[m.length-1];i-- >0;)m.push(f);break;case 17:for(i=3+x(e,t),t+=3;i-- >0;)m.push(0);break;case 18:for(i=11+L(e,t),t+=7;i-- >0;)m.push(0);break;default:m.push(f),c<f&&(c=f)}var v=m.slice(0,r),y=m.slice(r);for(d=r;d<286;++d)v[d]=0;for(d=n;d<30;++d)y[d]=0;return J=$(v,Y,286),Z=$(y,Q,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[wh(t),2];for(var r=0,n=0,a=Th(t||1<<18),i=0,o=a.length>>>0,s=0,c=0;0==(1&n);)if(n=x(e,r),r+=3,n>>>1!=0)for(n>>1==1?(s=9,c=5):(r=ee(e,r),s=J,c=Z);;){!t&&o<i+32767&&(o=(a=z(a,i+32767)).length);var l=D(e,r,s),u=n>>>1==1?K[l]:Y[l];if(r+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var d=i+S[u];h>0&&(d+=D(e,r,h),r+=h),l=D(e,r,c),r+=15&(u=n>>>1==1?W[l]:Q[l]);var f=(u>>>=4)<4?0:u-2>>1,p=A[u];for(f>0&&(p+=D(e,r,f),r+=f),!t&&o<d&&(o=(a=z(a,d+100)).length);i<d;)a[i]=a[i-p],++i}}else{7&r&&(r+=8-(7&r));var g=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,g>0)for(!t&&o<i+g&&(o=(a=z(a,i+g)).length);g-- >0;)a[i++]=e[r>>>3],r+=8}return t?[a,r+7>>>3]:[a.slice(0,i),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;mp(r,0);var n={FileIndex:[],FullPaths:[]};d(n,{root:t.root});for(var a=r.length-4;(80!=r[a]||75!=r[a+1]||5!=r[a+2]||6!=r[a+3])&&a>=0;)--a;r.l=a+4,r.l+=4;var o=r.read_shift(2);r.l+=6;var s=r.read_shift(4);for(r.l=s,a=0;a<o;++a){r.l+=20;var c=r.read_shift(4),l=r.read_shift(4),u=r.read_shift(2),h=r.read_shift(2),f=r.read_shift(2);r.l+=8;var p=r.read_shift(4),g=i(r.slice(r.l+u,r.l+u+h));r.l+=u+h+f;var m=r.l;r.l=p+4,ae(r,c,l,n,g),r.l=m}return n}function ae(e,t,r,n,a){e.l+=2;var o=e.read_shift(2),s=e.read_shift(2),c=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,a=31&r,i=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(i-1),n.setDate(a);var o=31&t,s=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(s),n.setSeconds(o<<1),n}(e);if(8257&o)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var l=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),d=e.read_shift(2),f="",p=0;p<h;++p)f+=String.fromCharCode(e[e.l++]);if(d){var m=i(e.slice(e.l,e.l+d));(m[21589]||{}).mt&&(c=m[21589].mt),((a||{})[21589]||{}).mt&&(c=a[21589].mt)}e.l+=d;var v=e.slice(e.l,e.l+l);switch(s){case 8:v=function(e,t){if(!g)return te(e,t);var r=new(0,g.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var y=!1;8&o&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),l=e.read_shift(4),u=e.read_shift(4)),l!=t&&re(y,"Bad compressed size: "+t+" != "+l),u!=r&&re(y,"Bad uncompressed size: "+r+" != "+u),ue(n,f,v,{unsafe:!0,mt:c})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function oe(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&ie[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&ie[n[1]]?ie[n[1]]:"application/octet-stream"}function se(e){for(var t=mh(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function ce(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<n.length;++a){var i=n[a];if(0!=i.length)for(var o=0;o<i.length;){var s=76,c=i.slice(o,o+s);"="==c.charAt(s-1)?s--:"="==c.charAt(s-2)?s-=2:"="==c.charAt(s-3)&&(s-=3),c=i.slice(o,o+s),(o+=s)<i.length&&(c+="="),r.push(c)}else r.push("")}return r.join("\r\n")}function le(e,t,r){for(var n,a="",i="",o="",s=0;s<10;++s){var c=t[s];if(!c||c.match(/^\s*$/))break;var l=c.match(/^(.*?):\s*([^\s].*)$/);if(l)switch(l[1].toLowerCase()){case"content-location":a=l[2].trim();break;case"content-type":o=l[2].trim();break;case"content-transfer-encoding":i=l[2].trim()}}switch(++s,i.toLowerCase()){case"base64":n=Ch(vh(t.slice(s).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return Ch(t.join("\r\n"))}(t.slice(s));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,a.slice(r.length),n,{unsafe:!0});o&&(u.ctype=o)}function ue(e,t,r,a){var i=a&&a.unsafe;i||d(e);var o=!i&&Td.find(e,t);if(!o){var s=e.FullPaths[0];t.slice(0,s.length)==s?s=t:("/"!=s.slice(-1)&&(s+="/"),s=(s+t).replace("//","/")),o={name:n(t),type:2},e.FileIndex.push(o),e.FullPaths.push(s),i||Td.utils.cfb_gc(e)}return o.content=r,o.size=r?r.length:0,a&&(a.CLSID&&(o.clsid=a.CLSID),a.mt&&(o.mt=a.mt),a.ct&&(o.ct=a.ct)),o}return t.find=function(e,t){var r=e.FullPaths.map((function(e){return e.toUpperCase()})),n=r.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=r[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),o=!0===a?r.indexOf(i):n.indexOf(i);if(-1!==o)return e.FileIndex[o];var s=!i.match(Ih);for(i=i.replace(Ah,""),s&&(i=i.replace(Ih,"!")),o=0;o<r.length;++o){if((s?r[o].replace(Ih,"!"):r[o]).replace(Ah,"")==i)return e.FileIndex[o];if((s?n[o].replace(Ih,"!"):n[o]).replace(Ah,"")==i)return e.FileIndex[o]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||yh&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return o(),s(e.readFileSync(t),r)}(t,r);case"base64":return s(Ch(vh(t)),r);case"binary":return s(Ch(t),r)}return s(t,r)},t.parse=s,t.write=function(t,r){var n=p(t,r);switch(r&&r.type||"buffer"){case"file":return o(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:C(n);case"base64":return mh("string"==typeof n?n:C(n));case"buffer":if(yh)return Buffer.isBuffer(n)?n:bh(n);case"array":return"string"==typeof n?Ch(n):n}return n},t.writeFile=function(t,r,n){o();var a=p(t,n);e.writeFileSync(r,a)},t.utils={cfb_new:function(e){var t={};return d(t,e),t},cfb_add:ue,cfb_del:function(e,t){d(e);var r=Td.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){d(e);var a=Td.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=n(r),e.FullPaths[i]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:up,CheckField:gp,prep_blob:mp,bconcat:Sh,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(Ww){console.error("cannot use native zlib: "+(Ww.message||Ww))}},_deflateRaw:G,_inflateRaw:te,consts:T},t}();let Cd;function kd(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Ed(e){for(var t=[],r=kd(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Sd=new Date(1899,11,30,0,0,0);function Ad(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(Sd.getTime()+6e4*(e.getTimezoneOffset()-Sd.getTimezoneOffset())))/864e5}var Id=new Date,_d=Sd.getTime()+6e4*(Id.getTimezoneOffset()-Sd.getTimezoneOffset()),Rd=Id.getTimezoneOffset();function Od(e){var t=new Date;return t.setTime(24*e*60*60*1e3+_d),t.getTimezoneOffset()!==Rd&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Rd)),t}function Pd(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(a[i],10)}return t}var Nd=new Date("2017-02-19T19:06:09.000Z"),xd=isNaN(Nd.getFullYear())?new Date("2/19/17"):Nd,Md=2017==xd.getFullYear();function Ld(e,t){var r=new Date(e);if(Md)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==xd.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function Dd(e,t){if(yh&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Cf(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Cf(uh(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Cf(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Cf(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return r[e]||e}))}catch(Ww){}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Fd(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Fd(e[r]));return t}function Ud(e,t){for(var r="";r.length<t;)r+=e;return r}function Bd(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(n))?t:t/r):t/r}var Hd=["january","february","march","april","may","june","july","august","september","october","november","december"];function zd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Hd.indexOf(o))return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}var qd=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var a=t.split(r),i=[a[0]],o=1;o<a.length;++o)i.push(n),i.push(a[o]);return i}}();function $d(e){return e?e.content&&e.type?Dd(e.content,!0):e.data?dh(e.data):e.asNodeBuffer&&yh?dh(e.asNodeBuffer().toString("binary")):e.asBinary?dh(e.asBinary()):e._data&&e._data.getContent?dh(Dd(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Kd(e){if(!e)return null;if(e.data)return lh(e.data);if(e.asNodeBuffer&&yh)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?lh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Wd(e,t){for(var r=e.FullPaths||kd(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function jd(e,t){var r=Wd(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function Vd(e,t,r){if(!r)return function(e){return e&&".bin"===e.name.slice(-4)?Kd(e):$d(e)}(jd(e,t));if(!t)return null;try{return Vd(e,t)}catch(Ww){return null}}function Gd(e,t,r){if(!r)return $d(jd(e,t));if(!t)return null;try{return Gd(e,t)}catch(Ww){return null}}function Yd(e,t,r){if(!r)return Kd(jd(e,t));if(!t)return null;try{return Yd(e,t)}catch(Ww){return null}}function Qd(e){for(var t=e.FullPaths||kd(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Xd(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=yh?bh(r):function(e){for(var t=[],r=0,n=e.length+250,a=wh(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|63&o;else if(o>=55296&&o<57344){o=64+(1023&o);var s=1023&e.charCodeAt(++i);a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|s>>6&15|(3&o)<<4,a[r++]=128|63&s}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|63&o;r>n&&(t.push(a.slice(0,r)),r=0,a=wh(65535),n=65530)}return t.push(a.slice(0,r)),Sh(t)}(r),Td.utils.cfb_add(e,t,n);Td.utils.cfb_add(e,t,r)}else e.file(t,r)}function Jd(e,t){switch(t.type){case"base64":return Td.read(e,{type:"base64"});case"binary":return Td.read(e,{type:"binary"});case"buffer":case"array":return Td.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Zd(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var a=n.shift();".."===a?r.pop():"."!==a&&r.push(a)}return r.join("/")}var ef='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',tf=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rf=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,nf=ef.match(rf)?rf:/<[^>]*>/g,af=/<\w*:/,of=/<(\/?)\w+:/;function sf(e,t,r){for(var n={},a=0,i=0;a!==e.length&&(32!==(i=e.charCodeAt(a))&&10!==i&&13!==i);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(tf),s=0,c="",l=0,u="",h="",d=1;if(o)for(l=0;l!=o.length;++l){for(h=o[l],i=0;i!=h.length&&61!==h.charCodeAt(i);++i);for(u=h.slice(0,i).trim();32==h.charCodeAt(i+1);)++i;for(d=34==(a=h.charCodeAt(i+1))||39==a?1:0,c=h.slice(i+1+d,h.length-d),s=0;s!=u.length&&58!==u.charCodeAt(s);++s);if(s===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,r||(n[u.toLowerCase()]=c);else{var f=(5===s&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(s+1);if(n[f]&&"ext"==u.slice(s-3,s))continue;n[f]=c,r||(n[f.toLowerCase()]=c)}}return n}function cf(e){return e.replace(of,"<$1")}var lf={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uf=Ed(lf),hf=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(-1==i)return a.replace(e,(function(e,t){return lf[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),df=/[&<>'"]/g;var ff=/[\u0000-\u001f]/g;function pf(e){return(e+"").replace(df,(function(e){return uf[e]})).replace(/\n/g,"<br/>").replace(ff,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var gf=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function mf(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function vf(e){for(var t="",r=0,n=0,a=0,i=0,o=0,s=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(a=e.charCodeAt(r++),n>191&&n<224?(o=(31&n)<<6,o|=63&a,t+=String.fromCharCode(o)):(i=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&i):(s=((7&n)<<18|(63&a)<<12|(63&i)<<6|63&(o=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(1023&s)))));return t}function yf(e){var t,r,n,a=wh(2*e.length),i=1,o=0,s=0;for(r=0;r<e.length;r+=i)i=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),i=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),i=3):(i=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(a[o++]=255&s,a[o++]=s>>>8,s=0),a[o++]=t%256,a[o++]=t>>>8;return a.slice(0,o).toString("ucs2")}function bf(e){return bh(e,"binary").toString("utf8")}var wf="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Tf=yh&&(bf(wf)==vf(wf)&&bf||yf(wf)==vf(wf)&&yf)||vf,Cf=yh?function(e){return bh(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},kf=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),Ef=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),Sf=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Af=/<\/?(?:vt:)?variant>/g,If=/<(?:vt:)([^>]*)>([\s\S]*)</;function _f(e,t){var r=sf(e),n=e.match(Sf(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach((function(e){var t=e.replace(Af,"").match(If);t&&a.push({v:Tf(t[2]),t:t[1]})})),a}var Rf=/(^\s|\s$|\n)/;function Of(e){return kd(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function Pf(e,t,r){return"<"+e+(null!=r?Of(r):"")+(null!=t?(t.match(Rf)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Nf(e){if(yh&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Tf(kh(Eh(e)));throw new Error("Bad input format: expected Buffer or string")}var xf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Mf="http://schemas.openxmlformats.org/package/2006/content-types",Lf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var Df=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,a=e[0][r].length;n<a;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},Ff=yh?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:bh(e)}))):Df(e)}:Df,Uf=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ip(e,a)));return n.join("").replace(Ah,"")},Bf=yh?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ah,""):Uf(e,t,r)}:Uf,Hf=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},zf=yh?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Hf(e,t,r)}:Hf,qf=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ap(e,a)));return n.join("")},$f=yh?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):qf(e,t,r)}:qf,Kf=function(e,t){var r=sp(e,t);return r>0?$f(e,t+4,t+4+r-1):""},Wf=Kf,jf=function(e,t){var r=sp(e,t);return r>0?$f(e,t+4,t+4+r-1):""},Vf=jf,Gf=function(e,t){var r=2*sp(e,t);return r>0?$f(e,t+4,t+4+r-1):""},Yf=Gf,Qf=function(e,t){var r=sp(e,t);return r>0?Bf(e,t+4,t+4+r):""},Xf=Qf,Jf=function(e,t){var r=sp(e,t);return r>0?$f(e,t+4,t+4+r):""},Zf=Jf,ep=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==n?0==a?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}(e,t)},tp=ep,rp=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function np(){Bf=function(e,t,r){return hh.utils.decode(1200,e.slice(t,r)).replace(Ah,"")},$f=function(e,t,r){return hh.utils.decode(65001,e.slice(t,r))},Wf=function(e,t){var r=sp(e,t);return r>0?hh.utils.decode(nh,e.slice(t+4,t+4+r-1)):""},Vf=function(e,t){var r=sp(e,t);return r>0?hh.utils.decode(rh,e.slice(t+4,t+4+r-1)):""},Yf=function(e,t){var r=2*sp(e,t);return r>0?hh.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Xf=function(e,t){var r=sp(e,t);return r>0?hh.utils.decode(1200,e.slice(t+4,t+4+r)):""},Zf=function(e,t){var r=sp(e,t);return r>0?hh.utils.decode(65001,e.slice(t+4,t+4+r)):""}}yh&&(Wf=function(e,t){if(!Buffer.isBuffer(e))return Kf(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Vf=function(e,t){if(!Buffer.isBuffer(e))return jf(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Yf=function(e,t){if(!Buffer.isBuffer(e))return Gf(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Xf=function(e,t){if(!Buffer.isBuffer(e))return Qf(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Zf=function(e,t){if(!Buffer.isBuffer(e))return Jf(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},tp=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):ep(e,t)},rp=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof hh&&np();var ap=function(e,t){return e[t]},ip=function(e,t){return 256*e[t+1]+e[t]},op=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},sp=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},cp=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lp=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function up(e,t){var r,n,a,i,o,s,c="",l=[];switch(t){case"dbcs":if(s=this.l,yh&&Buffer.isBuffer(this))c=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)c+=String.fromCharCode(ip(this,s)),s+=2;e*=2;break;case"utf8":c=$f(this,this.l,this.l+e);break;case"utf16le":e*=2,c=Bf(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof hh)return up.call(this,e,"dbcs");c=hh.utils.decode(rh,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":c=Wf(this,this.l),e=4+sp(this,this.l);break;case"lpstr-cp":c=Vf(this,this.l),e=4+sp(this,this.l);break;case"lpwstr":c=Yf(this,this.l),e=4+2*sp(this,this.l);break;case"lpp4":e=4+sp(this,this.l),c=Xf(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+sp(this,this.l),c=Zf(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,c="";0!==(a=ap(this,this.l+e++));)l.push(fh(a));c=l.join("");break;case"_wstr":for(e=0,c="";0!==(a=ip(this,this.l+e));)l.push(fh(a)),e+=2;e+=2,c=l.join("");break;case"dbcs-cont":for(c="",s=this.l,o=0;o<e;++o){if(this.lens&&-1!==this.lens.indexOf(s))return a=ap(this,s),this.l=s+1,i=up.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),l.join("")+i;l.push(fh(ip(this,s))),s+=2}c=l.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof hh){c=hh.utils.decode(rh,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(c="",s=this.l,o=0;o!=e;++o){if(this.lens&&-1!==this.lens.indexOf(s))return a=ap(this,s),this.l=s+1,i=up.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),l.join("")+i;l.push(fh(ap(this,s))),s+=1}c=l.join("");break;default:switch(e){case 1:return r=ap(this,this.l),this.l++,r;case 2:return r=("i"===t?op:ip)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?cp:lp)(this,this.l),this.l+=4,r):(n=sp(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?tp(this,this.l):tp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:c=zf(this,this.l,e)}}return this.l+=e,c}var hp=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},dp=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},fp=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function pp(e,t,r){var n=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)fp(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if("sbcs"===r){if("undefined"!==typeof hh&&874==nh)for(a=0;a!=t.length;++a){var i=hh.utils.encode(nh,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);n=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,hp(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?0==o?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var s=0;s<=5;++s,i/=256)e[r+s]=255&i;e[r+6]=(15&a)<<4|15&i,e[r+7]=a>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,dp(this,t,this.l)}}return this.l+=n,this}function gp(e,t){var r=zf(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function mp(e,t){e.l=t,e.read_shift=up,e.chk=gp,e.write_shift=pp}function vp(e,t){e.l+=t}function yp(e){var t=wh(e);return mp(t,0),t}function bp(e,t,r){if(e){var n,a,i;mp(e,e.l||0);for(var o=e.length,s=0,c=0;e.l<o;){128&(s=e.read_shift(1))&&(s=(127&s)+((127&e.read_shift(1))<<7));var l=Ib[s]||Ib[65535];for(i=127&(n=e.read_shift(1)),a=1;a<4&&128&n;++a)i+=(127&(n=e.read_shift(1)))<<7*a;c=e.l+i;var u=l.f&&l.f(e,i,r);if(e.l=c,t(u,l,s))return}}}function wp(){var e=[],t=yh?256:2048,r=function(e){var t=yp(e);return mp(t,0),t},n=r(t),a=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},i=function(e){return n&&e<n.length-n.l?n:(a(),n=r(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(n=e).l&&(n.l=n.length),i(t)},end:function(){return a(),Sh(e)},_bufs:e}}function Tp(e,t,r){var n=Fd(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Cp(e,t,r){var n=Fd(e);return n.s=Tp(n.s,t.s,r),n.e=Tp(n.e,t.s,r),n}function kp(e,t){if(e.cRel&&e.c<0)for(e=Fd(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Fd(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Op(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function Ep(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?kp(e.s,t.biff)+":"+kp(e.e,t.biff):(e.s.rRel?"":"$")+Ap(e.s.r)+":"+(e.e.rRel?"":"$")+Ap(e.e.r):(e.s.cRel?"":"$")+_p(e.s.c)+":"+(e.e.cRel?"":"$")+_p(e.e.c)}function Sp(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Ap(e){return""+(e+1)}function Ip(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function _p(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Rp(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Op(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Pp(e){var t=e.indexOf(":");return-1==t?{s:Rp(e),e:Rp(e)}:{s:Rp(e.slice(0,t)),e:Rp(e.slice(t+1))}}function Np(e,t){return"undefined"===typeof t||"number"===typeof t?Np(e.s,e.e):("string"!==typeof e&&(e=Op(e)),"string"!==typeof t&&(t=Op(t)),e==t?e:e+":"+t)}function xp(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Mp(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=gd(e.z,r?Ad(t):t)}catch(Ww){}try{return e.w=gd((e.XF||{}).numFmtId||(r?14:0),r?Ad(t):t)}catch(Ww){return""+t}}function Lp(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?cg[e.v]||e.v:Mp(e,void 0==t?e.v:t))}function Dp(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Fp(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense;var i=e||(a?[]:{}),o=0,s=0;if(i&&null!=n.origin){if("number"==typeof n.origin)o=n.origin;else{var c="string"==typeof n.origin?Rp(n.origin):n.origin;o=c.r,s=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=xp(i["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),-1==o&&(l.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if("undefined"!==typeof t[h][d]){var f={v:t[h][d]},p=o+h,g=s+d;if(l.s.r>p&&(l.s.r=p),l.s.c>g&&(l.s.c=g),l.e.r<p&&(l.e.r=p),l.e.c<g&&(l.e.c=g),!t[h][d]||"object"!==typeof t[h][d]||Array.isArray(t[h][d])||t[h][d]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[h][d][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else{if(!n.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||Fh[14],n.cellDates?(f.t="d",f.w=gd(f.z,Ad(f.v))):(f.t="n",f.v=Ad(f.v),f.w=gd(f.z,f.v))):f.t="s";else f=t[h][d];if(a)i[p]||(i[p]=[]),i[p][g]&&i[p][g].z&&(f.z=i[p][g].z),i[p][g]=f;else{var m=Op({c:g,r:p});i[m]&&i[m].z&&(f.z=i[m].z),i[m]=f}}}return l.s.c<1e7&&(i["!ref"]=Np(l)),i}function Up(e,t){return Fp(null,e,t)}function Bp(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Hp(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function zp(e,t){var r=e.l,n=e.read_shift(1),a=Bp(e),i=[],o={t:a,h:a};if(0!==(1&n)){for(var s=e.read_shift(4),c=0;c!=s;++c)i.push(Hp(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var qp=zp;function $p(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Kp(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Wp=Bp;function jp(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var Vp=Bp,Gp=jp;function Yp(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var a=0===n?tp([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):cp(t,0)>>2;return r?a/100:a}function Qp(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Xp=Qp;function Jp(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zp(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var eg=80,tg=[eg,81],rg={1:{n:"CodePage",t:2},2:{n:"Category",t:eg},3:{n:"PresentationFormat",t:eg},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:eg},15:{n:"Company",t:eg},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:eg},27:{n:"ContentStatus",t:eg},28:{n:"Language",t:eg},29:{n:"Version",t:eg},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ng={1:{n:"CodePage",t:2},2:{n:"Title",t:eg},3:{n:"Subject",t:eg},4:{n:"Author",t:eg},5:{n:"Keywords",t:eg},6:{n:"Comments",t:eg},7:{n:"Template",t:eg},8:{n:"LastAuthor",t:eg},9:{n:"RevNumber",t:eg},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:eg},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ag={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ig=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function og(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var sg=Fd(og([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),cg={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lg={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ug={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var hg={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function fg(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(nf)||[]).forEach((function(e){var a=sf(e);if("<Relationship"===a[0]){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o="External"===a.TargetMode?a.Target:Zd(a.Target,t);r[o]=i,n[a.Id]=i}})),r["!id"]=n,r}var pg=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gg=function(){for(var e=new Array(pg.length),t=0;t<pg.length;++t){var r=pg[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function mg(e){var t={};e=Tf(e);for(var r=0;r<pg.length;++r){var n=pg[r],a=e.match(gg[r]);null!=a&&a.length>0&&(t[n[1]]=hf(a[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=Ld(t[n[1]]))}return t}var vg=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function yg(e,t,r,n){var a=[];if("string"==typeof e)a=_f(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map((function(e){return{v:e}})));var o="string"==typeof t?_f(t,n).map((function(e){return e.v})):t,s=0,c=0;if(o.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(s,s+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=c,r.DefinedNames=o.slice(s,s+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(s,s+c)}s+=c}}var bg=/<[^>]+>[^<]*/g;var wg,Tg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Cg(e,t,r){wg||(wg=Ed(Tg)),e[t=wg[t]||t]=r}function kg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Eg(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Sg(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Ag(e,t,r){return 31===t?Sg(e):Eg(e,0,r)}function Ig(e,t,r){return Ag(e,t,!1===r?0:4)}function _g(e){var t=e.l,r=Pg(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,Pg(e,3)]}function Rg(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,1200===t?"utf16le":"utf8").replace(Ah,"").replace(Ih,"!"),1200===t&&o%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function Og(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function Pg(e,t,r){var n,a=e.read_shift(2),i=r||{};if(e.l+=2,12!==t&&a!==t&&-1===tg.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return Eg(e,0,4).replace(Ah,"");case 31:return Sg(e);case 64:return kg(e);case 65:return Og(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Ig(e,a,!i.raw).replace(Ah,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ag(e,t,0)}(e,a).replace(Ah,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(_g(e));return r}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Ah,""),e.l-a&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Ah,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Ng(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,s=0,c=-1,l={};for(o=0;o!=a;++o){var u=e.read_shift(4),h=e.read_shift(4);i[o]=[u,h+r]}i.sort((function(e,t){return e[1]-t[1]}));var d={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var f=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=i[o][1]&&(e.l=i[o][1],f=!1)}if((!t||0==o)&&e.l<=i[o][1]&&(f=!1,e.l=i[o][1]),f)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var p=t[i[o][0]];if(d[p.n]=Pg(e,p.t,{raw:!0}),"version"===p.p&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(65535&d[p.n])).slice(-4)),"CodePage"==p.n)switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:sh(s=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(1===i[o][0]){if(s=d.CodePage=Pg(e,2),sh(s),-1!==c){var g=e.l;e.l=i[c][1],l=Rg(e,s),e.l=g}}else if(0===i[o][0]){if(0===s){c=o,e.l=i[o+1][1];continue}l=Rg(e,s)}else{var m,v=l[i[o][0]];switch(e[e.l]){case 65:e.l+=4,m=Og(e);break;case 30:case 31:e.l+=4,m=Ig(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=Lg(e,4);break;case 64:e.l+=4,m=Ld(kg(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[v]=m}}return e.l=r+n,d}function xg(e,t,r){var n=e.content;if(!n)return{};mp(n,0);var a,i,o,s,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),u=n.read_shift(16);if(u!==Td.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=n.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),s=n.read_shift(4),1===a&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);2===a&&(o=n.read_shift(16),c=n.read_shift(4));var h,d=Ng(n,t),f={SystemIdentifier:l};for(var p in d)f[p]=d[p];if(f.FMTID=i,1===a)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);try{h=Ng(n,null)}catch(Ww){}for(p in h)f[p]=h[p];return f.FMTID=[i,o],f}function Mg(e,t){return e.read_shift(t),null}function Lg(e,t){return 1===e.read_shift(t)}function Dg(e){return e.read_shift(2,"u")}function Fg(e,t){return function(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}(e,t,Dg)}function Ug(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=rh;(r&&r.biff>=8&&(rh=1200),r&&8!=r.biff)?12==r.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return rh=i,o}function Bg(e){var t=rh;rh=1200;var r,n=e.read_shift(2),a=e.read_shift(1),i=4&a,o=8&a,s=1+(1&a),c=0,l={};o&&(c=e.read_shift(2)),i&&(r=e.read_shift(4));var u=2==s?"dbcs-cont":"sbcs-cont",h=0===n?"":e.read_shift(n,u);return o&&(e.l+=4*c),i&&(e.l+=r),l.t=h,o||(l.raw="<t>"+l.t+"</t>",l.r=l.t),rh=t,l}function Hg(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function zg(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):Hg(e,n,r)}function qg(e,t,r){if(r.biff>5)return zg(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function $g(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Ah,"");return n&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(a>>1,"utf16le").replace(Ah,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function Kg(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(Ah,""):""}function Wg(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function jg(e,t){var r=Wg(e);return r[3]=0,r}function Vg(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Gg(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function Yg(e){return[e.read_shift(2),Yp(e)]}function Qg(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function Xg(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var Jg=Xg;function Zg(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function em(e){e.l+=2,e.l+=e.read_shift(2)}var tm={0:em,4:em,5:em,6:em,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:em,9:em,10:em,11:em,12:em,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:em,15:em,16:em,17:em,18:em,19:em,20:em,21:Zg};function rm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function nm(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var a=e.read_shift(2);return r&&2==r.biff&&(n=1-(a>>15),a&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},a]}var am=qg;function im(e,t,r){var n=e.l+t,a=8!=r.biff&&r.biff?2:4,i=e.read_shift(a),o=e.read_shift(a),s=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:s},e:{r:o,c:c}}}function om(e,t,r){var n=Vg(e);2!=r.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=a,n.t=!0===a||!1===a?"b":"e",n}var sm=function(e,t,r){return 0===t?"":qg(e,0,r)};function cm(e,t,r){var n,a=e.read_shift(2),i={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Ug(e,0,r),i=e.read_shift(2);if(i!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}(e,t-2,r)),i.body=n||e.read_shift(t-2),"string"===typeof n&&(i.Name=n),i}var lm=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function um(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(r&&2==r.biff?1:2),c=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),c=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var l=Hg(e,o,r);32&a&&(l=lm[l.charCodeAt(0)]);var u=n-e.l;r&&2==r.biff&&--u;var h=n!=e.l&&0!==s&&u>0?function(e,t,r,n){var a,i=e.l+t,o=Jv(e,n,r);i!==e.l&&(a=Xv(e,i-e.l,o,r));return[o,a]}(e,u,r,s):[];return{chKey:i,Name:l,itab:c,rgce:h}}function hm(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=Ug(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);0!==i--;)n.push(Gg(e,r.biff,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function dm(e,t,r){var n=Jg(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,ay(e,t,r)]}var fm={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function pm(e,t,r){if(!r.cellStyles)return vp(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),c=e.read_shift(2);2==n&&(e.l+=2);var l={s:a,e:i,w:o,ixfe:s,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}var gm=Vg,mm=Fg,vm=zg;var ym=[2,3,48,49,131,139,140,245],bm=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ed({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var a=Up(function(t,r){var n=[],a=wh(1);switch(r.type){case"base64":a=Ch(vh(t));break;case"binary":a=Ch(t);break;case"buffer":case"array":a=t}mp(a,0);var i=a.read_shift(1),o=!!(136&i),s=!1,c=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:s=!0,o=!0;break;case 140:c=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var l=0,u=521;2==i&&(l=a.read_shift(2)),a.l+=3,2!=i&&(l=a.read_shift(4)),l>1048576&&(l=1e6),2!=i&&(u=a.read_shift(2));var h=a.read_shift(2),d=r.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(d=e[a[a.l]]),a.l+=1,a.l+=2),c&&(a.l+=36);for(var f=[],p={},g=Math.min(a.length,2==i?521:u-10-(s?264:0)),m=c?32:11;a.l<g&&13!=a[a.l];)switch((p={}).name=hh.utils.decode(d,a.slice(a.l,a.l+m)).replace(/[\u0000\r\n].*$/g,""),a.l+=m,p.type=String.fromCharCode(a.read_shift(1)),2==i||c||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==i&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&f.push(p),2!=i&&(a.l+=c?13:14),p.type){case"B":s&&8==p.len||!r.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(n[0]=[],y=0;y!=f.length;++y)n[0][y]=f[y].name;for(;l-- >0;)if(42!==a[a.l])for(++a.l,n[++v]=[],y=0,y=0;y!=f.length;++y){var b=a.slice(a.l,a.l+f[y].len);a.l+=f[y].len,mp(b,0);var w=hh.utils.decode(d,b);switch(f[y].type){case"C":w.trim().length&&(n[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?n[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):n[v][y]=w;break;case"F":n[v][y]=parseFloat(w.trim());break;case"+":case"I":n[v][y]=c?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":n[v][y]=!0;break;case"N":case"F":n[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));n[v][y]="##MEMO##"+(c?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(n[v][y]=+w||0);break;case"@":n[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":n[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":n[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[v][y]=-b.read_shift(-8,"f");break;case"B":if(s&&8==f[y].len){n[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else a.l+=h;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=f,n}(t,n),n);return a["!cols"]=n.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete n.DBF,a}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Dp(r(e,t),t)}catch(Ww){if(t&&t.WTF)throw Ww}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var a=r||{};if(+a.codepage>=0&&sh(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=wp(),o=ww(e,{header:1,raw:!0,cellDates:!0}),s=o[0],c=o.slice(1),l=e["!cols"]||[],u=0,h=0,d=0,f=1;for(u=0;u<s.length;++u)if(((l[u]||{}).DBF||{}).name)s[u]=l[u].DBF.name,++d;else if(null!=s[u]){if(++d,"number"===typeof s[u]&&(s[u]=s[u].toString(10)),"string"!==typeof s[u])throw new Error("DBF Invalid column name "+s[u]+" |"+typeof s[u]+"|");if(s.indexOf(s[u])!==u)for(h=0;h<1024;++h)if(-1==s.indexOf(s[u]+"_"+h)){s[u]+="_"+h;break}}var p=xp(e["!ref"]),g=[],m=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var y="",b="",w=0,T=[];for(h=0;h<c.length;++h)null!=c[h][u]&&T.push(c[h][u]);if(0!=T.length&&null!=s[u]){for(h=0;h<T.length;++h){switch(typeof T[h]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=T[h]instanceof Date?"D":"C"}w=Math.max(w,String(T[h]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((l[u]||{}).DBF||{}).type)&&l[u].DBF.len>w&&(w=l[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=l[u].DBF.dec,w=l[u].DBF.len),m[u]="C"==y||"N"==b?w:n[y]||0,f+=m[u],g[u]=y}else g[u]="?"}var C=i.next(32);for(C.write_shift(4,318902576),C.write_shift(4,c.length),C.write_shift(2,296+32*d),C.write_shift(2,f),u=0;u<4;++u)C.write_shift(4,0);for(C.write_shift(4,(+t[nh]||3)<<8),u=0,h=0;u<s.length;++u)if(null!=s[u]){var k=i.next(32),E=(s[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,E,"sbcs"),k.write_shift(1,"?"==g[u]?"C":g[u],"sbcs"),k.write_shift(4,h),k.write_shift(1,m[u]||n[g[u]]||0),k.write_shift(1,v[u]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),h+=m[u]||n[g[u]]||0}var S=i.next(264);for(S.write_shift(4,13),u=0;u<65;++u)S.write_shift(4,0);for(u=0;u<c.length;++u){var A=i.next(f);for(A.write_shift(1,0),h=0;h<s.length;++h)if(null!=s[h])switch(g[h]){case"L":A.write_shift(1,null==c[u][h]?63:c[u][h]?84:70);break;case"B":A.write_shift(8,c[u][h]||0,"f");break;case"N":var I="0";for("number"==typeof c[u][h]&&(I=c[u][h].toFixed(v[h]||0)),d=0;d<m[h]-I.length;++d)A.write_shift(1,32);A.write_shift(1,I,"sbcs");break;case"D":c[u][h]?(A.write_shift(4,("0000"+c[u][h].getFullYear()).slice(-4),"sbcs"),A.write_shift(2,("00"+(c[u][h].getMonth()+1)).slice(-2),"sbcs"),A.write_shift(2,("00"+c[u][h].getDate()).slice(-2),"sbcs")):A.write_shift(8,"00000000","sbcs");break;case"C":var _=String(null!=c[u][h]?c[u][h]:"").slice(0,m[h]);for(A.write_shift(1,_,"sbcs"),d=0;d<m[h]-_.length;++d)A.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),wm=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+kd(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?ph(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:ph(n)};function a(e,a){var i,o=e.split(/[\n\r]+/),s=-1,c=-1,l=0,u=0,h=[],d=[],f=null,p={},g=[],m=[],v=[],y=0;for(+a.codepage>=0&&sh(+a.codepage);l!==o.length;++l){y=0;var b,w=o[l].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),T=w.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),C=T[0];if(w.length>0)switch(C){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==T[1].charAt(0)&&d.push(w.slice(3).replace(/;;/g,";"));break;case"C":var k=!1,E=!1,S=!1,A=!1,I=-1,_=-1;for(u=1;u<T.length;++u)switch(T[u].charAt(0)){case"A":case"G":break;case"X":c=parseInt(T[u].slice(1))-1,E=!0;break;case"Y":for(s=parseInt(T[u].slice(1))-1,E||(c=0),i=h.length;i<=s;++i)h[i]=[];break;case"K":'"'===(b=T[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(Bd(b))?isNaN(zd(b).getDate())||(b=Ld(b)):(b=Bd(b),null!==f&&hd(f)&&(b=Od(b))),"undefined"!==typeof hh&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=hh.utils.decode(a.codepage,b)),k=!0;break;case"E":A=!0;var R=Av(T[u].slice(1),{r:s,c:c});h[s][c]=[h[s][c],R];break;case"S":S=!0,h[s][c]=[h[s][c],"S5S"];break;case"R":I=parseInt(T[u].slice(1))-1;break;case"C":_=parseInt(T[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(k&&(h[s][c]&&2==h[s][c].length?h[s][c][0]=b:h[s][c]=b,f=null),S){if(A)throw new Error("SYLK shared formula cannot have own formula");var O=I>-1&&h[I][_];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");h[s][c][1]=Rv(O[1],{r:s-I,c:c-_})}break;case"F":var P=0;for(u=1;u<T.length;++u)switch(T[u].charAt(0)){case"X":c=parseInt(T[u].slice(1))-1,++P;break;case"Y":for(s=parseInt(T[u].slice(1))-1,i=h.length;i<=s;++i)h[i]=[];break;case"M":y=parseInt(T[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=d[parseInt(T[u].slice(1))];break;case"W":for(v=T[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),m[i-1]=0===y?{hidden:!0}:{wch:y},rv(m[i-1]);break;case"C":m[c=parseInt(T[u].slice(1))-1]||(m[c]={});break;case"R":g[s=parseInt(T[u].slice(1))-1]||(g[s]={}),y>0?(g[s].hpt=y,g[s].hpx=iv(y)):0===y&&(g[s].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}P<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return g.length>0&&(p["!rows"]=g),m.length>0&&(p["!cols"]=m),a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),[h,p]}function i(e,t){var r=function(e,t){switch(t.type){case"base64":return a(vh(e),t);case"binary":return a(e,t);case"buffer":return a(yh&&Buffer.isBuffer(e)?e.toString("binary"):kh(e),t);case"array":return a(Dd(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],i=r[1],o=Up(n,t);return kd(i).forEach((function(e){o[e]=i[e]})),o}function o(e,t,r,n){var a="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+_v(e.f,{r:r,c:n}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return Dp(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var r,n,a=["ID;PWXL;N;E"],i=[],s=xp(e["!ref"]),c=Array.isArray(e),l="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=a,e["!cols"].forEach((function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Xm(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Jm(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)}))),e["!rows"]&&function(e,t){t.forEach((function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*av(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))}))}(a,e["!rows"]),a.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var u=s.s.r;u<=s.e.r;++u)for(var h=s.s.c;h<=s.e.c;++h){var d=Op({r:u,c:h});(r=c?(e[u]||[])[h]:e[d])&&(null!=r.v||r.f&&!r.F)&&i.push(o(r,0,u,h))}return a.join(l)+l+i.join(l)+l+"E"+l}}}(),Tm=function(){function e(e,t){for(var r=e.split("\n"),n=-1,a=-1,i=0,o=[];i!==r.length;++i)if("BOT"!==r[i].trim()){if(!(n<0)){for(var s=r[i].trim().split(","),c=s[0],l=s[1],u=r[++i]||"";1&(u.match(/["]/g)||[]).length&&i<r.length-1;)u+="\n"+r[++i];switch(u=u.trim(),+c){case-1:if("BOT"===u){o[++n]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?o[n][a]=!0:"FALSE"===u?o[n][a]=!1:isNaN(Bd(l))?isNaN(zd(l).getDate())?o[n][a]=l:o[n][a]=Ld(l):o[n][a]=Bd(l),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),o[n][a++]=""!==u?u:null}if("EOD"===u)break}}else o[++n]=[],a=0;return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}function t(t,r){return Up(function(t,r){switch(r.type){case"base64":return e(vh(t),r);case"binary":return e(t,r);case"buffer":return e(yh&&Buffer.isBuffer(t)?t.toString("binary"):kh(t),r);case"array":return e(Dd(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}return{to_workbook:function(e,r){return Dp(t(e,r),r)},to_sheet:t,from_sheet:function(){var e=function(e,t,r,n,a){e.push(t),e.push(r+","+n),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,a=[],i=xp(r["!ref"]),o=Array.isArray(r);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var s=i.s.r;s<=i.e.r;++s){t(a,-1,0,"BOT");for(var c=i.s.c;c<=i.e.c;++c){var l=Op({r:s,c:c});if(n=o?(r[s]||[])[c]:r[l])switch(n.t){case"n":var u=n.w;u||null==n.v||(u=n.v),null==u?n.f&&!n.F?t(a,1,0,"="+n.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=gd(n.z||Fh[14],Ad(Ld(n.v)))),t(a,0,n.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),Cm=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return Up(function(e,t){for(var r=e.split("\n"),n=-1,a=-1,i=0,o=[];i!==r.length;++i){var s=r[i].trim().split(":");if("cell"===s[0]){var c=Rp(s[1]);if(o.length<=c.r)for(n=o.length;n<=c.r;++n)o[n]||(o[n]=[]);switch(n=c.r,a=c.c,s[2]){case"t":o[n][a]=s[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":o[n][a]=+s[3];break;case"vtf":var l=s[s.length-1];case"vtc":"nl"===s[3]?o[n][a]=!!+s[4]:o[n][a]=+s[4],"vtf"==s[2]&&(o[n][a]=[o[n][a],l])}}}return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}(e,t),t)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(t){if(!t||!t["!ref"])return"";for(var r,n=[],a=[],i="",o=Pp(t["!ref"]),s=Array.isArray(t),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l)if(i=Op({r:c,c:l}),(r=s?(t[c]||[])[l]:t[i])&&null!=r.v&&"z"!==r.t){switch(a=["cell",i,"t"],r.t){case"s":case"str":a.push(e(r.v));break;case"n":r.f?(a[2]="vtf",a[3]="n",a[4]=r.v,a[5]=e(r.f)):(a[2]="v",a[3]=r.v);break;case"b":a[2]="vt"+(r.f?"f":"c"),a[3]="nl",a[4]=r.v?"1":"0",a[5]=e(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=Ad(Ld(r.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=r.w||gd(r.z||Fh[14],u);break;case"e":continue}n.push(a.join(":"))}return n.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,r){return Dp(t(e,r),r)},to_sheet:t,from_sheet:function(e){return[r,n,a,n,o(e),i].join("\n")}}}(),km=function(){function e(e,t,r,n,a){a.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(Bd(e))?isNaN(zd(e).getDate())?t[r][n]=e:t[r][n]=Ld(e):t[r][n]=Bd(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},a=!1,i=0,o=0;i<e.length;++i)34==(o=e.charCodeAt(i))?a=!a:!a&&o in t&&(n[o]=(n[o]||0)+1);for(i in o=[],n)Object.prototype.hasOwnProperty.call(n,i)&&o.push([n[i],i]);if(!o.length)for(i in n=r)Object.prototype.hasOwnProperty.call(n,i)&&o.push([n[i],i]);return o.sort((function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]})),t[o.pop()[1]]||44}function a(e,t){var r=t||{},a="";var i=r.dense?[]:{},o={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=n(e.slice(0,1024)):a=r&&r.FS?r.FS:n(e.slice(0,1024));var s=0,c=0,l=0,u=0,h=0,d=a.charCodeAt(0),f=!1,p=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=r.dateNF?function(e){var t="number"==typeof e?Fh[e]:e;return t=t.replace(bd,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function v(){var t=e.slice(u,h),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(l=Bd(t)))if(!isNaN(zd(t).getDate())||m&&t.match(m)){n.z=r.dateNF||Fh[14];var a=0;m&&t.match(m)&&(t=function(e,t,r){var n=-1,a=-1,i=-1,o=-1,s=-1,c=-1;(t.match(bd)||[]).forEach((function(e,t){var l=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=l;break;case"d":i=l;break;case"h":o=l;break;case"s":c=l;break;case"m":o>=0?s=l:a=l}})),c>=0&&-1==s&&a>=0&&(s=a,a=-1);var l=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==l.length&&(l="0"+l),8==l.length&&(l="20"+l);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==o&&-1==s&&-1==c?l:-1==n&&-1==a&&-1==i?u:l+"T"+u}(0,r.dateNF,t.match(m)||[]),a=1),r.cellDates?(n.t="d",n.v=Ld(t,a)):(n.t="n",n.v=Ad(Ld(t,a))),!1!==r.cellText&&(n.w=gd(n.z,n.v instanceof Date?Ad(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=l;if("z"==n.t||(r.dense?(i[s]||(i[s]=[]),i[s][c]=n):i[Op({c:c,r:s})]=n),u=h+1,g=e.charCodeAt(u),o.e.c<c&&(o.e.c=c),o.e.r<s&&(o.e.r=s),p==d)++c;else if(c=0,++s,r.sheetRows&&r.sheetRows<=s)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===g&&(f=!f);break;case d:case 10:case 13:if(!f&&v())break e}return h-u>0&&v(),i["!ref"]=Np(o),i}function i(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,r):Up(function(t,r){var n=r||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),o=i.length-1;o>=0&&0===i[o].length;)--o;for(var s=10,c=0,l=0;l<=o;++l)-1==(c=i[l].indexOf(" "))?c=i[l].length:c++,s=Math.max(s,c);for(l=0;l<=o;++l){a[l]=[];var u=0;for(e(i[l].slice(0,s).trim(),a,l,u,n),u=1;u<=(i[l].length-s)/10+1;++u)e(i[l].slice(s+10*(u-1),s+10*u).trim(),a,l,u,n)}return n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}(t,r),r):a(t,r)}function o(e,t){var r="",n="string"==t.type?[0,0,0,0]:gw(e,t);switch(t.type){case"base64":r=vh(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof hh?hh.utils.decode(t.codepage,e):yh&&Buffer.isBuffer(e)?e.toString("binary"):kh(e);break;case"array":r=Dd(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=Tf(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Tf(r):"binary"==t.type&&"undefined"!==typeof hh&&t.codepage&&(r=hh.utils.decode(t.codepage,hh.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Cm.to_sheet("string"==t.type?r:Tf(r),t):i(r,t)}return{to_workbook:function(e,t){return Dp(o(e,t),t)},to_sheet:o,from_sheet:function(e){for(var t,r=[],n=xp(e["!ref"]),a=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){for(var o=[],s=n.s.c;s<=n.e.c;++s){var c=Op({r:i,c:s});if((t=a?(e[i]||[])[s]:e[c])&&null!=t.v){for(var l=(t.w||(Lp(t),t.w)||"").slice(0,10);l.length<10;)l+=" ";o.push(l+(0===s?" ":""))}else o.push("          ")}r.push(o.join(""))}return r.join("\n")}}}();var Em=function(){function e(e,t,r){if(e){mp(e,e.l||0);for(var n=r.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=n[a]||n[65535],o=e.read_shift(2),s=e.l+o,c=i.f&&i.f(e,o,r);if(e.l=s,t(c,i,a))return}}}function t(t,r){if(!t)return t;var n=r||{};var a=n.dense?[]:{},i="Sheet1",o="",s=0,c={},l=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},d=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=v,e(t,(function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:h=e;break;case 204:e&&(o=e);break;case 222:o=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||Fh[14],n.cellDates&&(e[1].t="d",e[1].v=Od(e[1].v))),n.qpro&&e[3]>s&&(a["!ref"]=Np(h),c[i]=a,l.push(i),a=n.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i=o||"Sheet"+(s+1),o="");var u=n.dense?(a[e[0].r]||[])[e[0].c]:a[Op(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Op(e[0])]=e[1]}}),n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=y,14==t[2]&&(n.qpro=!0,t.l=0),e(t,(function(e,t,r){switch(r){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(a["!ref"]=Np(h),c[i]=a,l.push(i),a=n.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i="Sheet"+(s+1)),d>0&&e[0].r>=d)break;n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Op(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==s&&(i=e[1])}}),n)}if(a["!ref"]=Np(h),c[o||i]=a,l.push(o||i),!u.length)return{SheetNames:l,Sheets:c};for(var f={},p=[],g=0;g<u.length;++g)c[l[g]]?(p.push(u[g]||l[g]),f[u[g]]=c[u[g]]||c[l[g]]):(p.push(u[g]),f[u[g]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var a=e.l+t,i=r(e,0,n);if(i[1].t="s",20768==n.vers){e.l++;var o=e.read_shift(1);return i[1].v=e.read_shift(o,"utf8"),i}return n.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,r){var n=yp(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var a=0;a<n.length;++a){var i=r.charCodeAt(a);n.write_shift(1,i>=128?95:i)}return n.write_shift(1,0),n}function i(e,t,r){var n=yp(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function o(e,t,r){var n=yp(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function s(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?_p(t):Ap(t))}var c={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},l=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,r,n){var a=yp(6+n.length);a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<n.length;++i){var o=n.charCodeAt(i);a.write_shift(1,o>=128?95:o)}return a.write_shift(1,0),a}function d(e,t){var r=u(e),n=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===n&&3221225472===a?(r[1].t="e",r[1].v=15):0===n&&3489660928===a?(r[1].t="e",r[1].v=42):r[1].v=0,r;var o=32768&i;return i=(32767&i)-16446,r[1].v=(1-2*o)*(a*Math.pow(2,i+32)+n*Math.pow(2,i)),r}function f(e,t,r,n){var a=yp(14);if(a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),0==n)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,o=0,s=0,c=0;return n<0&&(o=1,n=-n),s=0|Math.log2(n),0==(2147483648&(c=(n/=Math.pow(2,s-31))>>>0))&&(++s,c=(n/=2)>>>0),n-=c,c|=2147483648,c>>>=0,i=(n*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,c),s+=16383+(o?32768:0),a.write_shift(2,s),a}function p(e,t){var r=u(e),n=e.read_shift(8,"f");return r[1].v=n,r}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var r=yp(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var a=e.charCodeAt(n);r[r.l++]=a>127?95:a}return r[r.l++]=0,r}var v={0:{n:"BOF",f:Dg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var a=e.l+t,i=r(e,0,n);if(i[1].v=e.read_shift(8,"f"),n.qpro)e.l=a;else{var o=e.read_shift(2);!function(e,t){mp(e,0);var r=[],n=0,a="",i="",o="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:r.push(e.read_shift(8,"f"));break;case 1:i=s(t[0].c,e.read_shift(2),!0),a=s(t[0].r,e.read_shift(2),!1),r.push(i+a);break;case 2:var d=s(t[0].c,e.read_shift(2),!0),f=s(t[0].r,e.read_shift(2),!1);i=s(t[0].c,e.read_shift(2),!0),a=s(t[0].r,e.read_shift(2),!1),r.push(d+f+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);r.push('"'+p.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:u=r.pop(),o=r.pop(),r.push(["AND","OR"][h-20]+"("+o+","+u+")");break;default:if(h<32&&l[h])u=r.pop(),o=r.pop(),r.push(o+l[h]+u);else{if(!c[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(n=c[h][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+r.join("|")+"|");var g=r.slice(-n);r.length-=n,r.push(c[h][0]+"("+g.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+o),i),e.l+=o}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=u(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:d},24:{n:"NUMBER18",f:function(e,t){var r=u(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=d(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var a=e.read_shift(2);if(14e3==a){for(r[a]=[0,""],r[a][0]=e.read_shift(2);e[e.l];)r[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=u(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var r=p(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&sh(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=wp(),s=xp(e["!ref"]),c=Array.isArray(e),l=[];Rb(n,0,function(e){var t=yp(2);return t.write_shift(2,e),t}(1030)),Rb(n,6,function(e){var t=yp(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(s));for(var u=Math.min(s.e.r,8191),h=s.s.r;h<=u;++h)for(var d=Ap(h),f=s.s.c;f<=s.e.c;++f){h===s.s.r&&(l[f]=_p(f));var p=l[f]+d,g=c?(e[h]||[])[f]:e[p];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?Rb(n,13,i(h,f,g.v)):Rb(n,14,o(h,f,g.v));else Rb(n,15,a(h,f,Lp(g).slice(0,239)))}return Rb(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&sh(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=wp();Rb(n,0,function(e){var t=yp(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,a=0,i=0;i<e.SheetNames.length;++i){var o=e.SheetNames[i],s=e.Sheets[o];if(s&&s["!ref"]){++a;var c=Pp(s["!ref"]);r<c.e.r&&(r=c.e.r),n<c.e.c&&(n=c.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,a),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&Rb(n,27,m(e.SheetNames[a],i++));var o=0;for(a=0;a<e.SheetNames.length;++a){var s=e.Sheets[e.SheetNames[a]];if(s&&s["!ref"]){for(var c=xp(s["!ref"]),l=Array.isArray(s),u=[],d=Math.min(c.e.r,8191),p=c.s.r;p<=d;++p)for(var g=Ap(p),v=c.s.c;v<=c.e.c;++v){p===c.s.r&&(u[v]=_p(v));var y=u[v]+g,b=l?(s[p]||[])[v]:s[y];if(b&&"z"!=b.t)if("n"==b.t)Rb(n,23,f(p,v,o,b.v));else Rb(n,22,h(p,v,o,Lp(b).slice(0,239)))}++o}}return Rb(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(Ch(vh(e)),r);case"binary":return t(Ch(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var Sm=function(){var e=kf("t"),t=kf("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var a={t:"s",v:hf(n[1])},i=r.match(t);return i&&(a.s=function(e){var t={},r=e.match(nf),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=sf(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;t.cp=ih[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==i[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}(i[1])),a}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(a).map(r).filter((function(e){return e.v}))}}(),Am=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Im=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_m=/<(?:\w+:)?r>/,Rm=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Om(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=hf(Tf(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Tf(e),r&&(n.h=pf(n.t))):e.match(_m)&&(n.r=Tf(e),n.t=hf(Tf((e.replace(Rm,"").match(Im)||[]).join("").replace(nf,""))),r&&(n.h=Am(Sm(n.r)))),n):{t:""}}var Pm=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Nm=/<(?:\w+:)?(?:si|sstItem)>/g,xm=/<\/(?:\w+:)?(?:si|sstItem)>/;function Mm(e){if("undefined"!==typeof hh)return hh.utils.encode(nh,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Lm(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Dm(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Fm(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Lm(e,4),t.U=Lm(e,4),t.W=Lm(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function Um(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=36==n.Flags;break;case 26625:a=4==n.Flags;break;case 0:a=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Bm(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Hm(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Um(e,t),v:Bm(e,e.length-e.l)}}function zm(){throw new Error("File is password-protected: ECMA-376 Extensible")}function qm(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(nf,(function(e){var r=sf(e);switch(cf(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){n[e]=r[e]}));break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}})),n}function $m(e){var t,r,n=0,a=Mm(e),i=a.length+1;for((t=wh(i))[0]=a.length,r=1;r!=i;++r)t[r]=a[r-1];for(r=i-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var Km=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(a){for(var i,o,s,c=Mm(a),l=function(e){for(var n=t[e.length-1],a=104,i=e.length-1;i>=0;--i)for(var o=e[i],s=0;7!=s;++s)64&o&&(n^=r[a]),o*=2,--a;return n}(c),u=c.length,h=wh(16),d=0;16!=d;++d)h[d]=0;for(1===(1&u)&&(i=l>>8,h[u]=n(e[0],i),--u,i=255&l,o=c[c.length-1],h[u]=n(o,i));u>0;)i=l>>8,h[--u]=n(c[u],i),i=255&l,h[--u]=n(c[u],i);for(u=15,s=15-c.length;s>0;)i=l>>8,h[u]=n(e[s],i),--s,i=255&l,h[--u]=n(c[u],i),--u,--s;return h}}(),Wm=function(e){var t=0,r=Km(e);return function(e){var n=function(e,t,r,n,a){var i,o;for(a||(a=t),n||(n=Km(e)),i=0;i!=t.length;++i)o=t[i],o=255&((o^=n[r])>>5|o<<3),a[i]=o,++r;return[a,r,n]}("",e,t,r);return t=n[1],n[0]}};function jm(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=Lm(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=Lm(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Um(e,a),t-=a,r.EncryptionVerifier=Bm(e,t),r}(e,t),n}var Vm=function(){function e(e,r){switch(r.type){case"base64":return t(vh(e),r);case"binary":return t(e,r);case"buffer":return t(yh&&Buffer.isBuffer(e)?e.toString("binary"):kh(e),r);case"array":return t(Dd(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach((function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,i=/\\\w+\b/g,o=0,s=-1;n=i.exec(e);){if("\\cell"===n[0]){var c=e.slice(o,i.lastIndex-n[0].length);if(" "==c[0]&&(c=c.slice(1)),++s,c.length){var l={v:c,t:"s"};Array.isArray(r)?r[t][s]=l:r[Op({r:t,c:s})]=l}}o=i.lastIndex}s>a.e.c&&(a.e.c=s)})),r["!ref"]=Np(a),r}return{to_workbook:function(t,r){return Dp(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=xp(e["!ref"]),a=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){r.push("\\trowd\\trautofit1");for(var o=n.s.c;o<=n.e.c;++o)r.push("\\cellx"+(o+1));for(r.push("\\pard\\intbl"),o=n.s.c;o<=n.e.c;++o){var s=Op({r:i,c:o});(t=a?(e[i]||[])[o]:e[s])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(Lp(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function Gm(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Ym(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(0===o)return[0,0,t];var s,c=0,l=a+i;switch(s=o/(l>1?2-l:l),a){case t:c=((r-n)/o+6)%6;break;case r:c=(n-t)/o+2;break;case n:c=(t-r)/o+4}return[c/6,s,l/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),Gm(function(e){var t,r=e[0],n=e[1],a=e[2],i=2*n*(a<.5?a:1-a),o=a-i/2,s=[o,o,o],c=6*r;if(0!==n)switch(0|c){case 0:case 6:t=i*c,s[0]+=i,s[1]+=t;break;case 1:t=i*(2-c),s[0]+=t,s[1]+=i;break;case 2:t=i*(c-2),s[1]+=i,s[2]+=t;break;case 3:t=i*(4-c),s[1]+=t,s[2]+=i;break;case 4:t=i*(c-4),s[2]+=i,s[0]+=t;break;case 5:t=i*(6-c),s[2]+=t,s[0]+=i}for(var l=0;3!=l;++l)s[l]=Math.round(255*s[l]);return s}(r))}var Qm=6;function Xm(e){return Math.floor((e+Math.round(128/Qm)/256)*Qm)}function Jm(e){return Math.floor((e-5)/Qm*100+.5)/100}function Zm(e){return Math.round((e*Qm+5)/Qm*256)/256}function ev(e){return Zm(Jm(Xm(e)))}function tv(e){var t=Math.abs(e-ev(e)),r=Qm;if(t>.005)for(Qm=1;Qm<15;++Qm)Math.abs(e-ev(e))<=t&&(t=Math.abs(e-ev(e)),r=Qm);Qm=r}function rv(e){e.width?(e.wpx=Xm(e.width),e.wch=Jm(e.wpx),e.MDW=Qm):e.wpx?(e.wch=Jm(e.wpx),e.width=Zm(e.wch),e.MDW=Qm):"number"==typeof e.wch&&(e.width=Zm(e.wch),e.wpx=Xm(e.width),e.MDW=Qm),e.customWidth&&delete e.customWidth}var nv=96;function av(e){return 96*e/nv}function iv(e){return e*nv/96}var ov={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var sv=["numFmtId","fillId","fontId","borderId","xfId"],cv=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var lv=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,o,s){var c,l={};return i?((c=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var n=kd(Fh),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Fh[n[a]];var i=e[0].match(nf);if(i)for(a=0;a<i.length;++a){var o=sf(i[a]);switch(cf(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var s=hf(Tf(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=s,c>0){if(c>392){for(c=392;c>60&&null!=t.NumberFmt[c];--c);t.NumberFmt[c]=s}md(s,c)}break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}(c,l,s),(c=i.match(n))&&function(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(nf)||[]).forEach((function(e){var o=sf(e);switch(cf(o[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Tf(o.val));break;case"<b":a.bold=o.val?mf(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?mf(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?mf(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?mf(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?mf(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?mf(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?mf(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<charset":if("1"==o.val)break;o.codepage=ih[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=mf(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var s=sg[a.color.index];81==a.color.index&&(s=sg[1]),s||(s=sg[1]),a.color.rgb=s[0].toString(16)+s[1].toString(16)+s[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Ym(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}}))}(c,l,o,s),(c=i.match(r))&&function(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(nf)||[]).forEach((function(e){var r=sf(e);switch(cf(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":r.patternType&&(a.patternType=r.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),r.indexed&&(a.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(a.bgColor.theme=parseInt(r.theme,10)),r.tint&&(a.bgColor.tint=parseFloat(r.tint)),r.rgb&&(a.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),r.theme&&(a.fgColor.theme=parseInt(r.theme,10)),r.tint&&(a.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(a.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+r[0]+" in fills")}}))}(c,l,0,s),(c=i.match(a))&&function(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(nf)||[]).forEach((function(e){var r=sf(e);switch(cf(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},r.diagonalUp&&(a.diagonalUp=mf(r.diagonalUp)),r.diagonalDown&&(a.diagonalDown=mf(r.diagonalDown)),t.Borders.push(a);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+r[0]+" in borders")}}))}(c,l,0,s),(c=i.match(t))&&function(e,t,r){var n;t.CellXf=[];var a=!1;(e[0].match(nf)||[]).forEach((function(e){var i=sf(e),o=0;switch(cf(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=i)[0],o=0;o<sv.length;++o)n[sv[o]]&&(n[sv[o]]=parseInt(n[sv[o]],10));for(o=0;o<cv.length;++o)n[cv[o]]&&(n[cv[o]]=mf(n[cv[o]]));if(t.NumberFmt&&n.numFmtId>392)for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var s={};i.vertical&&(s.vertical=i.vertical),i.horizontal&&(s.horizontal=i.horizontal),null!=i.textRotation&&(s.textRotation=i.textRotation),i.indent&&(s.indent=i.indent),i.wrapText&&(s.wrapText=mf(i.wrapText)),n.alignment=s;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}}))}(c,l,s),l):l}}();var uv=vp;var hv=vp;var dv=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function fv(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(nf)||[]).forEach((function(e){var a=sf(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[dv.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}}))}function pv(){}function gv(){}var mv=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vv=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yv=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var bv=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function wv(e,t){var r;e&&0!==e.length||(e=Tv());var n={};if(!(r=e.match(bv)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",mv,fv],["fontScheme",vv,pv],["fmtScheme",yv,gv]].forEach((function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)}))}(r[0],n,t),n.raw=e,n}function Tv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[ef];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Cv(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return vp(e,t)}(e,4);break;case 2:t.xclrValue=Wg(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function kv(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Cv(e);break;case 6:n[1]=function(e,t){return vp(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Ev(e,t,r,n){var a,i=Array.isArray(e);t.forEach((function(t){var o=Rp(t.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[t.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[t.ref]=a;var s=xp(e["!ref"]||"BDWGO1000001:A1");s.s.r>o.r&&(s.s.r=o.r),s.e.r<o.r&&(s.e.r=o.r),s.s.c>o.c&&(s.s.c=o.c),s.e.c<o.c&&(s.e.c=o.c);var c=Np(s);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var l={a:t.author,t:t.t,r:t.r,T:r};t.h&&(l.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!r&&a.c[u].T)return;r&&!a.c[u].T&&a.c.splice(u,1)}if(r&&n)for(u=0;u<n.length;++u)if(l.a==n[u].id){l.a=n[u].name||l.a;break}a.c.push(l)}))}var Sv=Bp;var Av=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,a){var i=!1,o=!1;0==n.length?o=!0:"["==n.charAt(0)&&(o=!0,n=n.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var s=n.length>0?0|parseInt(n,10):0,c=a.length>0?0|parseInt(a,10):0;return i?c+=t.c:--c,o?s+=t.r:--s,r+(i?"":"$")+_p(c)+(o?"":"$")+Ap(s)}return function(n,a){return t=a,n.replace(e,r)}}(),Iv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_v=function(){return function(e,t){return e.replace(Iv,(function(e,r,n,a,i,o){var s=Ip(a)-(n?0:t.c),c=Sp(o)-(i?0:t.r);return r+"R"+(0==c?"":i?c+1:"["+c+"]")+"C"+(0==s?"":n?s+1:"["+s+"]")}))}}();function Rv(e,t){return e.replace(Iv,(function(e,r,n,a,i,o){return r+("$"==n?n+a:_p(Ip(a)+t.c))+("$"==i?i+o:Ap(Sp(o)+t.r))}))}function Ov(e,t,r){var n=Pp(t).s,a=Rp(r);return Rv(e,{r:a.r-n.r,c:a.c-n.c})}function Pv(e){return e.replace(/_xlfn\./g,"")}function Nv(e){e.l+=1}function xv(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function Mv(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Lv(e);12==r.biff&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=xv(e,2),s=xv(e,2);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function Lv(e){var t=xv(e,2),r=xv(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Dv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=xv(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),a=xv(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Fv(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function Uv(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Bv(e){return[e.read_shift(1),e.read_shift(1)]}function Hv(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=Lg(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=cg[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Jp(e);break;case 2:r[1]=qg(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zv(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),a=[],i=0;i!=n;++i)a.push((12==r.biff?Xp:Qg)(e,8));return a}function qv(e,t,r){var n=0,a=0;12==r.biff?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--a&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var s=0;s!=a;++s)o[i][s]=Hv(e,r.biff);return o}function $v(e,t,r){return e.l+=2,[Fv(e)]}function Kv(e){return e.l+=6,[]}function Wv(e){return e.l+=2,[Dg(e),1&e.read_shift(2)]}var jv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Vv={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:vp},3:{n:"PtgAdd",f:Nv},4:{n:"PtgSub",f:Nv},5:{n:"PtgMul",f:Nv},6:{n:"PtgDiv",f:Nv},7:{n:"PtgPower",f:Nv},8:{n:"PtgConcat",f:Nv},9:{n:"PtgLt",f:Nv},10:{n:"PtgLe",f:Nv},11:{n:"PtgEq",f:Nv},12:{n:"PtgGe",f:Nv},13:{n:"PtgGt",f:Nv},14:{n:"PtgNe",f:Nv},15:{n:"PtgIsect",f:Nv},16:{n:"PtgUnion",f:Nv},17:{n:"PtgRange",f:Nv},18:{n:"PtgUplus",f:Nv},19:{n:"PtgUminus",f:Nv},20:{n:"PtgPercent",f:Nv},21:{n:"PtgParen",f:Nv},22:{n:"PtgMissArg",f:Nv},23:{n:"PtgStr",f:function(e,t,r){return e.l++,Ug(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,cg[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Jp(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[py[a],fy[a],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?fy:dy)[i[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,i]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,Dv(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,Mv(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:vp},40:{n:"PtgMemNoMem",f:vp},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==a&&r>=128&&(r-=256),{r:t,c:r,cRel:a,rRel:n}}(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(16384&i)>>14,s=(32768&i)>>15;if(i&=16383,1==s)for(;a>524287;)a-=1048576;if(1==o)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:o,rRel:s}}(e,0,r);return[n,a]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=function(e,t,r){if(r.biff<8)return Lv(e);var n=e.read_shift(12==r.biff?4:2),a=e.read_shift(12==r.biff?4:2),i=xv(e,2),o=xv(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}(e,0,r);return[n,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,a,Dv(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[n,a,Mv(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[n,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[n,a]}},255:{}},Gv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Yv={1:{n:"PtgElfLel",f:Wv},2:{n:"PtgElfRw",f:$v},3:{n:"PtgElfCol",f:$v},6:{n:"PtgElfRwV",f:$v},7:{n:"PtgElfColV",f:$v},10:{n:"PtgElfRadical",f:$v},11:{n:"PtgElfRadicalS",f:Kv},13:{n:"PtgElfColS",f:Kv},15:{n:"PtgElfColSV",f:Kv},16:{n:"PtgElfRadicalLel",f:Wv},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&r,rt:jv[r>>2&31],idx:n,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Qv={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&2==r.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Uv},33:{n:"PtgAttrBaxcel",f:Uv},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Bv(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Bv(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Xv(e,t,r,n){if(n.biff<8)return vp(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=qv(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=zv(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&12==n.biff&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return 0!==(t=a-e.l)&&i.push(vp(e,t)),i}function Jv(e,t,r){for(var n,a,i=e.l+t,o=[];i!=e.l;)t=i-e.l,a=e[e.l],n=Vv[a]||Vv[Gv[a]],24!==a&&25!==a||(n=(24===a?Yv:Qv)[e[e.l+1]]),n&&n.f?o.push([n.n,n.f(e,t,r)]):vp(e,t);return o}function Zv(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)if(2===o[0])a.push('"'+o[1].replace(/"/g,'""')+'"');else a.push(o[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var ey={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ty(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[n[0]][0][3]?(a=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ry(e,t,r){var n=ty(e,t,r);return"#REF"==n?n:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function ny(e,t,r,n,a){var i,o,s,c,l=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],d=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=h.pop(),o=h.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=Ud(" ",e[0][g][1][1]);break;case 1:m=Ud("\r",e[0][g][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}o+=m,g=-1}h.push(o+ey[b[0]]+i);break;case"PtgIsect":i=h.pop(),o=h.pop(),h.push(o+" "+i);break;case"PtgUnion":i=h.pop(),o=h.pop(),h.push(o+","+i);break;case"PtgRange":i=h.pop(),o=h.pop(),h.push(o+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":s=Tp(b[1][1],u,a),h.push(kp(s,l));break;case"PtgRefN":s=r?Tp(b[1][1],r,a):b[1][1],h.push(kp(s,l));break;case"PtgRef3d":d=b[1][1],s=Tp(b[1][2],u,a);p=ry(n,d,a);h.push(p+"!"+kp(s,l));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],T=b[1][1];w||(w=0);var C=0==(w&=127)?[]:h.slice(-w);h.length-=w,"User"===T&&(T=C.shift()),h.push(T+"("+C.join(",")+")");break;case"PtgBool":h.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(b[1]);break;case"PtgNum":h.push(String(b[1]));break;case"PtgStr":h.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":c=Cp(b[1][1],r?{s:r}:u,a),h.push(Ep(c,a));break;case"PtgArea":c=Cp(b[1][1],u,a),h.push(Ep(c,a));break;case"PtgArea3d":d=b[1][1],c=b[1][2],p=ry(n,d,a),h.push(p+"!"+Ep(c,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":f=b[1][2];var k=(n.names||[])[f-1]||(n[0]||[])[f],E=k?k.Name:"SH33TJSNAME"+String(f);E&&"_xlfn."==E.slice(0,6)&&!a.xlfn&&(E=E.slice(6)),h.push(E);break;case"PtgNameX":var S,A=b[1][1];if(f=b[1][2],!(a.biff<=5)){var I="";if(14849==((n[A]||[])[0]||[])[0]||(1025==((n[A]||[])[0]||[])[0]?n[A][f]&&n[A][f].itab>0&&(I=n.SheetNames[n[A][f].itab-1]+"!"):I=n.SheetNames[f-1]+"!"),n[A]&&n[A][f])I+=n[A][f].Name;else if(n[0]&&n[0][f])I+=n[0][f].Name;else{var _=(ty(n,A,a)||"").split(";;");_[f-1]?I=_[f-1]:I+="SH33TJSERRX"}h.push(I);break}A<0&&(A=-A),n[A]&&(S=n[A][f]),S||(S={Name:"SH33TJSERRY"}),h.push(S.Name);break;case"PtgParen":var R="(",O=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:R=Ud(" ",e[0][g][1][1])+R;break;case 3:R=Ud("\r",e[0][g][1][1])+R;break;case 4:O=Ud(" ",e[0][g][1][1])+O;break;case 5:O=Ud("\r",e[0][g][1][1])+O;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}h.push(R+h.pop()+O);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":s={c:b[1][1],r:b[1][0]};var P={c:r.c,r:r.r};if(n.sharedf[Op(s)]){var N=n.sharedf[Op(s)];h.push(ny(N,u,P,n,a))}else{var x=!1;for(i=0;i!=n.arrayf.length;++i)if(o=n.arrayf[i],!(s.c<o[0].s.c||s.c>o[0].e.c)&&!(s.r<o[0].s.r||s.r>o[0].e.r)){h.push(ny(o[1],u,P,n,a)),x=!0;break}x||h.push(b[1])}break;case"PtgArray":h.push("{"+Zv(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var M=!0;switch((b=e[0][g])[1][0]){case 4:M=!1;case 0:m=Ud(" ",b[1][1]);break;case 5:M=!1;case 1:m=Ud("\r",b[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}h.push((M?m:"")+h.pop()+(M?"":m)),g=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return h[0]}function ay(e,t,r){var n,a=e.l+t,i=2==r.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],vp(e,t-2)];var s=Jv(e,o,r);return t!==o+i&&(n=Xv(e,t-o-i,s,r)),e.l=a,[s,n]}function iy(e,t,r){var n,a=e.l+t,i=e.read_shift(2),o=Jv(e,i,r);return 65535==i?[[],vp(e,t-2)]:(t!==i+2&&(n=Xv(e,a-i-2,o,r)),[o,n])}function oy(e,t,r){var n=e.l+t,a=Vg(e);2==r.biff&&++e.l;var i=function(e){var t;if(65535!==ip(e,e.l+6))return[Jp(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),o=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var s=function(e,t,r){var n,a=e.l+t,i=2==r.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],vp(e,t-2)];var s=Jv(e,o,r);return t!==o+i&&(n=Xv(e,t-o-i,s,r)),e.l=a,[s,n]}(e,n-e.l,r);return{cell:a,val:i[0],formula:s,shared:o>>3&1,tt:i[1]}}function sy(e,t,r){var n=e.read_shift(4),a=Jv(e,n,r),i=e.read_shift(4);return[a,i>0?Xv(e,i,a,r):null]}var cy=sy,ly=sy,uy=sy,hy=sy,dy={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},fy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},py={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gy(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function my(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var vy={},yy={};function by(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function wy(e,t,r,n,a,i){try{n.cellNF&&(e.z=Fh[t])}catch(Ww){if(n.WTF)throw Ww}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Ld(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==Fh[t]&&md(yd[t]||"General",t),"e"===e.t)e.w=e.w||cg[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Vh(e.v);else if("d"===e.t){var o=Ad(e.v);e.w=(0|o)===o?o.toString(10):Vh(o)}else{if(void 0===e.v)return"";e.w=Gh(e.v,yy)}else"d"===e.t?e.w=gd(t,Ad(e.v),yy):e.w=gd(t,e.v,yy)}catch(Ww){if(n.WTF)throw Ww}if(n.cellStyles&&null!=r)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ym(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ym(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(Ww){if(n.WTF&&i.Fills)throw Ww}}}var Ty=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Cy=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ky=/<(?:\w:)?hyperlink [^>]*>/gm,Ey=/"(\w*:\w*)"/,Sy=/<(?:\w:)?col\b[^>]*[\/]?>/g,Ay=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Iy=/<(?:\w:)?pageMargins[^>]*\/>/g,_y=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ry=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Oy=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Py(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var s=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",h=e.match(Cy);h?(l=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):l=u=e;var d=l.match(_y);d?Ny(d[0],s,a,r):(d=l.match(Ry))&&function(e,t,r,n,a){Ny(e.slice(0,e.indexOf(">")),r,n,a)}(d[0],d[1],s,a,r);var f=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=l.slice(f,f+50).match(Ey);p&&function(e,t){var r=xp(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Np(r))}(s,p[1])}var g=l.match(Oy);g&&g[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(xy)||[]).forEach((function(e,r){var n=sf(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),mf(n.rightToLeft)&&(t.Views[r].RTL=!0)}))}(g[1],a);var m=[];if(t.cellStyles){var v=l.match(Sy);v&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=sf(t[n],!0);a.hidden&&(a.hidden=mf(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,tv(a.width)),rv(a);i<=o;)e[i++]=Fd(a)}}(m,v)}h&&My(h[1],s,t,c,i,o);var y=u.match(Ay);y&&(s["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],w=u.match(Ty);if(w)for(f=0;f!=w.length;++f)b[f]=xp(w[f].slice(w[f].indexOf('"')+1));var T=u.match(ky);T&&function(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=sf(Tf(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+hf(i.location))):(i.Target="#"+hf(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var s=xp(i.ref),c=s.s.r;c<=s.e.r;++c)for(var l=s.s.c;l<=s.e.c;++l){var u=Op({c:l,r:c});n?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}(s,T,n);var C=u.match(Iy);if(C&&(s["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(r){e[r]&&(t[r]=parseFloat(e[r]))})),t}(sf(C[0]))),!s["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(s["!ref"]=Np(c)),t.sheetRows>0&&s["!ref"]){var k=xp(s["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),s["!fullref"]=s["!ref"],s["!ref"]=Np(k))}return m.length>0&&(s["!cols"]=m),b.length>0&&(s["!merges"]=b),s}function Ny(e,t,r,n){var a=sf(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=hf(Tf(a.codeName)))}var xy=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var My=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=kf("v"),o=kf("f");return function(s,c,l,u,h,d){for(var f,p,g,m,v,y=0,b="",w=[],T=[],C=0,k=0,E=0,S="",A=0,I=0,_=0,R=0,O=Array.isArray(d.CellXf),P=[],N=[],x=Array.isArray(c),M=[],L={},D=!1,F=!!l.sheetStubs,U=s.split(t),B=0,H=U.length;B!=H;++B){var z=(b=U[B].trim()).length;if(0!==z){var q=0;e:for(y=0;y<z;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(l&&l.cellStyles){if(A=null!=(p=sf(b.slice(q,y),!0)).r?parseInt(p.r,10):A+1,I=-1,l.sheetRows&&l.sheetRows<A)continue;L={},D=!1,p.ht&&(D=!0,L.hpt=parseFloat(p.ht),L.hpx=iv(L.hpt)),"1"==p.hidden&&(D=!0,L.hidden=!0),null!=p.outlineLevel&&(D=!0,L.level=+p.outlineLevel),D&&(M[A-1]=L)}break;case"<":q=y}if(q>=y)break;if(A=null!=(p=sf(b.slice(q,y),!0)).r?parseInt(p.r,10):A+1,I=-1,!(l.sheetRows&&l.sheetRows<A)){u.s.r>A-1&&(u.s.r=A-1),u.e.r<A-1&&(u.e.r=A-1),l&&l.cellStyles&&(L={},D=!1,p.ht&&(D=!0,L.hpt=parseFloat(p.ht),L.hpx=iv(L.hpt)),"1"==p.hidden&&(D=!0,L.hidden=!0),null!=p.outlineLevel&&(D=!0,L.level=+p.outlineLevel),D&&(M[A-1]=L)),w=b.slice(y).split(e);for(var $=0;$!=w.length&&"<"==w[$].trim().charAt(0);++$);for(w=w.slice($),y=0;y!=w.length;++y)if(0!==(b=w[y].trim()).length){if(T=b.match(r),C=y,k=0,E=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=T&&2===T.length){for(C=0,S=T[1],k=0;k!=S.length&&!((E=S.charCodeAt(k)-64)<1||E>26);++k)C=26*C+E;I=--C}else++I;for(k=0;k!=b.length&&62!==b.charCodeAt(k);++k);if(++k,(p=sf(b.slice(0,k),!0)).r||(p.r=Op({r:A-1,c:I})),f={t:""},null!=(T=(S=b.slice(k)).match(i))&&""!==T[1]&&(f.v=hf(T[1])),l.cellFormula){if(null!=(T=S.match(o))&&""!==T[1]){if(f.f=hf(Tf(T[1])).replace(/\r\n/g,"\n"),l.xlfn||(f.f=Pv(f.f)),T[0].indexOf('t="array"')>-1)f.F=(S.match(a)||[])[1],f.F.indexOf(":")>-1&&P.push([xp(f.F),f.F]);else if(T[0].indexOf('t="shared"')>-1){m=sf(T[0]);var K=hf(Tf(T[1]));l.xlfn||(K=Pv(K)),N[parseInt(m.si,10)]=[m,K,p.r]}}else(T=S.match(/<f[^>]*\/>/))&&N[(m=sf(T[0])).si]&&(f.f=Ov(N[m.si][1],N[m.si][2],p.r));var W=Rp(p.r);for(k=0;k<P.length;++k)W.r>=P[k][0].s.r&&W.r<=P[k][0].e.r&&W.c>=P[k][0].s.c&&W.c<=P[k][0].e.c&&(f.F=P[k][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!F)continue;f.t="z"}else f.t=p.t||"n";switch(u.s.c>I&&(u.s.c=I),u.e.c<I&&(u.e.c=I),f.t){case"n":if(""==f.v||null==f.v){if(!F)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!F)continue;f.t="z"}else g=vy[parseInt(f.v,10)],f.v=g.t,f.r=g.r,l.cellHTML&&(f.h=g.h);break;case"str":f.t="s",f.v=null!=f.v?Tf(f.v):"",l.cellHTML&&(f.h=pf(f.v));break;case"inlineStr":T=S.match(n),f.t="s",null!=T&&(g=Om(T[1]))?(f.v=g.t,l.cellHTML&&(f.h=g.h)):f.v="";break;case"b":f.v=mf(f.v);break;case"d":l.cellDates?f.v=Ld(f.v,1):(f.v=Ad(Ld(f.v,1)),f.t="n");break;case"e":l&&!1===l.cellText||(f.w=f.v),f.v=lg[f.v]}if(_=R=0,v=null,O&&void 0!==p.s&&null!=(v=d.CellXf[p.s])&&(null!=v.numFmtId&&(_=v.numFmtId),l.cellStyles&&null!=v.fillId&&(R=v.fillId)),wy(f,_,R,l,h,d),l.cellDates&&O&&"n"==f.t&&hd(Fh[_])&&(f.t="d",f.v=Od(f.v)),p.cm&&l.xlmeta){var j=(l.xlmeta.Cell||[])[+p.cm-1];j&&"XLDAPR"==j.type&&(f.D=!0)}if(x){var V=Rp(p.r);c[V.r]||(c[V.r]=[]),c[V.r][V.c]=f}else c[p.r]=f}}}}M.length>0&&(c["!rows"]=M)}}();var Ly=Xp;function Dy(e){return[Kp(e),Jp(e),"n"]}var Fy=Xp;var Uy=["left","right","top","bottom","header","footer"];function By(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var s=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])}));var a=hf((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[r,a,t]}(e);u.s.r=u.s.c=0,u.e.c=s,l=_p(s),t[0].forEach((function(e,r){o[l+Ap(r)]={t:"n",v:e,z:t[1]},c=r})),u.e.r<c&&(u.e.r=c),++s})),s>0&&(o["!ref"]=Np(u)),o}var Hy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],zy=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],qy=[],$y=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ky(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(null==n[i[0]])n[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof n[i[0]]&&(n[i[0]]=mf(n[i[0]]));break;case"int":"string"==typeof n[i[0]]&&(n[i[0]]=parseInt(n[i[0]],10))}}}function Wy(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=mf(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function jy(e){Wy(e.WBProps,Hy),Wy(e.CalcPr,$y),Ky(e.WBView,zy),Ky(e.Sheets,qy),yy.date1904=mf(e.WBProps.date1904)}var Vy="][*?/\\".split("");function Gy(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return Vy.forEach((function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}})),r}var Yy=/<\w+:workbook/;function Qy(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Xy(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Ib[16]={n:"BrtFRTArchID$",f:Qy},bp(e,(function(e,s,c){switch(c){case 156:o.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=ny(e.Ptg,0,null,o,t),delete t.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:o[0].length?o.push([c,e]):o[0]=[c,e],o[o.length-1].XTI=[];break;case 362:0===o.length&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(e),o.XTI=o.XTI.concat(e);break;case 35:case 37:n.push(c),a=!0;break;case 36:case 38:n.pop(),a=!1;break;default:if(s.T);else if(!a||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+c.toString(16))}}),t),jy(r),r.Names=i,r.supbooks=o,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(nf,(function(s,c){var l=sf(s);switch(cf(l[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":s.match(Yy)&&(a="xmlns"+s.match(/<(\w+):/)[1]),r.xmlns=l[a];break;case"<fileVersion":delete l[0],r.AppVersion=l;break;case"<workbookPr":case"<workbookPr/>":Hy.forEach((function(e){if(null!=l[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=mf(l[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(l[e[0]],10);break;default:r.WBProps[e[0]]=l[e[0]]}})),l.codeName&&(r.WBProps.CodeName=Tf(l.codeName));break;case"<workbookView":case"<workbookView/>":delete l[0],r.WBView.push(l);break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=hf(Tf(l.name)),delete l[0],r.Sheets.push(l);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(i={}).Name=Tf(l.name),l.comment&&(i.Comment=l.comment),l.localSheetId&&(i.Sheet=+l.localSheetId),mf(l.hidden||"0")&&(i.Hidden=!0),o=c+s.length;break;case"</definedName>":i.Ref=hf(Tf(e.slice(o,c))),r.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete l[0],r.CalcPr=l;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return s})),-1===Lf.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return jy(r),r}(e,r)}function Jy(e,t,r,n,a,i,o,s){return".bin"===t.slice(-4)?function(e,t,r,n,a,i,o){if(!e)return e;var s=t||{};n||(n={"!id":{}});var c,l,u,h,d,f,p,g,m,v,y=s.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],T=!1,C=!1,k=[];s.biff=12,s["!row"]=0;var E=0,S=!1,A=[],I={},_=s.supbooks||a.supbooks||[[]];if(_.sharedf=I,_.arrayf=A,_.SheetNames=a.SheetNames||a.Sheets.map((function(e){return e.name})),!s.supbooks&&(s.supbooks=_,a.Names))for(var R=0;R<a.Names.length;++R)_[0][R+1]=a.Names[R];var O,P,N=[],x=[],M=!1;if(Ib[16]={n:"BrtShortReal",f:Dy},bp(e,(function(e,t,R){if(!C)switch(R){case 148:c=e;break;case 0:l=e,s.sheetRows&&s.sheetRows<=l.r&&(C=!0),m=Ap(d=l.r),s["!row"]=l.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=iv(e.hpt)),x[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":g=vy[e[1]],u.v=g.t,u.r=g.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==s.cellText&&(u.w=cg[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((h=o.CellXf[e[0].iStyleRef])&&wy(u,h.numFmtId,null,s,i,o),f=-1==e[0].c?f+1:e[0].c,s.dense?(y[d]||(y[d]=[]),y[d][f]=u):y[_p(f)+m]=u,s.cellFormula){for(S=!1,E=0;E<A.length;++E){var L=A[E];l.r>=L[0].s.r&&l.r<=L[0].e.r&&f>=L[0].s.c&&f<=L[0].e.c&&(u.F=Np(L[0]),S=!0)}!S&&e.length>3&&(u.f=e[3])}if(b.s.r>l.r&&(b.s.r=l.r),b.s.c>f&&(b.s.c=f),b.e.r<l.r&&(b.e.r=l.r),b.e.c<f&&(b.e.c=f),s.cellDates&&h&&"n"==u.t&&hd(Fh[h.numFmtId])){var D=zh(u.v);D&&(u.t="d",u.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}O&&("XLDAPR"==O.type&&(u.D=!0),O=void 0),P&&(P=void 0);break;case 1:case 12:if(!s.sheetStubs||T)break;u={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,s.dense?(y[d]||(y[d]=[]),y[d][f]=u):y[_p(f)+m]=u,b.s.r>l.r&&(b.s.r=l.r),b.s.c>f&&(b.s.c=f),b.e.r<l.r&&(b.e.r=l.r),b.e.c<f&&(b.e.c=f),O&&("XLDAPR"==O.type&&(u.D=!0),O=void 0),P&&(P=void 0);break;case 176:k.push(e);break;case 49:O=((s.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=n["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),d=e.rfx.s.r;d<=e.rfx.e.r;++d)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)s.dense?(y[d]||(y[d]=[]),y[d][f]||(y[d][f]={t:"z",v:void 0}),y[d][f].l=e):(p=Op({c:f,r:d}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=e);break;case 426:if(!s.cellFormula)break;A.push(e),(v=s.dense?y[d][f]:y[_p(f)+m]).f=ny(e[1],0,{r:l.r,c:f},_,s),v.F=Np(e[0]);break;case 427:if(!s.cellFormula)break;I[Op(e[0].s)]=e[1],(v=s.dense?y[d][f]:y[_p(f)+m]).f=ny(e[1],0,{r:l.r,c:f},_,s);break;case 60:if(!s.cellStyles)break;for(;e.e>=e.s;)N[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},M||(M=!0,tv(e.w/256)),rv(N[e.e+1]);break;case 161:y["!autofilter"]={ref:Np(e)};break;case 476:y["!margins"]=e;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:T=!0;break;case 36:T=!1;break;case 37:w.push(R),T=!0;break;case 38:w.pop(),T=!1;break;default:if(t.T);else if(!T||s.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}),s),delete s.supbooks,delete s["!row"],!y["!ref"]&&(b.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(y["!ref"]=Np(c||b)),s.sheetRows&&y["!ref"]){var L=xp(y["!ref"]);s.sheetRows<=+L.e.r&&(L.e.r=s.sheetRows-1,L.e.r>b.e.r&&(L.e.r=b.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>b.e.c&&(L.e.c=b.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),y["!fullref"]=y["!ref"],y["!ref"]=Np(L))}return k.length>0&&(y["!merges"]=k),N.length>0&&(y["!cols"]=N),x.length>0&&(y["!rows"]=x),y}(e,n,r,a,i,o,s):Py(e,n,r,a,i,o,s)}function Zy(e,t,r,n,a,i,o,s){return".bin"===t.slice(-4)?function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=[],s=!1;return bp(e,(function(e,n,c){switch(c){case 550:i["!rel"]=e;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(c);break;case 38:o.pop();break;default:if(n.T>0)o.push(c);else if(n.T<0)o.pop();else if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}(e,n,r,a,i):function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i,o={"!type":"chart","!drawel":null,"!rel":""},s=e.match(_y);return s&&Ny(s[0],0,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=i[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}(e,0,r,a,i)}function eb(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var a in Fh)n.NumberFmt[a]=Fh[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return bp(e,(function(e,a,s){switch(s){case 44:n.NumberFmt[e[0]]=e[1],md(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=Ym(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&n.CellXf.push(e);break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(s),o=!0;break;case 38:i.pop(),o=!1;break;default:if(a.T>0)i.push(s);else if(a.T<0)i.pop();else if(!o||r.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+s.toString(16))}})),n}(e,r,n):lv(e,r,n)}function tb(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return bp(e,(function(e,a,i){switch(i){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}})),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var a=e.match(Pm);if(a){n=a[2].replace(Nm,"").split(xm);for(var i=0;i!=n.length;++i){var o=Om(n[i].trim(),t);null!=o&&(r[r.length]=o)}a=sf(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}(e,r)}function rb(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],a={},i=!1;return bp(e,(function(e,o,s){switch(s){case 632:n.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(o.T);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}}));var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var i=sf(a[0]),o={author:i.authorId&&r[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},s=Rp(i.ref);if(!(t.sheetRows&&t.sheetRows<=s.r)){var c=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),l=!!c&&!!c[1]&&Om(c[1])||{r:"",t:"",h:""};o.r=l.r,"<t></t>"==l.r&&(l.t=l.h=""),o.t=(l.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(o.h=l.h),n.push(o)}}}})),n}(e,r)}function nb(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return bp(e,(function(e,r,n){if(63===n)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+n.toString(16))})),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(nf)||[]).forEach((function(e){var n=sf(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}})),t}(e)}function ab(e,t,r,n){if(".bin"===r.slice(-4))return function(e,t,r,n){if(!e)return e;var a=n||{},i=!1;bp(e,(function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||a.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}}),a)}(e,0,0,n)}function ib(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,s=2;return bp(e,(function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==s?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==s&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})}));break;case 337:s=e?1:0;break;case 338:s=2;break;case 35:i.push(r),o=!0;break;case 36:i.pop(),o=!1;break;default:if(t.T);else if(!o||a.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}})),n}(e,0,r):function(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a,i=!1,o=2;return e.replace(nf,(function(e){var t=sf(e);switch(cf(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var s=0;s<n.Types.length;++s)n.Types[s].name==t.name&&(a=n.Types[s]);break;case"<rc":1==o?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==o&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":o=1;break;case"</cellMetadata>":case"</valueMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),n}(e,0,r)}var ob,sb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function lb(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var a,i,o,s=e.match(sb);if(s)for(o=0;o!=s.length;++o)-1===(i=(a=s[o].match(cb))[1].indexOf(":"))?n[a[1]]=a[2].slice(1,a[2].length-1):n["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(i+1)]=a[2].slice(1,a[2].length-1);return n}function ub(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,a,i=e.match(sb);if(i)for(a=0;a!=i.length;++a)-1===(n=(r=i[a].match(cb))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function hb(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=mf(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ld(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[hf(t)]=a}function db(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||cg[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Vh(e.v):e.w=Gh(e.v):e.w=function(e,t){var r=ob[e]||hf(e);return"General"===r?Gh(t):gd(r,t)}(t||"General",e.v)}catch(Ww){if(r.WTF)throw Ww}try{var n=ob[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&"n"==e.t&&hd(n)){var a=zh(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(Ww){if(r.WTF)throw Ww}}}function fb(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=ov[n.Pattern]||n.Pattern)}e[t.ID]=t}function pb(e,t,r,n,a,i,o,s,c,l){var u="General",h=n.StyleID,d={};l=l||{};var f=[],p=0;for(void 0===h&&s&&(h=s.StyleID),void 0===h&&o&&(h=o.StyleID);void 0!==i[h]&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&f.push(i[h].Interior),i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=mf(e);break;case"String":n.t="s",n.r=gf(hf(e)),n.v=e.indexOf("<")>-1?hf(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(Ld(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!==n.v?n.v=hf(e):n.v<60&&(n.v=n.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=lg[e],!1!==l.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=gf(t||e))}if(db(n,u,l),!1!==l.cellFormula)if(n.Formula){var g=hf(n.Formula);61==g.charCodeAt(0)&&(g=g.slice(1)),n.f=Av(g,a),delete n.Formula,"RC"==n.ArrayRange?n.F=Av("RC:RC",a):n.ArrayRange&&(n.F=Av(n.ArrayRange,a),c.push([xp(n.F),n.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(n.F=c[p][1]);l.cellStyles&&(f.forEach((function(e){!d.patternType&&e.patternType&&(d.patternType=e.patternType)})),n.s=d),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function gb(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function mb(e,t){var r=t||{};vd();var n=dh(Nf(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n="undefined"!==typeof hh?hh.utils.decode(65001,lh(n)):Tf(n));var a,i=n.slice(0,1024).toLowerCase(),o=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var s=Fd(r);return s.type="string",km.to_workbook(n,s)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){i.indexOf("<"+e)>=0&&(o=!0)})),o)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return Dp(Ob(r[0],t),t);var n={SheetNames:[],Sheets:{}};return r.forEach((function(e,r){_w(n,Ob(e,t),"Sheet"+(r+1))})),n}(n,r);ob={"General Number":"General","General Date":Fh[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Fh[15],"Short Date":Fh[14],"Long Time":Fh[19],"Medium Time":Fh[18],"Short Time":Fh[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Fh[2],Standard:Fh[4],Percent:Fh[10],Scientific:Fh[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[];var u,h={},d=[],f=r.dense?[]:{},p="",g={},m={},v=lb('<Data ss:Type="String">'),y=0,b=0,w=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},k={},E="",S=0,A=[],I={},_={},R=0,O=[],P=[],N={},x=[],M=!1,L=[],D=[],F={},U=0,B=0,H={Sheets:[],WBProps:{date1904:!1}},z={};xf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var q="";a=xf.exec(n);)switch(a[3]=(q=a[3]).toLowerCase()){case"data":if("data"==q){if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;"/"===a[1]?pb(n.slice(y,a.index),E,v,"comment"==l[l.length-1][0]?N:g,{c:b,r:w},C,x[b],m,L,r):(E="",v=lb(a[0]),y=a.index+a[0].length);break;case"cell":if("/"===a[1])if(P.length>0&&(g.c=P),(!r.sheetRows||r.sheetRows>w)&&void 0!==g.v&&(r.dense?(f[w]||(f[w]=[]),f[w][b]=g):f[_p(b)+Ap(w)]=g),g.HRef&&(g.l={Target:hf(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(U=b+(0|parseInt(g.MergeAcross,10)),B=w+(0|parseInt(g.MergeDown,10)),A.push({s:{c:b,r:w},e:{c:U,r:B}})),r.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var $=b;$<=U;++$)for(var K=w;K<=B;++K)($>b||K>w)&&(r.dense?(f[K]||(f[K]=[]),f[K][$]={t:"z"}):f[_p($)+Ap(K)]={t:"z"});b=U+1}else++b;else g.MergeAcross?b=U+1:++b;else(g=ub(a[0])).Index&&(b=+g.Index-1),b<T.s.c&&(T.s.c=b),b>T.e.c&&(T.e.c=b),"/>"===a[0].slice(-2)&&++b,P=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(w<T.s.r&&(T.s.r=w),w>T.e.r&&(T.e.r=w),"/>"===a[0].slice(-2)&&(m=lb(a[0])).Index&&(w=+m.Index-1),b=0,++w):((m=lb(a[0])).Index&&(w=+m.Index-1),F={},("0"==m.AutoFitHeight||m.Height)&&(F.hpx=parseInt(m.Height,10),F.hpt=av(F.hpx),D[w]=F),"1"==m.Hidden&&(F.hidden=!0,D[w]=F));break;case"worksheet":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));d.push(p),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(f["!ref"]=Np(T),r.sheetRows&&r.sheetRows<=T.e.r&&(f["!fullref"]=f["!ref"],T.e.r=r.sheetRows-1,f["!ref"]=Np(T))),A.length&&(f["!merges"]=A),x.length>0&&(f["!cols"]=x),D.length>0&&(f["!rows"]=D),h[p]=f}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,l.push([a[3],!1]),c=lb(a[0]),p=hf(c.Name),f=r.dense?[]:{},A=[],L=[],D=[],z={name:p,Hidden:0},H.Sheets.push(z);break;case"table":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if("/>"==a[0].slice(-2))break;l.push([a[3],!1]),x=[],M=!1}break;case"style":"/"===a[1]?fb(C,k,r):k=lb(a[0]);break;case"numberformat":k.nf=hf(lb(a[0]).Format||"General"),ob[k.nf]&&(k.nf=ob[k.nf]);for(var W=0;392!=W&&Fh[W]!=k.nf;++W);if(392==W)for(W=57;392!=W;++W)if(null==Fh[W]){md(k.nf,W);break}break;case"column":if("table"!==l[l.length-1][0])break;if((u=lb(a[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!M&&u.wpx>10){M=!0,Qm=6;for(var j=0;j<x.length;++j)x[j]&&rv(x[j])}M&&rv(u),x[u.Index-1||x.length]=u;for(var V=0;V<+u.Span;++V)x[x.length]=Fd(u);break;case"namedrange":if("/"===a[1])break;H.Names||(H.Names=[]);var G=sf(a[0]),Y={Name:G.Name,Ref:Av(G.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(Y.Sheet=H.Sheets.length-1),H.Names.push(Y);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?E+=n.slice(S,a.index):S=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=lb(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?Cg(I,q,n.slice(R,a.index)):R=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));gb(N),P.push(N)}else l.push([a[3],!1]),N={a:(c=lb(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var Q=lb(a[0]);f["!autofilter"]={ref:Av(Q.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;default:if(0==l.length&&"document"==a[3])return $b(n,r);if(0==l.length&&"uof"==a[3])return $b(n,r);var X=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:X=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:X=!1}break;case"excelworkbook":switch(a[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:X=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:X=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(n.slice(R,a.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2}else R=a.index+a[0].length;break;case"header":f["!margins"]||by(f["!margins"]={},"xlml"),isNaN(+sf(a[0]).Margin)||(f["!margins"].header=+sf(a[0]).Margin);break;case"footer":f["!margins"]||by(f["!margins"]={},"xlml"),isNaN(+sf(a[0]).Margin)||(f["!margins"].footer=+sf(a[0]).Margin);break;case"pagemargins":var J=sf(a[0]);f["!margins"]||by(f["!margins"]={},"xlml"),isNaN(+J.Top)||(f["!margins"].top=+J.Top),isNaN(+J.Left)||(f["!margins"].left=+J.Left),isNaN(+J.Right)||(f["!margins"].right=+J.Right),isNaN(+J.Bottom)||(f["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:X=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:X=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:X=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:X=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:X=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:X=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:X=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:X=!1}break;case"smarttags":break;default:X=!1}if(X)break;if(a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if("customdocumentproperties"===l[l.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?hb(_,q,O,n.slice(R,a.index)):(O=a,R=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=h),Z.SheetNames=d,Z.Workbook=H,Z.SSF=Fd(Fh),Z.Props=I,Z.Custprops=_,Z}function vb(e,t){switch(uw(t=t||{}),t.type||"base64"){case"base64":return mb(vh(e),t);case"binary":case"buffer":case"file":return mb(e,t);case"array":return mb(kh(e),t)}}function yb(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return Zp(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return Zp(e,2)}(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var bb=[60,1084,2066,2165,2175];function wb(e,t,r,n,a){var i=n,o=[],s=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(s)}o.push(s),r.l+=i;for(var c=ip(r,r.l),l=_b[c],u=0;null!=l&&bb.indexOf(c)>-1;)i=ip(r,r.l+2),u=r.l+4,2066==c?u+=4:2165!=c&&2175!=c||(u+=12),s=r.slice(u,r.l+4+i),o.push(s),r.l+=4+i,l=_b[c=ip(r,r.l)];var h=Sh(o);mp(h,0);var d=0;h.lens=[];for(var f=0;f<o.length;++f)h.lens.push(d),d+=o[f].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function Tb(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Fh[n])}catch(Ww){if(t.WTF)throw Ww}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||cg[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Vh(e.v):e.w=Gh(e.v):e.w=gd(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(Ww){if(t.WTF)throw Ww}if(t.cellDates&&n&&"n"==e.t&&hd(Fh[n]||String(n))){var a=zh(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Cb(e,t,r){return{v:e,ixfe:t,t:r}}function kb(e,t){var r={opts:{}},n={};var a,i,o,s,c,l,u,h,d=t.dense?[]:{},f={},p={},g=null,m=[],v="",y={},b="",w={},T=[],C=[],k=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},A=function(e){return e<8?sg[e]:e<64&&k[e-8]||sg[e]},I=function(e,t,r){if(!(F>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,a=t.XF.data;a&&a.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=a.patternType,(n=Gm(A(a.icvFore)))&&(t.s.fgColor={rgb:n}),(n=Gm(A(a.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,r),delete t.ixfe,delete t.XF,a=e,b=Op(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<T.length;++n)if(!(T[n][0].s.c>e.c||T[n][0].s.r>e.r)&&!(T[n][0].e.c<e.c||T[n][0].e.r<e.r)){t.F=Np(T[n][0]),T[n][0].s.c==e.c&&T[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+ny(T[n][1],0,e,M,_));break}r.dense?(d[e.r]||(d[e.r]=[]),d[e.r][e.c]=t):d[b]=t}},_={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(_.password=t.password);var R=[],O=[],P=[],N=[],x=!1,M=[];M.SheetNames=_.snames,M.sharedf=_.sharedf,M.arrayf=_.arrayf,M.names=[],M.XTI=[];var L,D=0,F=0,U=0,B=[],H=[];_.codepage=1200,sh(1200);for(var z=!1;e.l<e.length-1;){var q=e.l,$=e.read_shift(2);if(0===$&&10===D)break;var K=e.l===e.length?0:e.read_shift(2),W=_b[$];if(W&&W.f){if(t.bookSheets&&133===D&&133!==$)break;if(D=$,2===W.r||12==W.r){var j=e.read_shift(2);if(K-=2,!_.enc&&j!==$&&((255&j)<<8|j>>8)!==$)throw new Error("rt mismatch: "+j+"!="+$);12==W.r&&(e.l+=10,K-=10)}var V={};if(V=10===$?W.f(e,K,_):wb($,W,e,K,_),0==F&&-1===[9,521,1033,2057].indexOf(D))continue;switch($){case 34:r.opts.Date1904=E.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=V,!t.password)throw new Error("File is password-protected");if(null==V.valid)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=V;break;case 66:var G=Number(V);switch(G){case 21010:G=1200;break;case 32768:G=1e4;break;case 32769:G=1252}sh(_.codepage=G),z=!0;break;case 317:_.rrtabid=V;break;case 25:_.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:_.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(d["!type"]="dialog"),V.fBelow||((d["!outline"]||(d["!outline"]={})).above=!0),V.fRight||((d["!outline"]||(d["!outline"]={})).left=!0);break;case 224:C.push(V);break;case 430:M.push([V]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(V);break;case 24:case 536:L={Name:V.Name,Ref:ny(V.rgce,0,null,M,_)},V.itab>0&&(L.Sheet=V.itab-1),M.names.push(L),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(V),"_xlnm._FilterDatabase"==V.Name&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&"PtgArea3d"==V.rgce[0][0][0]&&(H[V.itab-1]={ref:Np(V.rgce[0][0][1][2])});break;case 22:_.ExternCount=V;break;case 23:0==M.length&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(V),M.XTI=M.XTI.concat(V);break;case 2196:if(_.biff<8)break;null!=L&&(L.Comment=V[1]);break;case 18:d["!protect"]=V;break;case 19:0!==V&&_.WTF&&console.error("Password verifier: "+V);break;case 133:f[V.pos]=V,_.snames.push(V.name);break;case 10:if(--F)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,d["!ref"]=Np(p),t.sheetRows&&t.sheetRows<=p.e.r){var Y=p.e.r;p.e.r=t.sheetRows-1,d["!fullref"]=d["!ref"],d["!ref"]=Np(p),p.e.r=Y}p.e.r++,p.e.c++}R.length>0&&(d["!merges"]=R),O.length>0&&(d["!objects"]=O),P.length>0&&(d["!cols"]=P),N.length>0&&(d["!rows"]=N),E.Sheets.push(S)}""===v?y=d:n[v]=d,d=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===_.biff&&(_.biff={9:2,521:3,1033:4}[$]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),_.biffguess=0==V.BIFFVer,0==V.BIFFVer&&4096==V.dt&&(_.biff=5,z=!0,sh(_.codepage=28591)),8==_.biff&&0==V.BIFFVer&&16==V.dt&&(_.biff=2),F++)break;if(d=t.dense?[]:{},_.biff<8&&!z&&(z=!0,sh(_.codepage=t.codepage||1252)),_.biff<5||0==V.BIFFVer&&4096==V.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var Q={pos:e.l-K,name:v};f[Q.pos]=Q,_.snames.push(v)}else v=(f[q]||{name:""}).name;32==V.dt&&(d["!type"]="chart"),64==V.dt&&(d["!type"]="macro"),R=[],O=[],_.arrayf=T=[],P=[],N=[],x=!1,S={Hidden:(f[q]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==d["!type"]&&(t.dense?(d[V.r]||[])[V.c]:d[Op({c:V.c,r:V.r})])&&++V.c,l={ixfe:V.ixfe,XF:C[V.ixfe]||{},v:V.val,t:"n"},U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I({c:V.c,r:V.r},l,t);break;case 5:case 517:l={ixfe:V.ixfe,XF:C[V.ixfe],v:V.val,t:V.t},U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I({c:V.c,r:V.r},l,t);break;case 638:l={ixfe:V.ixfe,XF:C[V.ixfe],v:V.rknum,t:"n"},U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I({c:V.c,r:V.r},l,t);break;case 189:for(var X=V.c;X<=V.C;++X){var J=V.rkrec[X-V.c][0];l={ixfe:J,XF:C[J],v:V.rkrec[X-V.c][1],t:"n"},U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I({c:X,r:V.r},l,t)}break;case 6:case 518:case 1030:if("String"==V.val){g=V;break}if((l=Cb(V.val,V.cell.ixfe,V.tt)).XF=C[l.ixfe],t.cellFormula){var Z=V.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],re=Op({r:ee,c:te});w[re]?l.f=""+ny(V.formula,0,V.cell,M,_):l.F=((t.dense?(d[ee]||[])[te]:d[re])||{}).F}else l.f=""+ny(V.formula,0,V.cell,M,_)}U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I(V.cell,l,t),g=V;break;case 7:case 519:if(!g)throw new Error("String record expects Formula");g.val=V,(l=Cb(V,g.cell.ixfe,"s")).XF=C[l.ixfe],t.cellFormula&&(l.f=""+ny(g.formula,0,g.cell,M,_)),U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I(g.cell,l,t),g=null;break;case 33:case 545:T.push(V);var ne=Op(V[0].s);if(i=t.dense?(d[V[0].s.r]||[])[V[0].s.c]:d[ne],t.cellFormula&&i){if(!g)break;if(!ne||!i)break;i.f=""+ny(V[1],0,V[0],M,_),i.F=Np(V[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!g)break;w[Op(g.cell)]=V[0],((i=t.dense?(d[g.cell.r]||[])[g.cell.c]:d[Op(g.cell)])||{}).f=""+ny(V[0],0,a,M,_)}break;case 253:l=Cb(m[V.isst].t,V.ixfe,"s"),m[V.isst].h&&(l.h=m[V.isst].h),l.XF=C[l.ixfe],U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I({c:V.c,r:V.r},l,t);break;case 513:t.sheetStubs&&(l={ixfe:V.ixfe,XF:C[V.ixfe],t:"z"},U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I({c:V.c,r:V.r},l,t));break;case 190:if(t.sheetStubs)for(var ae=V.c;ae<=V.C;++ae){var ie=V.ixfe[ae-V.c];l={ixfe:ie,XF:C[ie],t:"z"},U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I({c:ae,r:V.r},l,t)}break;case 214:case 516:case 4:(l=Cb(V.val,V.ixfe,"s")).XF=C[l.ixfe],U>0&&(l.z=B[l.ixfe>>8&63]),Tb(l,t,r.opts.Date1904),I({c:V.c,r:V.r},l,t);break;case 0:case 512:1===F&&(p=V);break;case 252:m=V;break;case 1054:if(4==_.biff){B[U++]=V[1];for(var oe=0;oe<U+163&&Fh[oe]!=V[1];++oe);oe>=163&&md(V[1],U+163)}else md(V[1],V[0]);break;case 30:B[U++]=V;for(var se=0;se<U+163&&Fh[se]!=V;++se);se>=163&&md(V,U+163);break;case 229:R=R.concat(V);break;case 93:O[V.cmo[0]]=_.lastobj=V;break;case 438:_.lastobj.TxO=V;break;case 127:_.lastobj.ImData=V;break;case 440:for(c=V[0].s.r;c<=V[0].e.r;++c)for(s=V[0].s.c;s<=V[0].e.c;++s)(i=t.dense?(d[c]||[])[s]:d[Op({c:s,r:c})])&&(i.l=V[1]);break;case 2048:for(c=V[0].s.r;c<=V[0].e.r;++c)for(s=V[0].s.c;s<=V[0].e.c;++s)(i=t.dense?(d[c]||[])[s]:d[Op({c:s,r:c})])&&i.l&&(i.l.Tooltip=V[1]);break;case 28:if(_.biff<=5&&_.biff>=2)break;i=t.dense?(d[V[0].r]||[])[V[0].c]:d[Op(V[0])];var ce=O[V[2]];i||(t.dense?(d[V[0].r]||(d[V[0].r]=[]),i=d[V[0].r][V[0].c]={t:"z"}):i=d[Op(V[0])]={t:"z"},p.e.r=Math.max(p.e.r,V[0].r),p.s.r=Math.min(p.s.r,V[0].r),p.e.c=Math.max(p.e.c,V[0].c),p.s.c=Math.min(p.s.c,V[0].c)),i.c||(i.c=[]),o={a:V[1],t:ce.TxO.t},i.c.push(o);break;case 2173:C[V.ixfe],V.ext.forEach((function(e){e[0]}));break;case 125:if(!_.cellStyles)break;for(;V.e>=V.s;)P[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(1&V.flags)},x||(x=!0,tv(V.w/256)),rv(P[V.e+1]);break;case 520:var le={};null!=V.level&&(N[V.r]=le,le.level=V.level),V.hidden&&(N[V.r]=le,le.hidden=!0),V.hpt&&(N[V.r]=le,le.hpt=V.hpt,le.hpx=iv(V.hpt));break;case 38:case 39:case 40:case 41:d["!margins"]||by(d["!margins"]={}),d["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[$]]=V;break;case 161:d["!margins"]||by(d["!margins"]={}),d["!margins"].header=V.header,d["!margins"].footer=V.footer;break;case 574:V.RTL&&(E.Views[0].RTL=!0);break;case 146:k=V;break;case 2198:h=V;break;case 140:u=V;break;case 442:v?S.CodeName=V||S.name:E.WBProps.CodeName=V||"ThisWorkbook"}}else W||console.error("Missing Info for XLS Record 0x"+$.toString(16)),e.l+=K}return r.SheetNames=kd(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&y["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=y)):r.Preamble=y,r.Sheets&&H.forEach((function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e})),r.Strings=m,r.SSF=Fd(Fh),_.enc&&(r.Encryption=_.enc),h&&(r.Themes=h),r.Metadata={},void 0!==u&&(r.Metadata.Country=u),M.names.length>0&&(E.Names=M.names),r.Workbook=E,r}var Eb="e0859ff2f94f6810ab9108002b27b3d9",Sb="02d5cdd59c2e1b10939708002b2cf9ae";function Ab(e,t){var r,n,a,i;if(t||(t={}),uw(t),ch(),t.codepage&&oh(t.codepage),e.FullPaths){if(Td.find(e,"/encryption"))throw new Error("File is password-protected");r=Td.find(e,"!CompObj"),n=Td.find(e,"/Workbook")||Td.find(e,"/Book")}else{switch(t.type){case"base64":e=Ch(vh(e));break;case"binary":e=Ch(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}mp(e,0),n={content:e}}if(r&&yb(r),t.bookProps&&!t.bookSheets)a={};else{var o=yh?"buffer":"array";if(n&&n.content)a=kb(n.content,t);else if((i=Td.find(e,"PerfectOffice_MAIN"))&&i.content)a=Em.to_workbook(i.content,(t.type=o,t));else{if(!(i=Td.find(e,"NativeContent_MAIN"))||!i.content)throw(i=Td.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=Em.to_workbook(i.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&Td.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=Td.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Td.utils.cfb_add(t,a,e.FileIndex[n].content)}})),Td.write(t)}(e))}var s={};return e.FullPaths&&function(e,t,r){var n=Td.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=xg(n,rg,Sb);for(var i in a)t[i]=a[i]}catch(Ww){if(r.WTF)throw Ww}var o=Td.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var s=xg(o,ng,Eb);for(var c in s)null==t[c]&&(t[c]=s[c])}catch(Ww){if(r.WTF)throw Ww}t.HeadingPairs&&t.TitlesOfParts&&(yg(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,s,t),a.Props=a.Custprops=s,t.bookFiles&&(a.cfb=e),a}var Ib={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,7&i&&(r.level=7&i),16&i&&(r.hidden=!0),32&i&&(r.hpt=a/20),r}},1:{f:function(e){return[$p(e)]}},2:{f:function(e){return[$p(e),Yp(e),"n"]}},3:{f:function(e){return[$p(e),e.read_shift(1),"e"]}},4:{f:function(e){return[$p(e),e.read_shift(1),"b"]}},5:{f:function(e){return[$p(e),Jp(e),"n"]}},6:{f:function(e){return[$p(e),Bp(e),"str"]}},7:{f:function(e){return[$p(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,a=$p(e);a.r=r["!row"];var i=[a,Bp(e),"str"];if(r.cellFormula){e.l+=2;var o=ly(e,n-e.l,r);i[3]=ny(o,0,a,r.supbooks,r)}else e.l=n;return i}},9:{f:function(e,t,r){var n=e.l+t,a=$p(e);a.r=r["!row"];var i=[a,Jp(e),"n"];if(r.cellFormula){e.l+=2;var o=ly(e,n-e.l,r);i[3]=ny(o,0,a,r.supbooks,r)}else e.l=n;return i}},10:{f:function(e,t,r){var n=e.l+t,a=$p(e);a.r=r["!row"];var i=[a,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var o=ly(e,n-e.l,r);i[3]=ny(o,0,a,r.supbooks,r)}else e.l=n;return i}},11:{f:function(e,t,r){var n=e.l+t,a=$p(e);a.r=r["!row"];var i=[a,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var o=ly(e,n-e.l,r);i[3]=ny(o,0,a,r.supbooks,r)}else e.l=n;return i}},12:{f:function(e){return[Kp(e)]}},13:{f:function(e){return[Kp(e),Yp(e),"n"]}},14:{f:function(e){return[Kp(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Kp(e),e.read_shift(1),"b"]}},16:{f:Dy},17:{f:function(e){return[Kp(e),Bp(e),"str"]}},18:{f:function(e){return[Kp(e),e.read_shift(4),"s"]}},19:{f:zp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Vp(e),o=uy(e,0,r),s=jp(e);e.l=n;var c={Name:i,Ptg:o};return a<268435455&&(c.Sheet=a),s&&(c.Comment=s),c}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var s=e.read_shift(1);switch(s>0&&(n.charset=s),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var c=sg[n];c&&(t.rgb=Gm(c));break;case 2:t.rgb=Gm([i,o,s]);break;case 3:t.theme=n}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=Bp(e),n}},44:{f:function(e,t){return[e.read_shift(2),Bp(e)]}},45:{f:uv},46:{f:hv},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:pm},62:{f:function(e){return[$p(e),zp(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Op(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vp,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=Wp(e,t-19),r}},148:{f:Ly,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Bp(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Gp(e,t-8),r.name=Bp(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Xp},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Fy},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Bp(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Gp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hm},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,a=Qp(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var s=cy(e,n-e.l,r);o[1]=s}else e.l=n;return o}},427:{f:function(e,t,r){var n=e.l+t,a=[Xp(e,16)];if(r.cellFormula){var i=hy(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Uy.forEach((function(r){t[r]=Jp(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=Xp(e,16),a=jp(e),i=Bp(e),o=Bp(e),s=Bp(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:s};return o&&(c.Tooltip=o),c}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Gp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Sv},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=Xp(e,16);return t.rfx=r.s,t.ref=Op(r.s),e.l+=16,t}},636:{T:-1},637:{f:qp},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Bp(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_b={6:{f:oy},10:{f:Mg},12:{f:Dg},13:{f:Dg},14:{f:Lg},15:{f:Lg},16:{f:Jp},17:{f:Lg},18:{f:Lg},19:{f:Dg},20:{f:sm},21:{f:sm},23:{f:hm},24:{f:um},25:{f:Lg},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),s=qg(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},s,o,i]}}(e,0,r)}},29:{},34:{f:Lg},35:{f:cm},38:{f:Jp},39:{f:Jp},40:{f:Jp},41:{f:Jp},42:{f:Lg},43:{f:Lg},47:{f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?jm(e,t-2,n):function(e,t,r,n){var a={key:Dg(e),verificationBytes:Dg(e)};r.password&&(a.verifier=$m(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Wm(r.password))}(e,r.biff,r,n),n}},49:{f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=Ug(e,0,r),n}},51:{f:Dg},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Lg},65:{f:function(){}},66:{f:Dg},77:{},80:{},81:{},82:{},85:{f:Dg},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=qg(e,0,r);return e.read_shift(t+n-e.l),a}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((fm[n]||vp)(e,t,r)),{cmo:[a,n,i],ft:o}}(e,t,r);var n=Zg(e),a=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(tm[a](e,r-e.l))}catch(Ww){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:a}}},94:{},95:{f:Lg},96:{},97:{},99:{f:Lg},125:{f:pm},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:Dg},131:{f:Lg},132:{f:Lg},133:{f:function(e,t,r){var n=e.read_shift(4),a=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var o=Ug(e,0,r);return 0===o.length&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=ag[t]||t,t=e.read_shift(2),r[1]=ag[t]||t,r}},141:{f:Dg},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(jg(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:Dg},157:{},158:{},160:{f:mm},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=Jp(e),r.footer=Jp(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(Yg(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}},190:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}},193:{f:Mg},197:{},198:{},199:{},200:{},201:{},202:{f:Lg},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Dg},220:{},221:{f:Lg},222:{},224:{f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(4),c=e.read_shift(2);return a.patternType=ig[s>>26],n.cellStyles?(a.alc=7&i,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=15&o,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=127&s,a.icvBottom=s>>7&127,a.icvDiag=s>>14&127,a.dgDiag=s>>21&15,a.icvFore=127&c,a.icvBack=c>>7&127,a.fsxButton=c>>14&1,a):a}(e,0,n.fStyle,r),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Mg},227:{},229:{f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Qg(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(Bg(e));return i.Count=n,i.Unique=a,i}},253:{f:function(e){var t=Vg(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Fg},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Lg},353:{f:Mg},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,1025==i||14849==i)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Hg(e,i),s=[];n>e.l;)s.push(zg(e));return[i,a,o,s]}},431:{f:Lg},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var o=e.read_shift(2);e.read_shift(2),Dg(e);var s=e.read_shift(2);e.l+=s;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var l=e[e.l];if((a+=Hg(e,e.lens[c+1]-e.lens[c]-1)).length>=(l?o:2*o))break}if(a.length!==o&&a.length!==2*o)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch(Ww){return e.l=n+t,{t:a}}}},439:{f:Lg},440:{f:function(e,t){var r=Qg(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,s,c,l,u,h="";16&a&&(i=Kg(e,e.l)),128&a&&(o=Kg(e,e.l)),257===(257&a)&&(s=Kg(e,e.l)),1===(257&a)&&(c=$g(e,e.l)),8&a&&(h=Kg(e,e.l)),32&a&&(l=e.read_shift(16)),64&a&&(u=kg(e)),e.l=r;var d=o||s||c||"";d&&h&&(d+="#"+h),d||(d="#"+h),2&a&&"/"==d.charAt(0)&&"/"!=d.charAt(1)&&(d="file://"+d);var f={Target:d};return l&&(f.guid=l),u&&(f.time=u),i&&(f.Tooltip=i),f}(e,t-24);return[r,n]}},441:{},442:{f:zg},443:{},444:{f:Dg},445:{},446:{},448:{f:Mg},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Mg},512:{f:im},513:{f:gm},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=Vg(e),a=Jp(e);return n.val=a,n}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=Vg(e);2==r.biff&&e.l++;var a=zg(e,e.l,r);return n.val=a,n}},517:{f:om},519:{f:vm},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:dm},549:{f:nm},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=Yg(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),qg(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=Xg(e);e.l++;var a=e.read_shift(1);return[iy(e,t-=8,r),a,n]}},2048:{f:function(e,t){e.read_shift(2);var r=Qg(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(Ah,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:rm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Mg},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(kv(e,e.l));return{ixfe:r,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Lg,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2);return[Hg(e,n,r),Hg(e,a,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var a,i=e.slice(e.l);e.l=n;try{a=Jd(i,{type:"array"})}catch(Ww){return}var o=Gd(a,"theme/theme/theme1.xml",!0);if(o)return wv(o,r)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Mg},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Dg},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,16&a&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(jg(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:im},1:{},2:{f:function(e){var t=Vg(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=Vg(e);++e.l;var r=Jp(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=Vg(e);++e.l;var a=qg(e,0,r);return n.t="str",n.val=a,n}},5:{f:om},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:rm},11:{},22:{f:Dg},30:{f:am},31:{},32:{},33:{f:dm},36:{},37:{f:nm},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Dg},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var n=e.l+t,a=Vg(e),i=e.read_shift(2),o=Hg(e,i,r);return e.l=n,a.t="str",a.val=o,a}},223:{},234:{},354:{},421:{},518:{f:oy},521:{f:rm},536:{f:um},547:{f:cm},561:{},579:{},1030:{f:oy},1033:{f:rm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Rb(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&rp(r)&&e.push(r)}}function Ob(e,t){var r=t||{};var n=r.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,s=i&&i.index||e.length,c=qd(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,h=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<c.length;++o){var g=c[o].trim(),m=g.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=g.split(/<\/t[dh]>/i);for(s=0;s<v.length;++s){var y=v[s].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;"<"==b.charAt(0)&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var T=0;T<p.length;++T){var C=p[T];C.s.c==u&&C.s.r<l&&l<=C.e.r&&(u=C.e.c+1,T=-1)}var k=sf(y.slice(0,y.indexOf(">")));d=k.colspan?+k.colspan:1,((h=+k.rowspan)>1||d>1)&&p.push({s:{r:l,c:u},e:{r:l+(h||1)-1,c:u+d-1}});var E=k.t||k["data-t"]||"";if(b.length)if(b=Ef(b),f.s.r>l&&(f.s.r=l),f.e.r<l&&(f.e.r=l),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),b.length){var S={t:"s",v:b};r.raw||!b.trim().length||"s"==E||("TRUE"===b?S={t:"b",v:!0}:"FALSE"===b?S={t:"b",v:!1}:isNaN(Bd(b))?isNaN(zd(b).getDate())||(S={t:"d",v:Ld(b)},r.cellDates||(S={t:"n",v:Ad(S.v)}),S.z=r.dateNF||Fh[14]):S={t:"n",v:Bd(b)}),r.dense?(n[l]||(n[l]=[]),n[l][u]=S):n[Op({r:l,c:u})]=S,u+=d}else u+=d;else u+=d}}}}else{if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}u=0}}return n["!ref"]=Np(f),p.length&&(n["!merges"]=p),n}function Pb(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,c=0,l=0;l<a.length;++l)if(!(a[l].s.r>r||a[l].s.c>o)&&!(a[l].e.r<r||a[l].e.c<o)){if(a[l].s.r<r||a[l].s.c<o){s=-1;break}s=a[l].e.r-a[l].s.r+1,c=a[l].e.c-a[l].s.c+1;break}if(!(s<0)){var u=Op({r:r,c:o}),h=n.dense?(e[r]||[])[o]:e[u],d=h&&null!=h.v&&(h.h||pf(h.w||(Lp(h),h.w)||""))||"",f={};s>1&&(f.rowspan=s),c>1&&(f.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",null!=h.v&&(f["data-v"]=h.v),null!=h.z&&(f["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(n.id||"sjs")+"-"+u,i.push(Pf("td",d,f))}}return"<tr>"+i.join("")+"</tr>"}var Nb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',xb="</body></html>";function Mb(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Lb(e,t){var r=t||{},n=null!=r.header?r.header:Nb,a=null!=r.footer?r.footer:xb,i=[n],o=Pp(e["!ref"]);r.dense=Array.isArray(e),i.push(Mb(0,0,r));for(var s=o.s.r;s<=o.e.r;++s)i.push(Pb(e,o,s,r));return i.push("</table>"+a),i.join("")}function Db(e,t,r){var n=r||{};var a=0,i=0;if(null!=n.origin)if("number"==typeof n.origin)a=n.origin;else{var o="string"==typeof n.origin?Rp(n.origin):n.origin;a=o.r,i=o.c}var s=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,s.length),l={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Pp(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),-1==a&&(l.e.r=a=u.e.r+1)}var h=[],d=0,f=e["!rows"]||(e["!rows"]=[]),p=0,g=0,m=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<s.length&&g<c;++p){var w=s[p];if(Ub(w)){if(n.display)continue;f[g]={hidden:!0}}var T=w.children;for(m=v=0;m<T.length;++m){var C=T[m];if(!n.display||!Ub(C)){var k=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):Ef(C.innerHTML),E=C.getAttribute("data-z")||C.getAttribute("z");for(d=0;d<h.length;++d){var S=h[d];S.s.c==v+i&&S.s.r<g+a&&g+a<=S.e.r&&(v=S.e.c+1-i,d=-1)}b=+C.getAttribute("colspan")||1,((y=+C.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:g+a,c:v+i},e:{r:g+a+(y||1)-1,c:v+i+(b||1)-1}});var A={t:"s",v:k},I=C.getAttribute("data-t")||C.getAttribute("t")||"";null!=k&&(0==k.length?A.t=I||"z":n.raw||0==k.trim().length||"s"==I||("TRUE"===k?A={t:"b",v:!0}:"FALSE"===k?A={t:"b",v:!1}:isNaN(Bd(k))?isNaN(zd(k).getDate())||(A={t:"d",v:Ld(k)},n.cellDates||(A={t:"n",v:Ad(A.v)}),A.z=n.dateNF||Fh[14]):A={t:"n",v:Bd(k)})),void 0===A.z&&null!=E&&(A.z=E);var _="",R=C.getElementsByTagName("A");if(R&&R.length)for(var O=0;O<R.length&&(!R[O].hasAttribute("href")||"#"==(_=R[O].getAttribute("href")).charAt(0));++O);_&&"#"!=_.charAt(0)&&(A.l={Target:_}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=A):e[Op({c:v+i,r:g+a})]=A,l.e.c<v+i&&(l.e.c=v+i),v+=b}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,g-1+a),e["!ref"]=Np(l),g>=c&&(e["!fullref"]=Np((l.e.r=s.length-p+g-1+a,l))),e}function Fb(e,t){return Db((t||{}).dense?[]:{},e,t)}function Ub(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function Bb(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[hf(t.replace(/<[^>]*>/g,""))]}var Hb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function zb(e,t){var r=t||{};var n,a,i,o,s,c,l=Nf(e),u=[],h={name:""},d="",f=0,p={},g=[],m=r.dense?[]:{},v={value:""},y="",b=0,w=[],T=-1,C=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,S={},A=[],I={},_=[],R=1,O=1,P=[],N={Names:[]},x={},M=["",""],L=[],D={},F="",U=0,B=!1,H=!1,z=0;for(xf.lastIndex=0,l=l.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");s=xf.exec(l);)switch(s[3]=s[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===s[1]?(k.e.c>=k.s.c&&k.e.r>=k.s.r?m["!ref"]=Np(k):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=Np(k)),A.length&&(m["!merges"]=A),_.length&&(m["!rows"]=_),i.name=i["\u540d\u79f0"]||i.name,"undefined"!==typeof JSON&&JSON.stringify(i),g.push(i.name),p[i.name]=m,H=!1):"/"!==s[0].charAt(s[0].length-2)&&(i=sf(s[0],!1),T=C=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,m=r.dense?[]:{},A=[],_=[],H=!0);break;case"table-row-group":"/"===s[1]?--E:++E;break;case"table-row":case"\u884c":if("/"===s[1]){T+=R,R=1;break}if((o=sf(s[0],!1))["\u884c\u53f7"]?T=o["\u884c\u53f7"]-1:-1==T&&(T=0),(R=+o["number-rows-repeated"]||1)<10)for(z=0;z<R;++z)E>0&&(_[T+z]={level:E});C=-1;break;case"covered-table-cell":"/"!==s[1]&&++C,r.sheetStubs&&(r.dense?(m[T]||(m[T]=[]),m[T][C]={t:"z"}):m[Op({r:T,c:C})]={t:"z"}),y="",w=[];break;case"table-cell":case"\u6570\u636e":if("/"===s[0].charAt(s[0].length-2))++C,v=sf(s[0],!1),O=parseInt(v["number-columns-repeated"]||"1",10),c={t:"z",v:null},v.formula&&0!=r.cellFormula&&(c.f=gy(hf(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(c.t="s",c.v=hf(v["string-value"]||""),r.dense?(m[T]||(m[T]=[]),m[T][C]=c):m[Op({r:T,c:C})]=c),C+=O-1;else if("/"!==s[1]){y="",b=0,w=[],O=1;var q=R?T+R-1:T;if(++C>k.e.c&&(k.e.c=C),C<k.s.c&&(k.s.c=C),T<k.s.r&&(k.s.r=T),q>k.e.r&&(k.e.r=q),L=[],D={},c={t:(v=sf(s[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=hf(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(I={s:{r:T,c:C},e:{r:T+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:C+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},c.F=Np(I),P.push([I,c.F])),v.formula)c.f=gy(v.formula);else for(z=0;z<P.length;++z)T>=P[z][0].s.r&&T<=P[z][0].e.r&&C>=P[z][0].s.c&&C<=P[z][0].e.c&&(c.F=P[z][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(I={s:{r:T,c:C},e:{r:T+(parseInt(v["number-rows-spanned"],10)||0)-1,c:C+(parseInt(v["number-columns-spanned"],10)||0)-1}},A.push(I)),v["number-columns-repeated"]&&(O=parseInt(v["number-columns-repeated"],10)),c.t){case"boolean":c.t="b",c.v=mf(v["boolean-value"]);break;case"float":case"percentage":case"currency":c.t="n",c.v=parseFloat(v.value);break;case"date":c.t="d",c.v=Ld(v["date-value"]),r.cellDates||(c.t="n",c.v=Ad(c.v)),c.z="m/d/yy";break;case"time":c.t="n",c.v=Pd(v["time-value"])/86400,r.cellDates&&(c.t="d",c.v=Od(c.v)),c.z="HH:MM:SS";break;case"number":c.t="n",c.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==c.t&&"text"!==c.t&&c.t)throw new Error("Unsupported value type "+c.t);c.t="s",null!=v["string-value"]&&(y=hf(v["string-value"]),w=[])}}else{if(B=!1,"s"===c.t&&(c.v=y||"",w.length&&(c.R=w),B=0==b),x.Target&&(c.l=x),L.length>0&&(c.c=L,L=[]),y&&!1!==r.cellText&&(c.w=y),B&&(c.t="z",delete c.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var $=0;$<R;++$){if(O=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[T+$]||(m[T+$]=[]),m[T+$][C]=0==$?c:Fd(c);--O>0;)m[T+$][C+O]=Fd(c);else for(m[Op({r:T+$,c:C})]=c;--O>0;)m[Op({r:T+$,c:C+O})]=Fd(c);k.e.c<=C&&(k.e.c=C)}C+=(O=parseInt(v["number-columns-repeated"]||"1",10))-1,O=0,c={},y="",w=[]}x={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!0]);break;case"annotation":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n;D.t=y,w.length&&(D.R=w),D.a=F,L.push(D)}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!1]);F="",U=0,y="",b=0,w=[];break;case"creator":"/"===s[1]?F=l.slice(U,s.index):U=s.index+s[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!1]);y="",b=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===s[1]){if(S[h.name]=d,(n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&(d="",h=sf(s[0],!1),u.push([s[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":a=sf(s[0],!1),d+=Hb[s[3]]["long"===a.style?1:0]}break;case"text":if("/>"===s[0].slice(-2))break;if("/"===s[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":d+=l.slice(f,s.index)}else f=s.index+s[0].length;break;case"named-range":M=my((a=sf(s[0],!1))["cell-range-address"]);var K={Name:a.name,Ref:M[0]+"!"+M[1]};H&&(K.Sheet=g.length),N.Names.push(K);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==s[1]||v&&v["string-value"])sf(s[0],!1),b=s.index+s[0].length;else{var W=Bb(l.slice(b,s.index));y=(y.length>0?y+"\n":"")+W[0]}break;case"database-range":if("/"===s[1])break;try{p[(M=my(sf(s[0])["target-range-address"]))[0]]["!autofilter"]={ref:M[1]}}catch(Ww){}break;case"a":if("/"!==s[1]){if(!(x=sf(s[0],!1)).href)break;x.Target=hf(x.href),delete x.href,"#"==x.Target.charAt(0)&&x.Target.indexOf(".")>-1?(M=my(x.Target.slice(1)),x.Target="#"+M[0]+"!"+M[1]):x.Target.match(/^\.\.[\\\/]/)&&(x.Target=x.Target.slice(3))}break;default:switch(s[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(s)}}var j={Sheets:p,SheetNames:g,Workbook:N};return r.bookSheets&&delete j.Sheets,j}function qb(e,t){t=t||{},Wd(e,"META-INF/manifest.xml")&&function(e,t){for(var r,n,a=Nf(e);r=xf.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=sf(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==n.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(Vd(e,"META-INF/manifest.xml"),t);var r=Gd(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=zb(Tf(r),t);return Wd(e,"meta.xml")&&(n.Props=mg(Vd(e,"meta.xml"))),n}function $b(e,t){return zb(e,t)}function Kb(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Wb(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Tf(kh(e))}function jb(e){var t=e.reduce((function(e,t){return e+t.length}),0),r=new Uint8Array(t),n=0;return e.forEach((function(e){r.set(e,n),n+=e.length})),r}function Vb(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Gb(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function Yb(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function Qb(e){for(var t=[],r=[0];r[0]<e.length;){var n,a=r[0],i=Gb(e,r),o=7&i,s=0;if(0==(i=Math.floor(i/8)))break;switch(o){case 0:for(var c=r[0];e[r[0]++]>=128;);n=e.slice(c,r[0]);break;case 5:s=4,n=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,n=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Gb(e,r),n=e.slice(r[0],r[0]+s),r[0]+=s;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(a))}var l={data:n,type:o};null==t[i]?t[i]=[l]:t[i].push(l)}return t}function Xb(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function Jb(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Gb(e,n),i=Qb(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Yb(i[1][0].data),messages:[]};i[2].forEach((function(t){var r=Qb(t.data),a=Yb(r[3][0].data);o.messages.push({meta:r,data:e.slice(n[0],n[0]+a)}),n[0]+=a})),(null==(t=i[3])?void 0:t[0])&&(o.merge=Yb(i[3][0].data)>>>0>0),r.push(o)}return r}function Zb(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Gb(t,r),a=[];r[0]<t.length;){var i=3&t[r[0]];if(0!=i){var o=0,s=0;if(1==i?(s=4+(t[r[0]]>>2&7),o=(224&t[r[0]++])<<3,o|=t[r[0]++]):(s=1+(t[r[0]++]>>2),2==i?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[jb(a)],0==o)throw new Error("Invalid offset 0");if(o>a[0].length)throw new Error("Invalid offset beyond length");if(s>=o)for(a.push(a[0].slice(-o)),s-=o;s>=a[a.length-1].length;)a.push(a[a.length-1]),s-=a[a.length-1].length;a.push(a[0].slice(-o,-o+s))}else{var c=t[r[0]++]>>2;if(c<60)++c;else{var l=c-59;c=t[r[0]],l>1&&(c|=t[r[0]+1]<<8),l>2&&(c|=t[r[0]+2]<<16),l>3&&(c|=t[r[0]+3]<<24),c>>>=0,c++,r[0]+=l}a.push(t.slice(r[0],r[0]+c)),r[0]+=c}}var u=jb(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function ew(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Zb(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return jb(t)}function tw(e,t,r){var n,a=Kb(e),i=a.getUint32(8,!0),o=12,s=-1,c=-1,l=NaN,u=NaN,h=new Date(2001,0,1);switch(1&i&&(l=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],a=t+13;a>=t;--a)n=256*n+e[a];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,o),o+=16),2&i&&(u=a.getFloat64(o,!0),o+=8),4&i&&(h.setTime(h.getTime()+1e3*a.getFloat64(o,!0)),o+=8),8&i&&(c=a.getUint32(o,!0),o+=4),16&i&&(s=a.getUint32(o,!0),o+=4),e[1]){case 0:break;case 2:case 10:n={t:"n",v:l};break;case 3:n={t:"s",v:t[c]};break;case 5:n={t:"d",v:h};break;case 6:n={t:"b",v:u>0};break;case 7:n={t:"n",v:u/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(s>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));n={t:"s",v:r[s]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return n}function rw(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,n){var a,i=Kb(e),o=i.getUint32(4,!0),s=(n>1?12:8)+4*Vb(o&(n>1?3470:398)),c=-1,l=-1,u=NaN,h=new Date(2001,0,1);switch(512&o&&(c=i.getUint32(s,!0),s+=4),s+=4*Vb(o&(n>1?12288:4096)),16&o&&(l=i.getUint32(s,!0),s+=4),32&o&&(u=i.getFloat64(s,!0),s+=8),64&o&&(h.setTime(h.getTime()+1e3*i.getFloat64(s,!0)),s+=8),e[2]){case 0:break;case 2:a={t:"n",v:u};break;case 3:a={t:"s",v:t[l]};break;case 5:a={t:"d",v:h};break;case 6:a={t:"b",v:u>0};break;case 7:a={t:"n",v:u/86400};break;case 8:a={t:"e",v:0};break;case 9:if(c>-1)a={t:"s",v:r[c]};else if(l>-1)a={t:"s",v:t[l]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,r,e[0]);case 5:return tw(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function nw(e){return Gb(Qb(e)[1][0].data)}function aw(e,t){var r=Qb(t.data),n=Yb(r[1][0].data),a=r[3],i=[];return(a||[]).forEach((function(t){var r=Qb(t.data),a=Yb(r[1][0].data)>>>0;switch(n){case 1:i[a]=Wb(r[3][0].data);break;case 8:var o=Qb(e[nw(r[9][0].data)][0].data),s=e[nw(o[1][0].data)][0],c=Yb(s.meta[1][0].data);if(2001!=c)throw new Error("2000 unexpected reference to ".concat(c));var l=Qb(s.data);i[a]=l[3].map((function(e){return Wb(e.data)})).join("")}})),i}function iw(e,t){var r,n=Qb(t.data),a=(null==(r=null==n?void 0:n[7])?void 0:r[0])?Yb(n[7][0].data)>>>0>0?1:0:-1,i=Xb(n[5],(function(e){return function(e,t){var r,n,a,i,o,s,c,l,u,h,d,f,p,g,m,v,y=Qb(e),b=Yb(y[1][0].data)>>>0,w=Yb(y[2][0].data)>>>0,T=(null==(n=null==(r=y[8])?void 0:r[0])?void 0:n.data)&&Yb(y[8][0].data)>0||!1;if((null==(i=null==(a=y[7])?void 0:a[0])?void 0:i.data)&&0!=t)m=null==(s=null==(o=y[7])?void 0:o[0])?void 0:s.data,v=null==(l=null==(c=y[6])?void 0:c[0])?void 0:l.data;else{if(!(null==(h=null==(u=y[4])?void 0:u[0])?void 0:h.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(f=null==(d=y[4])?void 0:d[0])?void 0:f.data,v=null==(g=null==(p=y[3])?void 0:p[0])?void 0:g.data}for(var C=T?4:1,k=Kb(m),E=[],S=0;S<m.length/2;++S){var A=k.getUint16(2*S,!0);A<65535&&E.push([S,A])}if(E.length!=w)throw"Expected ".concat(w," cells, found ").concat(E.length);var I=[];for(S=0;S<E.length-1;++S)I[E[S][0]]=v.subarray(E[S][1]*C,E[S+1][1]*C);return E.length>=1&&(I[E[E.length-1][0]]=v.subarray(E[E.length-1][1]*C)),{R:b,cells:I}}(e,a)}));return{nrows:Yb(n[4][0].data)>>>0,data:i.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r})),e}),[])}}function ow(e,t){var r={"!ref":"A1"},n=e[nw(Qb(t.data)[2][0].data)],a=Yb(n[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,r){var n,a=Qb(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Yb(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Yb(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Np(i);var o=Qb(a[4][0].data),s=aw(e,e[nw(o[4][0].data)][0]),c=(null==(n=o[17])?void 0:n[0])?aw(e,e[nw(o[17][0].data)][0]):[],l=Qb(o[3][0].data),u=0;l[1].forEach((function(t){var n=Qb(t.data),a=e[nw(n[2][0].data)][0],i=Yb(a.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var o=iw(0,a);o.data.forEach((function(e,t){e.forEach((function(e,n){var a=Op({r:u+t,c:n}),i=rw(e,s,c);i&&(r[a]=i)}))})),u+=o.nrows}))}(e,n[0],r),r}function sw(e,t){var r={SheetNames:[],Sheets:{}};if(Xb(Qb(t.data)[1],nw).forEach((function(t){e[t].forEach((function(t){if(2==Yb(t.meta[1][0].data)){var n=function(e,t){var r,n=Qb(t.data),a={name:(null==(r=n[1])?void 0:r[0])?Wb(n[1][0].data):"",sheets:[]};return Xb(n[2],nw).forEach((function(t){e[t].forEach((function(t){6e3==Yb(t.meta[1][0].data)&&a.sheets.push(ow(e,t))}))})),a}(e,t);n.sheets.forEach((function(e,t){_w(r,e,0==t?n.name:n.name+"_"+t,!0)}))}}))})),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function cw(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=ew(e.content)}catch(Ww){return console.log("?? "+e.content.length+" "+(Ww.message||Ww))}try{r=Jb(t)}catch(Ww){return console.log("## "+(Ww.message||Ww))}r.forEach((function(e){i[e.id]=e.messages,o.push(e.id)}))}})),!o.length)throw new Error("File has no messages");var s=(null==(a=null==(n=null==(r=null==(t=null==i?void 0:i[1])?void 0:t[0])?void 0:r.meta)?void 0:n[1])?void 0:a[0].data)&&1==Yb(i[1][0].meta[1][0].data)&&i[1][0];if(s||o.forEach((function(e){i[e].forEach((function(e){if(1==Yb(e.meta[1][0].data)>>>0){if(s)throw new Error("Document has multiple roots");s=e}}))})),!s)throw new Error("Cannot find Document root");return sw(i,s)}function lw(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function uw(e){lw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function hw(e,t,r,n,a,i,o,s,c,l,u,h){try{i[n]=fg(Gd(e,r,!0),t);var d,f=Vd(e,t);switch(s){case"sheet":d=Jy(f,t,a,c,i[n],l,u,h);break;case"chart":if(!(d=Zy(f,t,a,c,i[n],l))||!d["!drawel"])break;var p=Zd(d["!drawel"].Target,t),g=dg(p),m=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(Gd(e,p,!0),fg(Gd(e,g,!0),p)),v=Zd(m,p),y=dg(v);d=By(Gd(e,v,!0),0,0,fg(Gd(e,y,!0),v),0,d);break;case"macro":w=t,i[n],w.slice(-4),d={"!type":"macro"};break;case"dialog":d=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,i[n]);break;default:throw new Error("Unrecognized sheet type "+s)}o[n]=d;var b=[];i&&i[n]&&kd(i[n]).forEach((function(r){var a="";if(i[n][r].Type==hg.CMNT){a=Zd(i[n][r].Target,t);var o=rb(Vd(e,a,!0),a,c);if(!o||!o.length)return;Ev(d,o,!1)}i[n][r].Type==hg.TCMNT&&(a=Zd(i[n][r].Target,t),b=b.concat(function(e,t){var r=[],n=!1,a={},i=0;return e.replace(nf,(function(o,s){var c=sf(o);switch(cf(c[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=a.t&&r.push(a);break;case"<text>":case"<text":i=s+o.length;break;case"</text>":a.t=e.slice(i,s).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o})),r}(Vd(e,a,!0),c)))})),b&&b.length&&Ev(d,b,!0,c.people||[])}catch(Ww){if(c.WTF)throw Ww}var w}function dw(e){return"/"==e.charAt(0)?e.slice(1):e}function fw(e,t){if(vd(),uw(t=t||{}),Wd(e,"META-INF/manifest.xml"))return qb(e,t);if(Wd(e,"objectdata.xml"))return qb(e,t);if(Wd(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return cw(e);var r=Td.utils.cfb_new();return Qd(e).forEach((function(t){Xd(r,t,Yd(e,t))})),cw(r)}if(!Wd(e,"[Content_Types].xml")){if(Wd(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Wd(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,a,i=Qd(e),o=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(nf)||[]).forEach((function(e){var n=sf(e);switch(n[0].replace(af,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[ug[n.ContentType]]&&t[ug[n.ContentType]].push(n.PartName)}})),t.xmlns!==Mf)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(Gd(e,"[Content_Types].xml")),s=!1;if(0===o.workbooks.length&&Vd(e,a="xl/workbook.xml",!0)&&o.workbooks.push(a),0===o.workbooks.length){if(!Vd(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");o.workbooks.push(a),s=!0}"bin"==o.workbooks[0].slice(-3)&&(s=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(vy=[],o.sst)try{vy=tb(Vd(e,dw(o.sst)),o.sst,t)}catch(Ww){if(t.WTF)throw Ww}t.cellStyles&&o.themes.length&&(c=function(e,t,r){return wv(e,r)}(Gd(e,o.themes[0].replace(/^\//,""),!0)||"",o.themes[0],t)),o.style&&(l=eb(Vd(e,dw(o.style)),o.style,c,t))}o.links.map((function(r){try{fg(Gd(e,dg(dw(r))),r);return ab(Vd(e,dw(r)),0,r,t)}catch(Ww){}}));var u=Xy(Vd(e,dw(o.workbooks[0])),o.workbooks[0],t),h={},d="";o.coreprops.length&&((d=Vd(e,dw(o.coreprops[0]),!0))&&(h=mg(d)),0!==o.extprops.length&&(d=Vd(e,dw(o.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=Tf(e),vg.forEach((function(r){var a=(e.match(kf(r[0]))||[])[1];switch(r[2]){case"string":a&&(t[r[1]]=hf(a));break;case"bool":t[r[1]]="true"===a;break;case"raw":var i=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));i&&i.length>0&&(n[r[1]]=i[1])}})),n.HeadingPairs&&n.TitlesOfParts&&yg(n.HeadingPairs,n.TitlesOfParts,t,r)}(d,h,t));var f={};t.bookSheets&&!t.bookProps||0!==o.custprops.length&&(d=Gd(e,dw(o.custprops[0]),!0))&&(f=function(e,t){var r={},n="",a=e.match(bg);if(a)for(var i=0;i!=a.length;++i){var o=a[i],s=sf(o);switch(s[0]){case"<?xml":case"<Properties":break;case"<property":n=hf(s.name);break;case"</property>":n=null;break;default:if(0===o.indexOf("<vt:")){var c=o.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=hf(u);break;case"bool":r[n]=mf(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Ld(u);break;default:if("/"==l.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",o,l,c)}}else if("</"===o.slice(0,2));else if(t.WTF)throw new Error(o)}}return r}(d,t));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?n=u.Sheets.map((function(e){return e.name})):h.Worksheets&&h.SheetNames.length>0&&(n=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=f),t.bookSheets&&"undefined"!==typeof n&&(p.SheetNames=n),t.bookSheets?p.SheetNames:t.bookProps))return p;n={};var g={};t.bookDeps&&o.calcchain&&(g=nb(Vd(e,dw(o.calcchain)),o.calcchain));var m,v,y=0,b={},w=u.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var T=0;T!=w.length;++T)h.SheetNames[T]=w[T].name;var C=s?"bin":"xml",k=o.workbooks[0].lastIndexOf("/"),E=(o.workbooks[0].slice(0,k+1)+"_rels/"+o.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Wd(e,E)||(E="xl/_rels/workbook."+C+".rels");var S=fg(Gd(e,E,!0),E.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=ib(Vd(e,dw(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=function(e,t){var r=[],n=!1;return e.replace(nf,(function(e){var a=sf(e);switch(cf(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e})),r}(Vd(e,dw(o.people[0])),t)),S&&(S=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,hg.WS.indexOf(r)>-1?"sheet":hg.CS&&r==hg.CS?"chart":hg.DS&&r==hg.DS?"dialog":hg.MS&&r==hg.MS?"macro":r&&r.length?r:"sheet")];var r}))}catch(Ww){return null}return e&&0!==e.length?e:null}(S,u.Sheets));var A=Vd(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var I="sheet";if(S&&S[y]?(m="xl/"+S[y][1].replace(/[\/]?xl\//,""),Wd(e,m)||(m=S[y][1]),Wd(e,m)||(m=E.replace(/_rels\/.*$/,"")+S[y][1]),I=S[y][2]):m=(m="xl/worksheets/sheet"+(y+1-A)+"."+C).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var _=!1,R=0;R!=t.sheets.length;++R)"number"==typeof t.sheets[R]&&t.sheets[R]==y&&(_=1),"string"==typeof t.sheets[R]&&t.sheets[R].toLowerCase()==h.SheetNames[y].toLowerCase()&&(_=1);if(!_)continue e}}hw(e,m,v,h.SheetNames[y],y,b,n,I,t,u,c,l)}return p={Directory:o,Workbook:u,Props:h,Custprops:f,Deps:g,Sheets:n,SheetNames:h.SheetNames,Strings:vy,Styles:l,Themes:c,SSF:Fd(Fh)},t&&t.bookFiles&&(e.files?(p.keys=i,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach((function(t,r){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[r]})))),t&&t.bookVBA&&(o.vba.length>0?p.vbaraw=Vd(e,dw(o.vba[0]),!0):o.defaults&&"application/vnd.ms-office.vbaProject"===o.defaults.bin&&(p.vbaraw=Vd(e,"xl/vbaProject.bin",!0))),p}function pw(e,t){var r=t||{},n="Workbook",a=Td.find(e,n);try{if(n="/!DataSpaces/Version",!(a=Td.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=Lm(e,4),t.U=Lm(e,4),t.W=Lm(e,4)}(a.content),n="/!DataSpaces/DataSpaceMap",!(a=Td.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Dm(e));return t}(a.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=Td.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=Td.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Fm(a.content)}catch(Ww){}if(n="/EncryptionInfo",!(a=Td.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function(e){var t=Lm(e);switch(t.Minor){case 2:return[t.Minor,Hm(e)];case 3:return[t.Minor,zm()];case 4:return[t.Minor,qm(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(n="/EncryptedPackage",!(a=Td.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==s[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(s[1],a.content,r.password||"",r);if(2==s[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(s[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function gw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=vh(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function mw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return vb(e.slice(r),t);default:break e}return km.to_workbook(e,t)}function vw(e,t,r,n){return n?(r.type="string",km.to_workbook(e,r)):km.to_workbook(t,r)}function yw(e,t){ch();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return yw(new Uint8Array(e),((r=Fd(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var n,a=e,i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),yy={},r.dateNF&&(yy.dateNF=r.dateNF),r.type||(r.type=yh&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=yh?"buffer":"binary",a=function(e){if("undefined"!==typeof Cd)return Cd.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(Ww){if(!Ww.message||!Ww.message.match(/onstruct/))throw Ww}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||yh||(r.type="array")),"string"==r.type&&(i=!0,r.type="binary",r.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?Cf(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var o=new ArrayBuffer(3),s=new Uint8Array(o);if(s.foo="bar",!s.foo)return(r=Fd(r)).type="array",yw(Eh(a),r)}switch((n=gw(a,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return Td.find(e,"EncryptedPackage")?pw(e,t):Ab(e,t)}(Td.read(a,r),r);break;case 9:if(n[1]<=8)return Ab(a,r);break;case 60:return vb(a,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=wm.to_workbook(e,r);return r.WTF=n,a}catch(Ww){if(r.WTF=n,!Ww.message.match(/SYLK bad record ID/)&&n)throw Ww;return km.to_workbook(e,t)}}(a,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return Tm.to_workbook(a,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var r=e,n=t||{};return n.type||(n.type=yh&&Buffer.isBuffer(e)?"buffer":"base64"),fw(Jd(r,n),n)}(a,r):vw(e,a,r,i);case 239:return 60===n[3]?vb(a,r):vw(e,a,r,i);case 255:if(254===n[1])return function(e,t){var r=e;return"base64"==t.type&&(r=vh(r)),r=hh.utils.decode(1200,r.slice(2),"str"),t.type="binary",mw(r,t)}(a,r);if(0===n[1]&&2===n[2]&&0===n[3])return Em.to_workbook(a,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return Em.to_workbook(a,r);if(0===n[2]&&(8===n[3]||9===n[3]))return Em.to_workbook(a,r)}break;case 3:case 131:case 139:case 140:return bm.to_workbook(a,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return Vm.to_workbook(a,r);break;case 10:case 13:case 32:return function(e,t){var r="",n=gw(e,t);switch(t.type){case"base64":r=vh(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Dd(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=Tf(r)),t.type="binary",mw(r,t)}(a,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return ym.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?bm.to_workbook(a,r):vw(e,a,r,i)}function bw(e,t,r,n,a,i,o,s){var c=Ap(r),l=s.defval,u=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),h=!0,d=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch(Ww){d.__rowNum__=r}else d.__rowNum__=r;if(!o||e[r])for(var f=t.s.c;f<=t.e.c;++f){var p=o?e[r][f]:e[n[f]+c];if(void 0!==p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[f]){if(null==g)if("e"==p.t&&null===g)d[i[f]]=null;else if(void 0!==l)d[i[f]]=l;else{if(!u||null!==g)continue;d[i[f]]=null}else d[i[f]]=u&&("n"!==p.t||"n"===p.t&&!1!==s.rawNumbers)?g:Lp(p,g,s);null!=g&&(h=!1)}}else{if(void 0===l)continue;null!=i[f]&&(d[i[f]]=l)}}return{row:d,isempty:h}}function ww(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,s="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=null!=l.range?l.range:e["!ref"];switch(1===l.header?n=1:"A"===l.header?n=2:Array.isArray(l.header)?n=3:null==l.header&&(n=0),typeof u){case"string":c=xp(u);break;case"number":(c=xp(e["!ref"])).s.r=u;break;default:c=u}n>0&&(a=0);var h=Ap(c.s.r),d=[],f=[],p=0,g=0,m=Array.isArray(e),v=c.s.r,y=0,b={};m&&!e[v]&&(e[v]=[]);var w=l.skipHidden&&e["!cols"]||[],T=l.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(d[y]=_p(y),r=m?e[v][y]:e[d[y]+h],n){case 1:i[y]=y-c.s.c;break;case 2:i[y]=d[y];break;case 3:i[y]=l.header[y-c.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),s=o=Lp(r,null,l),g=b[o]||0){do{s=o+"_"+g++}while(b[s]);b[o]=g,b[s]=1}else b[o]=1;i[y]=s}for(v=c.s.r+a;v<=c.e.r;++v)if(!(T[v]||{}).hidden){var C=bw(e,c,v,d,n,i,m,l);(!1===C.isempty||(1===n?!1!==l.blankrows:l.blankrows))&&(f[p++]=C.row)}return f.length=p,f}var Tw=/"/g;function Cw(e,t,r,n,a,i,o,s){for(var c=!0,l=[],u="",h=Ap(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var f=s.dense?(e[r]||[])[d]:e[n[d]+h];if(null==f)u="";else if(null!=f.v){c=!1,u=""+(s.rawNumbers&&"n"==f.t?f.v:Lp(f,null,s));for(var p=0,g=0;p!==u.length;++p)if((g=u.charCodeAt(p))===a||g===i||34===g||s.forceQuotes){u='"'+u.replace(Tw,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(c=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(Tw,'""')+'"'));l.push(u)}return!1===s.blankrows&&c?null:l.join(o)}function kw(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=xp(e["!ref"]),i=void 0!==n.FS?n.FS:",",o=i.charCodeAt(0),s=void 0!==n.RS?n.RS:"\n",c=s.charCodeAt(0),l=new RegExp(("|"==i?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(d[p]||{}).hidden||(h[p]=_p(p));for(var g=0,m=a.s.r;m<=a.e.r;++m)(f[m]||{}).hidden||null!=(u=Cw(e,a,m,h,o,c,i,n))&&(n.strip&&(u=u.replace(l,"")),(u||!1!==n.blankrows)&&r.push((g++?s:"")+u));return delete n.dense,r.join("")}function Ew(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=kw(e,t);if("undefined"==typeof hh||"string"==t.type)return r;var n=hh.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function Sw(e,t,r){var n,a=r||{},i=+!a.skipHeader,o=e||{},s=0,c=0;if(o&&null!=a.origin)if("number"==typeof a.origin)s=a.origin;else{var l="string"==typeof a.origin?Rp(a.origin):a.origin;s=l.r,c=l.c}var u={s:{c:0,r:0},e:{c:c,r:s+t.length-1+i}};if(o["!ref"]){var h=xp(o["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==s&&(s=h.e.r+1,u.e.r=s+t.length-1+i)}else-1==s&&(s=0,u.e.r=t.length-1+i);var d=a.header||[],f=0;t.forEach((function(e,t){kd(e).forEach((function(r){-1==(f=d.indexOf(r))&&(d[f=d.length]=r);var l=e[r],u="z",h="",p=Op({c:c+f,r:s+t+i});n=Aw(o,p),!l||"object"!==typeof l||l instanceof Date?("number"==typeof l?u="n":"boolean"==typeof l?u="b":"string"==typeof l?u="s":l instanceof Date?(u="d",a.cellDates||(u="n",l=Ad(l)),h=a.dateNF||Fh[14]):null===l&&a.nullError&&(u="e",l=0),n?(n.t=u,n.v=l,delete n.w,delete n.R,h&&(n.z=h)):o[p]=n={t:u,v:l},h&&(n.z=h)):o[p]=l}))})),u.e.c=Math.max(u.e.c,c+d.length-1);var p=Ap(s);if(i)for(f=0;f<d.length;++f)o[_p(f+c)+p]={t:"s",v:d[f]};return o["!ref"]=Np(u),o}function Aw(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=Rp(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Aw(e,Op("number"!=typeof t?t:{r:t,c:r||0}))}function Iw(){return{SheetNames:[],Sheets:{}}}function _w(e,t,r,n){var a=1;if(!r)for(;a<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+a);++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(r=o+a);++a);}if(Gy(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Rw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var Ow={encode_col:_p,encode_row:Ap,encode_cell:Op,encode_range:Np,decode_col:Ip,decode_row:Sp,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Rp,decode_range:Pp,format_cell:Lp,sheet_add_aoa:Fp,sheet_add_json:Sw,sheet_add_dom:Db,aoa_to_sheet:Up,json_to_sheet:function(e,t){return Sw(null,e,t)},table_to_sheet:Fb,table_to_book:function(e,t){return Dp(Fb(e,t),t)},sheet_to_csv:kw,sheet_to_txt:Ew,sheet_to_json:ww,sheet_to_html:Lb,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var a,i=xp(e["!ref"]),o="",s=[],c=[],l=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)s[a]=_p(a);for(var u=i.s.r;u<=i.e.r;++u)for(o=Ap(u),a=i.s.c;a<=i.e.c;++a)if(r=s[a]+o,n="",void 0!==(t=l?(e[u]||[])[a]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}c[c.length]=r+"="+n}return c},sheet_to_row_object_array:ww,sheet_get_cell:Aw,book_new:Iw,book_append_sheet:_w,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Rw,cell_set_internal_link:function(e,t,r){return Rw(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var a="string"!=typeof t?t:xp(t),i="string"==typeof t?t:Np(t),o=a.s.r;o<=a.e.r;++o)for(var s=a.s.c;s<=a.e.c;++s){var c=Aw(e,o,s);c.t="n",c.F=i,delete c.v,o==a.s.r&&s==a.s.c&&(c.f=r,n&&(c.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};th.version;const Pw=e=>{let{searchTerm:t,setSearchTerm:r}=e;return(0,Du.jsxs)("div",{className:"search-container",children:[(0,Du.jsx)("input",{type:"text",className:"search-input",placeholder:"Search for veteran...",value:t,onChange:e=>r(e.target.value)}),(0,Du.jsx)("button",{className:"clear-button",onClick:()=>r(""),children:"x"})]})},Nw=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t)).join(" ").trim()};var xw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Mw=(0,a.forwardRef)(((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:s="",children:c,iconNode:l,...u}=e;return(0,a.createElement)("svg",{ref:t,...xw,width:n,height:n,stroke:r,strokeWidth:o?24*Number(i)/Number(n):i,className:Nw("lucide",s),...u},[...l.map((e=>{let[t,r]=e;return(0,a.createElement)(t,r)})),...Array.isArray(c)?c:[c]])})),Lw=(e,t)=>{const r=(0,a.forwardRef)(((r,n)=>{let{className:i,...o}=r;return(0,a.createElement)(Mw,{ref:n,iconNode:t,className:Nw(`lucide-${s=e,s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,i),...o});var s}));return r.displayName=`${e}`,r},Dw=Lw("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Fw=Lw("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Uw=e=>{let{doc:t,isValid:r,isChecked:n}=e;return(0,Du.jsxs)("div",{className:"document-box "+(n?"checked":""),children:[(0,Du.jsx)("span",{children:t}),(0,Du.jsx)("div",{className:"status-icons",children:r||n?(0,Du.jsx)(Dw,{className:"status-icon valid"}):(0,Du.jsx)(Fw,{className:"status-icon invalid"})})]})},Bw=e=>{let{filteredData:t,studentBenefitsMap:r,requiredDocsMapping:n,checkedDocuments:a,handleCheckboxChange:i,getDocumentStatus:o,dateChecked:s,handleDateToggle:c}=e;return(0,Du.jsxs)("table",{className:"data-table",children:[(0,Du.jsx)("thead",{children:(0,Du.jsxs)("tr",{children:[(0,Du.jsx)("th",{className:"red-header",children:"Name"}),(0,Du.jsx)("th",{className:"red-header",children:"Student ID"}),(0,Du.jsx)("th",{className:"red-header",children:"Benefit"}),(0,Du.jsx)("th",{className:"red-header",children:"Required Documents"})]})}),(0,Du.jsx)("tbody",{children:t.map(((e,t)=>{const l=r[e.studentId]||"",u=n[l]||[];return(0,Du.jsxs)("tr",{children:[(0,Du.jsx)("td",{children:e.name}),(0,Du.jsx)("td",{children:e.studentId}),(0,Du.jsx)("td",{children:(0,Du.jsx)("span",{children:l})}),(0,Du.jsx)("td",{children:(0,Du.jsxs)("div",{className:"document-container",children:[(0,Du.jsx)("div",{className:"checkbox-column",children:u.map(((t,r)=>(0,Du.jsx)("input",{type:"checkbox",checked:a[`${e.studentId}-${t}`]||o(e.studentId,t),onChange:()=>i(`${e.studentId}-${t}`,e.studentId)},r)))}),(0,Du.jsx)("div",{className:"documents-column",children:u.map(((t,r)=>{const n=o(e.studentId,t),i=a[`${e.studentId}-${t}`]||n;return(0,Du.jsx)(Uw,{doc:t,isValid:n,isChecked:i},r)}))}),(0,Du.jsxs)("div",{className:"date-container",children:[(0,Du.jsx)("input",{type:"checkbox",checked:!!s[e.studentId],onChange:()=>c(e.studentId)}),(0,Du.jsxs)("span",{className:"date-text",children:["Date: ",s[e.studentId]&&new Date(s[e.studentId]).toLocaleDateString("en-US",{month:"numeric",day:"numeric"})]})]})]})})]},t)}))})]})},Hw=(0,a.forwardRef)(((e,t)=>{let{setIsLoading:r}=e;const[n,i]=(0,a.useState)((()=>{const e=localStorage.getItem("dateChecked");return e?JSON.parse(e):{}})),[o,s]=(0,a.useState)(!1),[c,l]=(0,a.useState)(!1),[u,h]=(0,a.useState)([]),[d,f]=(0,a.useState)(""),[p,g]=(0,a.useState)(null),[m,v]=(0,a.useState)({}),[y,b]=(0,a.useState)({}),[w,T]=(0,a.useState)(!1),[C,k]=(0,a.useState)([]),[E,S]=(0,a.useState)([]),[A,I]=(0,a.useState)([]),[_,R]=(0,a.useState)({}),[O,P]=(0,a.useState)({}),[N,x]=(0,a.useState)({}),[M,L]=(0,a.useState)(!1),[D,F]=(0,a.useState)((()=>null===sessionStorage.getItem("isFirstLoad")?(sessionStorage.setItem("isFirstLoad","false"),!1):"true"===localStorage.getItem("hasScanned"))),[U,B]=(0,a.useState)({}),[H,z]=(0,a.useState)([]),[q,$]=(0,a.useState)(!1),K={"Chapter 30":["COE","Enrollment Manager","Schedule"],"Chapter 31":["Enrollment Manager","Schedule"],"Chapter 33 Post 9/11":["COE","Enrollment Manager","Schedule"],"Chapter 35":["COE","Enrollment Manager","Schedule"],"Fed TA":["TAR","Enrollment Manager","Schedule"],"State TA":["Award Letter","Enrollment Manager","Schedule"],"Missouri Returning Heroes":["DD214","Enrollment Manager","Schedule"],"Chapter 1606":["COE","Enrollment Manager","Schedule"]};(0,a.useEffect)((()=>{const e=localStorage.getItem("checkedDocuments");e&&v(JSON.parse(e))}),[]);const W=(e,t)=>(K[t]||[]).every((t=>J(e,t))),j=async()=>{try{const e=await(async(e,t)=>{const r=(await Ju(e,t)).value.find((e=>"RFC Dummy v2.xlsx"===e.name));if(!r)throw new Error("File not found");return r["@microsoft.graph.downloadUrl"]})(Nu,"01WZNNVP23EWLU4M4YXVE2ULM75ROI4H4N"),t=await fetch(e),r=await t.blob(),n=yw(await r.arrayBuffer()),a=n.SheetNames[0],i=n.Sheets[a],o=Ow.sheet_to_json(i,{header:1}),s=o.slice(1).map((e=>({name:e[10],studentId:e[13],benefit:e[23]}))).filter((e=>e.name));h(s);const c={};s.forEach((e=>{var t;c[e.studentId]=(t=e.benefit||"")?t.includes("Missouri Returning Heroes")?"Missouri Returning Heroes":t.includes("Chapter 33 Post 9/11")?"Chapter 33 Post 9/11":t.includes("Chapter 31 VocRehab")?"Chapter 31":t.includes("State Tuition Assistance Deadline")?"State TA":t.includes("Chapter 35")?"Chapter 35":t.includes("Chapter 30 MGIB")?"Chapter 30":t.includes("Federal Tuition Assistance Deadline")?"Fed TA":t.includes("Chapter 1606")?"Chapter 1606":t:""})),B(c)}catch(e){g("Failed to fetch Excel file")}},V=async()=>{T(!0);try{const e=await Gu(),t=await Yu(Nu,e),r=await Ju(Nu,t);k(r.value);const n=await Qu(Nu,t),a=await Ju(Nu,n);S(a.value);const i=await Xu(Nu,n),o=await Ju(Nu,i);I(o.value),await Q(i,o.value),L(!0)}catch(p){g("Failed to fetch contents. Please try again.")}finally{T(!1)}},G=async()=>{T(!0),g(null);try{const e={...N},t={...m};await Promise.all([j(),V()]),x(e),v(t),F(D)}catch(p){g("Failed to refresh data. Please try again.")}finally{T(!1)}};(0,a.useEffect)((()=>{(async()=>{0===u.length&&await j(),await V()})()}),[]);const Y=async e=>{try{const t=await Ju(Nu,e);return P((r=>({...r,[e]:t.value}))),t.value}catch(p){return console.error(`Error loading subfolder contents for ${e}:`,p),[]}},Q=async(e,t)=>{const r={},n=new Set;try{const t=await(async(e,t)=>{let r=[],n=`https://graph.microsoft.com/v1.0/drives/${e}/items/${t}/children`;try{for(;n;){const e=await zu.getAccessToken(),t=new Headers({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}),a=await fetch(n,{headers:t});if(!a.ok)throw new Error(`Failed to fetch children: ${a.status}`);const i=await a.json();r=[...r,...i.value],n=i["@odata.nextLink"]||null}return{value:r}}catch(p){throw console.error("Error in fetchAllChildren:",p),new Error(`Failed to fetch all children: ${p.message}`)}})(Nu,e);for(let e=0;e<t.value.length;e+=60){const r=[];for(let n=0;n<2;n++){const i=e+30*n;if(i>=t.value.length)break;const o=t.value.slice(i,Math.min(i+30,t.value.length));r.push(a(o))}await Promise.all(r),e+60<t.value.length&&await new Promise((e=>setTimeout(e,500)))}R(r);const i=u.filter((e=>{const t=`${e.name} ${e.studentId}`;return!n.has(t)}));z(i)}catch(p){throw console.error("Error in loadAllStudentFolders:",p),g("Failed to load student folders. Please try again."),p}async function a(e){return Promise.all(e.map((async e=>{try{if(n.has(e.name))return;const[t]=await Promise.all([Ju(Nu,e.id)]);r[e.name]=t.value,n.add(e.name);const a=t.value;for(let e=0;e<a.length;e+=2){const t=a.slice(e,e+2);(await Promise.all(t.map((async e=>{const t=await Y(e.id);return{id:e.id,contents:t}})))).forEach((e=>{let{id:t,contents:r}=e;P((e=>({...e,[t]:r})))}))}}catch(p){console.error(`Error processing student folder ${e.name}:`,p)}})))}},X=async()=>{if(M&&Object.keys(_).length>0){x({}),Object.entries(_).forEach((e=>{let[t,r]=e;((e,t)=>{const r={dd214Valid:!1,tarValid:!1,awardLetterValid:!1,coeValid:!1,emValid:!1,schedValid:!1};try{var n;const a=e.split(" ").pop(),i=U[a]||"",[o,s]=e.split(", "),c=null===s||void 0===s||null===(n=s.split(" "))||void 0===n?void 0:n[0];if(!o||!c)return console.error(`Invalid name format for student: ${e}`),r;const l=t.filter((e=>/^\d+/.test(e.name))).sort(((e,t)=>{const r=parseInt(e.name.split(" ")[0],10)||0;return(parseInt(t.name.split(" ")[0],10)||0)-r}))[0];t.forEach((e=>{const t=O[e.id]||[];if("00"===e.name)if("Missouri Returning Heroes"===i){const e=`${o}, ${c} DD214.pdf`;r.dd214Valid=t.some((t=>t.name.toLowerCase()===e.toLowerCase()))}else if("Fed TA"===i){const e=`${o}, ${c} TAR.pdf`;r.tarValid=t.some((t=>t.name.toLowerCase()===e.toLowerCase()))}else if("State TA"===i){const e=`${o}, ${c} Award Letter.pdf`;r.awardLetterValid=t.some((t=>t.name.toLowerCase()===e.toLowerCase()))}else if(["Chapter 30","Chapter 33 Post 9/11","Chapter 35","Chapter 1606"].includes(i)){const e=`${o}, ${c} COE.pdf`;r.coeValid=t.some((t=>t.name.toLowerCase()===e.toLowerCase()))}if(l&&e.id===l.id){const e=l.name.split(" ")[1],n=`${e} ${o}, ${c} EM.pdf`,a=`${e} ${o}, ${c} Sched.pdf`;r.emValid=t.some((e=>e.name.toLowerCase()===n.toLowerCase())),r.schedValid=t.some((e=>e.name.toLowerCase()===a.toLowerCase()))}})),x((e=>({...e,[a]:r})))}catch(p){console.error(`Validation error for ${e}:`,p)}})(t,r)})),(()=>{const e=new Set(Object.keys(_)),t=u.filter((t=>{const r=`${t.name} ${t.studentId}`;return!e.has(r)}));z(t)})();const e={};u.forEach((t=>{const r=t.studentId,n=U[r]||"";(K[n]||[]).forEach((t=>{const n=`${r}-${t}`;J(r,t)&&(e[n]=!0)}))})),v(e),localStorage.setItem("checkedDocuments",JSON.stringify(e)),F(!0),localStorage.setItem("hasScanned","true")}},J=(e,t)=>{if(!D||!N[e])return!1;const r=N[e];switch(t){case"COE":return r.coeValid;case"DD214":return r.dd214Valid;case"TAR":return r.tarValid;case"Award Letter":return r.awardLetterValid;case"Enrollment Manager":return r.emValid;case"Schedule":return r.schedValid;default:return!1}},Z=((e,t)=>e.filter((e=>{const r=e.name||"Unknown",n=e.studentId?e.studentId.toString():"",a=U[n]||"";let i="",s=r;if(r.includes(","))try{[i,s]=r.split(",").map((e=>e.trim()))}catch(p){s=r,i=""}const c=`${s} ${i}`.trim(),l=r.toLowerCase().includes(t.toLowerCase())||s&&s.toLowerCase().includes(t.toLowerCase())||i&&i.toLowerCase().includes(t.toLowerCase())||c.toLowerCase().includes(t.toLowerCase())||n.includes(t.toLowerCase()),u=W(n,a);return l&&(o?u:!u)})))(u,d);(0,a.useEffect)((()=>{const e=localStorage.getItem("checkedDocuments"),t=localStorage.getItem("dateChecked");e&&v(JSON.parse(e)),t&&i(JSON.parse(t));const r=new Date,n={...JSON.parse(t||"{}")};Object.entries(n).forEach((e=>{let[t,a]=e;const i=new Date(a);r-i>6048e5&&delete n[t]})),i(n),localStorage.setItem("dateChecked",JSON.stringify(n))}),[]);const{incomplete:ee,complete:te}={incomplete:u.filter((e=>!W(e.studentId,U[e.studentId]))).length,complete:u.filter((e=>W(e.studentId,U[e.studentId]))).length};(0,a.useEffect)((()=>{let e;const t=async()=>{if(!w)try{T(!0),g(null);const e={...N},t={...m};await Promise.all([j(),V()]),x(e),v(t),F(D)}catch(p){g("Failed to refresh data. Please try again."),console.error("Automatic refresh failed:",p)}finally{T(!1)}};return c&&(e=setInterval(t,3e5)),()=>{e&&clearInterval(e)}}),[c,w,N,m,D]);return(0,a.useImperativeHandle)(t,(()=>({handleScan:X,handleRefresh:G}))),(0,a.useEffect)((()=>{r(w)}),[w,r]),(0,Du.jsx)("div",{className:"secure-page",children:(0,Du.jsxs)("div",{className:"content",children:[(0,Du.jsx)("img",{src:"https://i.imgur.com/SROEj2Q.jpeg",alt:"Company Logo",className:"company-logo"}),D&&(0,Du.jsx)(Du.Fragment,{children:(0,Du.jsxs)("div",{className:"header-controls",children:[(0,Du.jsxs)("div",{className:"view-toggle",children:[(0,Du.jsxs)("button",{className:"toggle-button "+(o?"":"active"),onClick:()=>s(!1),children:["Incomplete (",ee,")"]}),(0,Du.jsxs)("button",{className:"toggle-button "+(o?"active":""),onClick:()=>s(!0),children:["Complete (",te,")"]}),(0,Du.jsx)("button",{className:"auto-refresh-button",onClick:()=>{l((e=>!e))},children:c?"Disable Auto-Refresh":"Enable Auto-Refresh"})]}),(0,Du.jsx)("div",{children:(0,Du.jsx)(Pw,{searchTerm:d,setSearchTerm:f})})]})}),D&&H.length>0&&(0,Du.jsxs)("div",{className:"missing-folders-alert",children:[(0,Du.jsxs)("h3",{children:[H.length," Student Folders Not Found"]}),(0,Du.jsx)("button",{onClick:async()=>{try{$(!0),r(!0),g(null);const e=await Gu(),t=await Yu(Nu,e),n=await Qu(Nu,t),a=await Xu(Nu,n),{results:i,errors:o}=await(async(e,t,r)=>{const n=[],a=[];for(let i=0;i<r.length;i+=10){const o=r.slice(i,i+10);try{const s=await Promise.all(o.map((r=>Zu(e,t,`${r.name} ${r.studentId}`).catch((e=>(a.push({studentName:`${r.name} ${r.studentId}`,error:e.message}),null))))));n.push(...s.filter((e=>null!==e))),i+10<r.length&&await new Promise((e=>setTimeout(e,2e3)))}catch(p){console.error(`Error processing batch starting at index ${i}:`,p)}}return{results:n,errors:a}})(Nu,a,H);o.length>0?(g(`Created ${i.length} folders. Failed to create ${o.length} folders. Check console for details.`),console.error("Folder creation errors:",o)):g(null),await V();const s=new Set(i.map((e=>`${e.name}`)));z((e=>e.filter((e=>!s.has(`${e.name} ${e.studentId}`)))))}catch(p){console.error("Error creating missing folders:",p),g("Failed to create missing folders. Please try again.")}finally{$(!1),r(!1)}},disabled:q,children:q?"Creating Folders...":"Create Missing Folders"}),(0,Du.jsx)("div",{className:"missing-folders-list",children:H.map(((e,t)=>(0,Du.jsxs)("div",{children:[e.name," ",e.studentId]},t)))})]}),!D&&(0,Du.jsxs)("div",{className:"initial-scan-message",children:[(0,Du.jsx)("h2",{children:"Welcome to the Document Tracker"}),(0,Du.jsx)("p",{children:'Click the "Scan" button above to view student information.'})]}),p&&(0,Du.jsx)("div",{className:"error-message",children:p}),w&&(0,Du.jsx)("div",{className:"loading-message",children:"Loading Data..."}),D&&Z.length>0&&(0,Du.jsx)(Bw,{filteredData:Z,studentBenefitsMap:U,requiredDocsMapping:K,editingBenefits:y,setEditingBenefits:b,checkedDocuments:m,handleCheckboxChange:(e,t)=>{v((t=>{const r={...t,[e]:!t[e]};return localStorage.setItem("checkedDocuments",JSON.stringify(r)),r}))},getDocumentStatus:J,dateChecked:n,handleDateToggle:e=>{i((t=>{const r={...t};return r[e]?delete r[e]:r[e]=(new Date).toISOString(),localStorage.setItem("dateChecked",JSON.stringify(r)),r}))}}),D&&0===Z.length&&(0,Du.jsx)("div",{className:"no-data-message",children:d?"No matching results found":"No data available"})]})})})),zw=Hw,qw=e=>{let{children:t}=e;const{isAuthenticated:r}=Bu();return r?t:(0,Du.jsx)(me,{to:"/",replace:!0})},$w=()=>{const[e,t]=(0,a.useState)(!1),[r,n]=(0,a.useState)(!1),i=(0,a.useRef)(null);(0,a.useEffect)((()=>{(async()=>{try{await zu.initialize(),t(!0)}catch(e){console.error("Failed to initialize auth:",e)}})()}),[]);return e?(0,Du.jsx)(Uu,{children:(0,Du.jsx)(Ce,{children:(0,Du.jsx)("div",{className:"App",children:(0,Du.jsxs)(be,{children:[(0,Du.jsx)(ve,{path:"/",element:(0,Du.jsx)(qu,{})}),(0,Du.jsx)(ve,{path:"/secure",element:(0,Du.jsxs)(qw,{children:[(0,Du.jsx)(eh,{onScanDocuments:()=>{i.current&&i.current.handleScan&&i.current.handleScan()},onRefreshData:()=>{i.current&&i.current.handleRefresh&&i.current.handleRefresh()},isLoading:r}),(0,Du.jsx)(zw,{ref:i,setIsLoading:n})]})}),(0,Du.jsx)(ve,{path:"*",element:(0,Du.jsx)(me,{to:"/",replace:!0})})]})})})}):(0,Du.jsx)("div",{children:"Initializing..."})},Kw=e=>{e&&e instanceof Function&&r.e(453).then(r.bind(r,453)).then((t=>{let{getCLS:r,getFID:n,getFCP:a,getLCP:i,getTTFB:o}=t;r(e),n(e),a(e),i(e),o(e)}))};o.createRoot(document.getElementById("root")).render((0,Du.jsx)(a.StrictMode,{children:(0,Du.jsx)($w,{})})),Kw()})();
//# sourceMappingURL=main.2c443976.js.map